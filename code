********************************************************************************
*** Programa : ZXXXXXXXXXXX
*** Descrição: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
*** Objetivo : XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
***            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
***
*** Versão  Autor                Data        Observações
*** ------  -------------------  ----------  ----------------------------------
*** 1.0     XXXXXXXXXXXX         01.01.1900  Criação do programa
********************************************************************************
REPORT y_gerar_et.
TABLES: trdir.

TYPE-POOLS ole2 .
* Include para habilitar definições OLE
INCLUDE ole2incl.
* Variaveis para objetos OLE e manipuladores de entidade
DATA gs_word TYPE ole2_object . "OLE object handle
DATA gs_documents TYPE ole2_object . "Documents
DATA gs_actdoc TYPE ole2_object . "Active document
DATA gs_actdoc_tab_cont TYPE ole2_object . "Active document TableCont
DATA gs_actdoc_saveas TYPE ole2_object . "Active document SaveAs
DATA gs_application TYPE ole2_object . "Application
DATA gs_options TYPE ole2_object . "Application options
DATA gs_pagesetup TYPE ole2_object . "Application PageSetup
DATA gs_actwin TYPE ole2_object . "Active window
DATA gs_actpan TYPE ole2_object . "Active pane
DATA gs_view TYPE ole2_object . "View
DATA gs_selection TYPE ole2_object . "Selection
DATA gs_find TYPE ole2_object . "Find
DATA gs_shapes TYPE ole2_object . "Shapes
DATA gs_fields TYPE ole2_object . "Fields
DATA gs_font TYPE ole2_object . "Font
DATA gs_parformat TYPE ole2_object . "Paragraph format
DATA gs_tables TYPE ole2_object . "Tables
DATA gs_borders TYPE ole2_object . "Borders
DATA gs_range TYPE ole2_object . "Range for various ranges
DATA gs_table TYPE ole2_object . "One table
DATA gs_table_border TYPE ole2_object . "Table border
DATA gs_table_width TYPE ole2_object . "Table width
DATA gs_table_height TYPE ole2_object . "Table height
DATA gs_cell TYPE ole2_object . "One cell of a table
DATA gs_shading TYPE ole2_object . "Shanding one cell a table
DATA gs_paragraph TYPE ole2_object . "Paragraph
DATA gv_pos(5) TYPE n .           "Position inform. for table

*************
CONSTANTS:
  wdcolorautomatic(09) TYPE c VALUE '-16777216',
  wdcolorwhite(08)     TYPE c VALUE '16777215',
  wdcolorgray50(07)    TYPE c VALUE '8421504',
  wdcolorblue(07)      TYPE c VALUE '8388608'.

***------------------------------------------------------------------***
***  Tabelas Internas                                                ***
***------------------------------------------------------------------***
DATA: BEGIN OF t_prog OCCURS 0,
        linha(255) TYPE c,
      END OF t_prog.
DATA: BEGIN OF t_busca OCCURS 0.
        INCLUDE STRUCTURE t_prog.
      DATA: END OF t_busca.
DATA: tk  TYPE TABLE OF stokex WITH HEADER LINE,
      stm TYPE TABLE OF sstmnt WITH HEADER LINE.            "#EC NEEDED
DATA: BEGIN OF t_tab OCCURS 0,
        tabela LIKE dd02t-tabname,
      END OF t_tab.

DATA: BEGIN OF t_desc_tab OCCURS 0,
        tabname    LIKE dd02t-tabname,
        ddlanguage LIKE dd02t-ddlanguage,
        as4local   LIKE dd02t-as4local,
        as4vers    LIKE dd02t-as4vers,
        ddtext     LIKE dd02t-ddtext,
      END OF t_desc_tab.


DATA: BEGIN OF t_const OCCURS 0,
        constante(200) TYPE c,
      END OF t_const.
DATA: BEGIN OF t_tab_int OCCURS 0,
        linha(200) TYPE c,
      END OF t_tab_int.
DATA: BEGIN OF t_var OCCURS 0,
        linha(200) TYPE c,
      END OF t_var.
*** ==> Início HCBS - 28/04/2006
DATA: BEGIN OF t_par OCCURS 0,
        par(200) TYPE c,
      END OF t_par.
DATA: BEGIN OF t_sel_opt OCCURS 0,
        par TYPE string,
      END OF t_sel_opt.
*** <== Fim HCBS - 28/04/2006
DATA: BEGIN OF t_include OCCURS 0,                          "#EC NEEDED
        include(200) TYPE c,
      END OF t_include.
DATA: BEGIN OF t_rotinas OCCURS 0,
        rotinas(200) TYPE c,
      END OF t_rotinas.
DATA: BEGIN OF t_funcoes OCCURS 0,                          "#EC NEEDED
        funcoes(200) TYPE c,
      END OF t_funcoes.
DATA: BEGIN OF t_select OCCURS 0,                           "#EC NEEDED
        select(200) TYPE c,
      END OF t_select.
DATA: BEGIN OF t_cabec  OCCURS 0,                           "#EC NEEDED
        linha(200) TYPE c,
      END OF t_cabec.

DATA: v_objetivo(500) TYPE c.
*** ==> Início HCBS - 26/04/2006
*** Tabelas para a criação da tabela de seleção
DATA: BEGIN OF t_tabela OCCURS 0,
        tabela    TYPE string,
        descricao TYPE string,
        apelido   TYPE string,
      END OF t_tabela,

      BEGIN OF t_campos OCCURS 0,
        campo TYPE string,
        desc  TYPE string,
      END OF t_campos,

      BEGIN OF t_destino OCCURS 0,
        tabela    TYPE string,
        descricao TYPE string,
      END OF t_destino,

      BEGIN OF t_join OCCURS 0,
        tipo      TYPE string,
        tabela    TYPE string,
        descricao TYPE string,
        apelido   TYPE string,
      END OF t_join,

      BEGIN OF t_c_join OCCURS 0,
        t_a      TYPE string,
        operador TYPE string,
        t_b      TYPE string,
        con      TYPE string,
      END OF t_c_join,

      BEGIN OF t_condicoes OCCURS 0,
        tabela   TYPE string,
        operador TYPE string,
        campo    TYPE string,
        con      TYPE string,
      END OF t_condicoes.
*** Tabela de seleção
DATA: BEGIN OF t_selecao OCCURS 0,
        tabela  LIKE TABLE OF t_tabela,
        tipo    TYPE string,
        campos  LIKE TABLE OF t_campos,
        destino LIKE TABLE OF t_destino,
        join    LIKE TABLE OF t_join,
        c_join  LIKE TABLE OF t_c_join,
        for_all TYPE string,
        cond    LIKE TABLE OF t_condicoes,
        classf  TYPE string,
        agrup   TYPE string,
      END OF t_selecao.
*** Fim HCBS - 26/04/2006

DATA: t_trdir TYPE trdir OCCURS 0 WITH HEADER LINE.

DATA: programa LIKE sy-repid,
      linha    LIKE tk-row.
DATA: BEGIN OF t_forms OCCURS 0,
        form(200) TYPE c,
        e_form    TYPE c,
        e_endform TYPE c,
      END OF t_forms.
DATA: BEGIN OF t_forms_aux OCCURS 0,
        inicio TYPE i,
        fim    TYPE i,
      END OF t_forms_aux.

DATA: BEGIN OF t_eventos OCCURS 0,
        eventos(200) TYPE c,
      END OF t_eventos.
DATA: BEGIN OF t_eventos_aux OCCURS 0,
        inicio TYPE i,
        fim    TYPE i,
      END OF t_eventos_aux.

DATA: BEGIN OF t_tabcampo OCCURS 0,                         "#EC NEEDED
        campotbl(61) TYPE c,
        tabela(30)   TYPE c,
        campo(30)    TYPE c,
      END OF t_tabcampo.

TYPES: BEGIN OF type_split,
         campo(255) TYPE c,
       END   OF type_split.

DATA: t_split TYPE TABLE OF type_split WITH HEADER LINE.

DATA: BEGIN OF t_parameter OCCURS 0,
        nome    TYPE string,  "Nome do campo
        tipo    TYPE string,  "Tipo do parâmetro
        texto   TYPE string,  "Texto da tela
        campo   TYPE string,  "Tipo de campo/referência
        default TYPE string,  "Valor inicial
        cons    TYPE string,  "Consistência/Observação
      END OF t_parameter.

DATA: BEGIN OF t_select_opt OCCURS 0,
        nome    TYPE string,  "Nome do campo
        tipo    TYPE string,  "Tipo do parâmetro
        texto   TYPE string,  "Texto da tela
        campo   TYPE string,  "Tipo de campo/referência
        default TYPE string,  "Valor inicial
        cons    TYPE string,  "Consistência/Observação
      END OF t_select_opt.

DATA: BEGIN OF t_texto_tra OCCURS 0,
        portug(255)   TYPE c, "Campo em Português
        ingles(255)   TYPE c, "Campo em Ingles
        outro_id(255) TYPE c, "Outro Idioma
      END OF t_texto_tra.


*** Criação de Estrutura para os dados da Captura.
** Dados de Request.
TYPES: BEGIN OF tp_request,
         num_ordem       TYPE verskorrno,
         catg_obj        TYPE versobjtyp,
         versao          TYPE versno,
         autor           TYPE versuser,
         data            TYPE versdate,
         hora            TYPE verstime,
         ultima_versao   TYPE verslast,
         primeira_versao TYPE versfirst,
         release_sap     TYPE versrels,
         tipo_ordem      TYPE trfunction,
         status          TYPE trstatus,
         destino         TYPE tr_target,
         titular         TYPE tr_as4user,
         data_ult_mod    TYPE as4date,
         hora_ult_mod    TYPE as4time,
         odem_super      TYPE strkorr,
         idioma          TYPE ddlanguage,
         descricao       TYPE as4text,
         mandt           TYPE trclient,
         task            TYPE verskorrno,
         retcode         TYPE trretcode,
         message         TYPE natxt,
         obj_name        TYPE versobjnam,
       END OF tp_request.
DATA t_request TYPE TABLE OF tp_request.
DATA e_request TYPE tp_request.

** Dados de Caracteriscas.
TYPES: BEGIN OF tp_caract,
         programa       TYPE programm,
         protecao       TYPE sqlx,
         bloqueio       TYPE edtx,
         maiusc_minusc  TYPE varcl,
         banco_dados    TYPE dbapl,
         banco_logico   TYPE dbna,
         classe_prog    TYPE clas,
         versao_tl_selc TYPE rdir_type,
         geracao_aut    TYPE occu,
         catg_prog      TYPE subc,
         aplicacao      TYPE rdir_appl,
         grupo_autoriz  TYPE secu,
         autor          TYPE cnam,
         data_criacao   TYPE rdir_cdate,
         autor_ult_mod  TYPE unam,
         data_ult_modf  TYPE rdir_udate,
         versao         TYPE vern,
         status         TYPE rdir_levl,
         status2        TYPE rdir_rstat,
         mandt          TYPE rmand,
         idioma         TYPE rload,
         ponto_fixo     TYPE fixpt,
         variante       TYPE sset,
         data_ger_tela  TYPE rdir_sdate,
         hora_ger_tela  TYPE rdir_stime,
         data_ger_sel   TYPE rdir_idate,
         hora_ger_sel   TYPE rdir_itime,
         nome_bd_logico TYPE ldbnam,
         flag_unicode   TYPE uccheck,
         titulo_prog    TYPE repti,
         object_type    TYPE trobjtype,
         sist_orig      TYPE srcsystem,
         dev_class      TYPE devclass,
       END OF tp_caract.

DATA t_caract  TYPE tp_caract.

** Dados de texts
TYPES: BEGIN OF tp_text,
         id       TYPE textpoolid,
         chave    TYPE textpoolky,
         texto    TYPE textpooltx,
         tamanho  TYPE textpoolln,
         traducao TYPE txt255,
         idioma   TYPE sylangu,
       END OF tp_text.

DATA: t_textos TYPE TABLE OF tp_text.
DATA: e_textos TYPE tp_text.

**Dados das transações
TYPES: BEGIN OF tp_trans,
         transacao    TYPE tcode,
         tela         TYPE dynpronr,
         descricao    TYPE ttext_stct,
         sap_gui_html TYPE s_webgui,
         sap_gui_win  TYPE s_win32,
         sap_gui_java TYPE s_platin,
         service      TYPE iacservic_,
         obj_aut      TYPE xuobject,
         campo_aut    TYPE xufield,
         valor_aut    TYPE xuval,
         parametros   TYPE tcdparam,
         autor        TYPE responsibl,
         object_type  TYPE trobjtype,
         sist_orig    TYPE srcsystem,
         dev_class    TYPE devclass,
       END OF tp_trans.
DATA: t_transacao TYPE TABLE OF tp_trans.
DATA: e_transacao TYPE tp_trans.

**Dados das Variantes
TYPES: BEGIN OF tp_variant,
         report       TYPE vari_reprt,
         variante     TYPE variant,
         descricao    TYPE rvart_vtxt,
         trans_aut    TYPE vari_trans,
         ambiente     TYPE varid_env,
         protegido    TYPE rsscr_cflg,
         grupo_aut    TYPE secu,
         versao       TYPE varid_vers,
         user_criacao TYPE uname,
         data_criacao TYPE sydats,
         hora_criacao TYPE sytime,
         user_modif   TYPE uname,
         data_modif   TYPE sydats,
         hora_modif   TYPE sytime,
         idioma       TYPE langu,
         tela         TYPE sydynnr,
       END OF tp_variant.
DATA: t_variant TYPE TABLE OF tp_variant.
DATA: e_variant TYPE tp_variant.

**Dados dos Jobs
DATA: t_job TYPE TABLE OF v_op.
DATA: e_job TYPE v_op.


**Estruturas para o quadro de select
DATA: e_tabela    LIKE t_tabela,
      e_campos    LIKE t_campos,
      e_destino   LIKE t_destino,
      e_join      LIKE t_join,
      e_c_join    LIKE t_c_join,
      e_condicoes LIKE t_condicoes,
      i_lines     TYPE i,
      i_join      TYPE i.                                   "#EC NEEDED



***------------------------------------------------------------------***
***  Variaveis Globais                                               ***
***------------------------------------------------------------------***
**Variavel que contem a quantidade de Requests
DATA: v_qtd_request(3) TYPE c,
      v_qtd_tabela(6)  TYPE c,
      v_file(30)       TYPE c,
      v_variant(200)   TYPE c,
      v_job(200)       TYPE c.

DATA: v_linha_form(72)       TYPE c,
**Variaveis para o quadro de selects
      v_tab_e_desc(200)      TYPE c,
      v_tipo(50)             TYPE c,
      v_destino(50)          TYPE c,
      v_tab_join(20)         TYPE c,
      v_cond_join(100)       TYPE c,
      v_for_all(20)          TYPE c,
      v_cond_where(100)      TYPE c,
**Variavel de quantidade de prametros de seleção.
      v_qtd_param(3)         TYPE c,
      v_qtd_selop(3)         TYPE c,

**Variaveis com os select options.
      v_selop_nome(100)      TYPE c,
      v_selop_tipo(100)      TYPE c,
      v_selop_texto(100)     TYPE c,
      v_selop_campo(100)     TYPE c,
      v_selop_default(100)   TYPE c,
      v_selop_cons(100)      TYPE c,

**Variaveis com os Parameters
      v_par_nome(100)        TYPE c,
      v_par_tipo(100)        TYPE c,
      v_par_texto(100)       TYPE c,
      v_par_campo(100)       TYPE c,
      v_par_default(100)     TYPE c,
      v_par_cons(100)        TYPE c,

**Variavel com a quantidade de textos.
      v_qtd_textos(3)        TYPE c,

**Variavel com o nome da pasta Batch imput.
      v_nome_pasta_batch(30) TYPE c,

      v_name                 TYPE adrp-name_text.

TYPES: BEGIN OF ty_source,
         tipo     TYPE string,
         comando  TYPE string,
         sentenca TYPE string,
       END OF ty_source.

TYPES: BEGIN OF tp_selecao,
         tipo     TYPE char200,
         comando  TYPE char200,
         sentenca TYPE char200,
       END OF tp_selecao.

***Tabela interna de código e tradução
DATA: t_source TYPE TABLE OF ty_source WITH HEADER LINE.
DATA: s_selecao TYPE tp_selecao.

***Constantes
CONSTANTS: c_file        LIKE  rlgrap-filename VALUE 'C:\temp\'. "#EC NOTEXT
CONSTANTS: c_rotina(06)      TYPE  c        VALUE 'Rotina', "#EC NOTEXT
           c_fimdarotina(13) TYPE  c        VALUE 'Fim da Rotina'. "#EC NOTEXT

***------------------------------------------------------------------***
***  Parametros de Seleção                                           ***
***------------------------------------------------------------------***

SELECTION-SCREEN: BEGIN OF BLOCK b1 WITH FRAME,
                  BEGIN OF LINE,
                  COMMENT 1(16) lbl_prog FOR FIELD p_prog.
PARAMETERS: p_prog LIKE trdir-name OBLIGATORY. "Programa
SELECTION-SCREEN  END OF LINE.
*SELECT-OPTIONS: s_unam FOR trdir-cnam. "Usuário
SELECTION-SCREEN: BEGIN OF LINE,
                  COMMENT 1(16) lbl_file FOR FIELD p_loc.
PARAMETER: p_loc LIKE rlgrap-filename DEFAULT c_file OBLIGATORY. "Caminho
SELECTION-SCREEN  END OF LINE.

SELECTION-SCREEN: BEGIN OF LINE,
                  COMMENT 1(16) lbl_logo FOR FIELD p_logo.
PARAMETER: p_logo LIKE rlgrap-filename DEFAULT c_file OBLIGATORY. "Caminho
SELECTION-SCREEN: END OF LINE,
                  END OF BLOCK b1.
*           p_rfc TYPE rfcdest. "Destino lógico

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_loc.
  PERFORM ws_filename_get USING p_loc 'S'.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_logo.
  PERFORM ws_filename_get USING p_logo 'S'.

AT SELECTION-SCREEN OUTPUT.
  lbl_prog = 'Programa:'.
  lbl_file = 'Arquivo .doc:'.
  lbl_logo = 'Logo do projeto:'.
*--Substitui as letras minusculas por maiusculas.
*  TRANSLATE p_rfc TO UPPER CASE.


***------------------------------------------------------------------***
***  Evento Start of selection                                       ***
***------------------------------------------------------------------***
START-OF-SELECTION.

  PERFORM progresso USING 'Inicializando as tabelas'.

  SELECT SINGLE *
   FROM trdir
   INTO t_trdir
   WHERE name EQ p_prog.
*  CALL FUNCTION 'Z_SCAN_SOURCE_SEL_TRDIR'
*    DESTINATION p_rfc
*    EXPORTING
*      im_prog_name          = p_prog
*    IMPORTING
*      ex_trdir              = t_trdir
*    EXCEPTIONS
*      program_nothing_found = 1
*      OTHERS                = 2.
  IF sy-subrc IS INITIAL.

    READ TABLE t_trdir INDEX 1.
    CLEAR v_file.
    programa = t_trdir-name.
    CONCATENATE p_loc '.doc' INTO v_file.

  ELSE.
    MESSAGE i208(00) WITH 'Não existem dados para os parâmetros informados'.
    STOP.
  ENDIF.



***Busca o código fonte do programa indicado.
  READ REPORT programa INTO t_prog.

*  CALL FUNCTION 'Z_SCAN_SOURCE_GET_REPORT'
*    DESTINATION p_rfc
*    EXPORTING
*      im_obj_name       = programa
*    TABLES
*      ex_source         = t_prog
*    EXCEPTIONS
*      read_report_error = 1
*      OTHERS            = 2.
*
  IF sy-subrc <> 0.
    MESSAGE i208(00) WITH 'Não existem dados para os parâmetros informados'.
    STOP.
  ENDIF.


  PERFORM progresso USING 'Procurando o cabeçalho'.
  PERFORM busca_cabecalho.

  PERFORM progresso USING 'Procurando as tabela utilizadas'.
  PERFORM busca_tabelas.

  PERFORM progresso USING 'Procurando as contantes utilizadas'.
  PERFORM busca_constantes.

  PERFORM progresso USING 'Procurando as tabelas internas e variáveis utilizadas'.
  PERFORM busca_variaveis_tab_int.
*** ==> Início HCBS - 28/04/2006
***   Captura as informações de Request, Textos e Caracteriscas da
***   classe global ZCL_SCAN_SOURCE_ATRIBUTES da programa selecionado.
  PERFORM progresso USING 'Procurando as características dos campos utilizados no programa'.
  PERFORM busca_caract.

  PERFORM progresso USING 'Procurando os parâmetros'.
  PERFORM busca_parametros.

  PERFORM progresso USING 'Procurando os SELECT-OPTIONS'.
  PERFORM busca_select_options.
*** <== Fim HCBS - 28/04/2006
  PERFORM progresso USING 'Procurando as rotinas do programa'.
  PERFORM busca_rotinas.
  PERFORM busca_forms.

  PERFORM progresso USING 'Procurando as funções utilizadas no programa'.
  PERFORM busca_funcoes.

  PERFORM progresso USING 'Procurando as includes utilizadas no programa'.
  PERFORM busca_includes.

  PERFORM progresso USING 'Procurando as seleções do programa'.
  PERFORM busca_select.

  PERFORM progresso USING 'Procurando os eventos do programa'.
  PERFORM busca_eventos.

  PERFORM progresso USING 'Procurando a Pasta Batch'.
  PERFORM busca_pastabatch.


* PERFORM busca_carac_campo TABLES t_campodesc
*                           USING 'MARA-MATNR'.


***------------------------------------------------------------------***
***  Imprimir Espec. tec. em documento Word.                         ***
***------------------------------------------------------------------***
** Cria objeto OLE,busca entidades principais para manipular variaveis
  PERFORM progresso USING 'Criando o documento do Word.'.
  PERFORM z_cria_documento.

  SELECT a~name_text
    INTO v_name
    FROM usr21 AS u INNER JOIN adrp AS a ON a~persnumber = u~persnumber
    UP TO 1 ROWS
   WHERE u~bname = t_caract-autor.
  ENDSELECT.

  READ TABLE t_transacao INDEX 1 INTO e_transacao.
  PERFORM z_info_geral USING t_caract-titulo_prog  "Titulo
                             t_caract-programa     "Codigo do Programa
                             e_transacao-transacao   "Transação
                             t_caract-programa+3(2)  "Modulo
                             t_caract-data_criacao   "Data Criação
                             'Arcelormittal'                  "Cliente
                             '<Nome do Responsavel Processo>' "Responsavel Proc
                             ''                      "Responsavel Func
                             v_name                  "Responsavel Tec
                             ''.                     "Complexidade

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_hist_mod_header.

* chamar items em loop
  CLEAR: v_qtd_request.
  DESCRIBE TABLE t_request LINES v_qtd_request.
  CLEAR e_request.

  LOOP AT t_request INTO e_request.
    PERFORM z_hist_mod_items USING  e_request-data       "Data
                                    e_request-descricao  "Descrição
                                    e_request-autor      "Solicitado
                                    e_request-num_ordem  "Change
                                    v_qtd_request."Qtdade de Request
  ENDLOOP.
* Pula uma linha
  PERFORM z_new_line.
  PERFORM z_hist_mod_obs.
  PERFORM z_pag_conteudo.
  PERFORM z_pag_fluxo.

***
  PERFORM z_pag_proc_neg.


  PERFORM z_consid_oper USING ''                     "PT
                              ''                     "EN
                              e_transacao-transacao  "Trans
                              ''                     "Tipo Proces
                              ''                     "Freq
                              t_caract-dev_class     "Pacote
                              ''                     "Depen
                              v_variant              "Vari
                              v_job                  "Job name
                              v_nome_pasta_batch.    "Pasta



  PERFORM z_pag_espec.
*  Pula uma linha
  PERFORM z_new_line.

  PERFORM z_tab_transp_header.

*Imprime quadro de tabela.
  CLEAR v_qtd_tabela.
  DESCRIBE TABLE t_desc_tab LINES v_qtd_tabela.
  LOOP AT t_desc_tab.
    PERFORM z_tab_transp_items  USING  t_desc_tab-tabname "Tabela
                                       t_desc_tab-ddtext  "Descrição
                                       ''                 "Especificação
                                       v_qtd_tabela.  "Qtdade de tabelas

    CLEAR t_desc_tab.
  ENDLOOP.
*   Pula uma linha
  PERFORM z_new_line.

  PERFORM  z_incl_tab_header.

  PERFORM z_incl_tab_items  USING 'N/A'   "Seq
                                  'N/A'   "Include
                                  'N/A'   "Tabela
                                   '1'.  "Qtidade de Includes de tabelas

*   Pula uma linha
  PERFORM z_new_line.

  PERFORM  z_campos_tab_header.

  PERFORM z_campos_tab_items USING  'N/A' "Campo
                                    'N/A' "Chave
                                    'N/A' "Elem.
                                    'N/A' "Tipo
                                    'N/A' "Tam
                                    'N/A' "Descrição
                                    'N/A' "Observação
                         '1'. "Qtdade de campos da tabela a ser criada

* Pula uma linha
  PERFORM z_new_line.


  PERFORM z_trans_header.

  PERFORM z_trans_items USING  'N/A'  "Transação
                               'N/A'  "Descrição
                               '1'.         "Qtd de transações

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_arq_header.

  PERFORM z_arq_items USING   'N/A' "Nome Arq
                              'N/A' "Nome Campo
                              'N/A' "Posição
                              'N/A' "Tamanho
                              'N/A' "Descrição
                              '1'.         "Qtd de Arquivos

* Pula uma linha
  PERFORM z_new_line.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_param_imp_func_header.

  PERFORM z_param_imp_func_items USING  'N/A' "Campo
                                        'N/A' "Formato
                                        'N/A' "Observação
                                        '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_param_exp_func_header.

  PERFORM z_param_exp_func_items USING  'N/A' "Campo
                                        'N/A' "Formato
                                        'N/A' "Observação
                                         '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_param_tab_func_header.

  PERFORM z_param_tab_func_items USING  'N/A' "Tabela
                                        'N/A' "Estrutura
                                        'N/A' "Tipo de refer
                                        'N/A' "Observação
                                        '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_func_excecoes_header.

  PERFORM z_func_excecoes_items USING  'N/A' "Campo
                                       'N/A' "Conteudo
                                       '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_tela_selecao.

* Pula uma linha
  PERFORM z_new_line.

*** ==> Início HCBS - 28/04/2006

  IF t_parameter[] IS INITIAL AND t_select_opt[] IS INITIAL.
    PERFORM z_param_selec_header.
    PERFORM z_param_selec_items USING 'N/A' "Nome
                                      'N/A' "Tipo de Parâmetro
                                      'N/A' "Texto da Tela
                                      'N/A' "Tipo de Referencia
                                      'N/A' "Valor Inicial
                                      'N/A' "Observação
                                      '1'.
* Pula uma linha
    PERFORM z_new_line.
  ELSEIF NOT t_parameter[] IS INITIAL AND t_select_opt[] IS INITIAL.

*** Escreve os Parameters
    DESCRIBE TABLE t_parameter LINES v_qtd_param.
    PERFORM z_param_selec_header.
    LOOP AT t_parameter.


      CLEAR: v_par_nome, v_par_tipo, v_par_texto, v_par_campo,
             v_par_default, v_par_cons.


      MOVE: t_parameter-nome    TO v_par_nome,
            t_parameter-tipo    TO v_par_tipo,
            t_parameter-texto   TO v_par_texto,
            t_parameter-campo   TO v_par_campo,
            t_parameter-default TO v_par_default,
            t_parameter-cons    TO v_par_cons.

      PERFORM z_param_selec_items USING
                               v_par_nome      "Nome
                               v_par_tipo      "Tipo de Parâmetro
                               v_par_texto     "Texto da Tela
                               v_par_campo     "Tipo de Referencia
                               v_par_default   "Valor Inicial
                               v_par_cons      "Observação
                               v_qtd_param.
      CLEAR t_parameter.
    ENDLOOP.
* Pula uma linha
    PERFORM z_new_line.

  ELSEIF NOT t_select_opt[] IS INITIAL AND t_parameter[] IS INITIAL.

*** Escreve os Select-Options.
    DESCRIBE TABLE t_select_opt LINES v_qtd_selop.
    PERFORM z_param_selec_header.
    LOOP AT t_select_opt.

      CLEAR: v_selop_nome, v_selop_tipo, v_selop_texto, v_selop_campo,
             v_selop_default, v_selop_cons.


      MOVE: t_select_opt-nome    TO v_selop_nome,
            t_select_opt-tipo    TO v_selop_tipo,
            t_select_opt-texto   TO v_selop_texto,
            t_select_opt-campo   TO v_selop_campo,
            t_select_opt-default TO v_selop_default,
            t_select_opt-cons    TO v_selop_cons.

      PERFORM z_param_selec_items USING
                                  v_selop_nome     "Nome
                                  v_selop_tipo     "Tipo de Parâmetro
                                  v_selop_texto    "Texto da Tela
                                  v_selop_campo    "Tipo de Referencia
                                  v_selop_default  "Valor Inicial
                                  v_selop_cons     "Observação
                                  v_qtd_selop.
      CLEAR t_select_opt.
    ENDLOOP.
* Pula uma linha
    PERFORM z_new_line.

  ELSEIF NOT t_select_opt[] IS INITIAL AND NOT t_parameter[] IS INITIAL.

    CLEAR t_parameter.
    LOOP AT t_select_opt.

      MOVE: t_select_opt-nome    TO t_parameter-nome,
            t_select_opt-tipo    TO t_parameter-tipo,
            t_select_opt-texto   TO t_parameter-texto,
            t_select_opt-campo   TO t_parameter-campo,
            t_select_opt-default TO t_parameter-default,
            t_select_opt-cons    TO t_parameter-cons.

      APPEND t_parameter.
      CLEAR t_parameter.
    ENDLOOP.



*** Escreve os Parameters
    DESCRIBE TABLE t_parameter LINES v_qtd_param.
    PERFORM z_param_selec_header.
    LOOP AT t_parameter.


      CLEAR: v_par_nome, v_par_tipo, v_par_texto, v_par_campo,
             v_par_default, v_par_cons.


      MOVE: t_parameter-nome    TO v_par_nome,
            t_parameter-tipo    TO v_par_tipo,
            t_parameter-texto   TO v_par_texto,
            t_parameter-campo   TO v_par_campo,
            t_parameter-default TO v_par_default,
            t_parameter-cons    TO v_par_cons.

      PERFORM z_param_selec_items USING
                               v_par_nome      "Nome
                               v_par_tipo      "Tipo de Parâmetro
                               v_par_texto     "Texto da Tela
                               v_par_campo     "Tipo de Referencia
                               v_par_default   "Valor Inicial
                               v_par_cons      "Observação
                               v_qtd_param.
      CLEAR t_parameter.
    ENDLOOP.
* Pula uma linha
    PERFORM z_new_line.

  ENDIF.
*** <== Fim HCBS - 28/04/2006

  PERFORM z_dados_proj_header.


  PERFORM z_dados_proj_items USING   'N/A' "Projeto
                                     'N/A' "Ampliação
                                     'N/A' "Componentes
                                     '1'.
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_prog_form USING     'N/A' "Programa Standard
                                'N/A' "Formulário Standard
                                'N/A' "Transação Form
                                'N/A'. "Transação
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_campos_tela_header.
  PERFORM z_campos_tela_items USING   'N/A' "Transação Standard
                                      'N/A' "Programa
                                      'N/A' "Nr.Tela
                                      'N/A' "Nome campo na tela
                                      'N/A' "Nome do Data Element
                                      'N/A' "Id Parameter
                                      'N/A' "Observações
                                      '1'.
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_func_header.
  PERFORM z_func_items USING   'N/A' "Seq
                               'N/A' "Nome do Data Element
                               'N/A' "Get Parameter
                               'N/A' "Set Parameter
                               'N/A' "Função
                               '1'.
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_map_campos_header.
  PERFORM z_map_campos_items USING    '  ' "Seq
                                      '  ' "Form
                                      '  ' "Tam.
                                      '  ' "Trunc.
                                      '  ' "Descrição Campo
                                      '  ' "Tabela
                                      '  ' "Campo
                                      '  ' "Observações
                                      '1'.
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_textos_header.

  DESCRIBE TABLE t_texto_tra LINES v_qtd_textos.
  LOOP AT t_texto_tra.
    PERFORM z_textos_items USING  t_texto_tra-portug      "Campo Português
                                  t_texto_tra-ingles      "'Campo Inglês'
                                  '  '                    "'Outro Idioma'
                                      v_qtd_textos.
  ENDLOOP.
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_msgs_header.
  PERFORM z_msgs_items USING          '  ' "Classe
                                      '  ' "Nº
                                      '  ' "Português
                                      '  ' "Inglês
                                      '  ' "Outro Idioma
                                      '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_menu_header.
  PERFORM z_menu_items USING        'N/A' "Cod.
                                    'N/A' "Texto
                                    '1'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_botoes_header.
  PERFORM z_botoes_items USING        'N/A' "Código Funcão
                                      'N/A' "Categoria de Função
                                      'N/A' "Texto da Função
                                      'N/A' "Nome do Icone
                                      'N/A' "Texto de Icones
                                      'N/A' "Texto Informativo
                                      'N/A' "Selecão Direta
                                      '1'.

** Pula uma linha

  PERFORM z_pag_logic_proc."Logica de Processamento

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorautomatic   "Font Color
                                wdcolorautomatic   "BGColor
                                ''                 "Índice
                                TEXT-016.          "Texto  -  Lógica principal

  LOOP AT t_eventos.
    PERFORM z_escreve_texto USING 'Calibri'            "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  t_eventos-eventos. "Texto
    CLEAR t_eventos.
  ENDLOOP. "t_eventos

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorautomatic   "Font Color
                                wdcolorautomatic   "BGColor
                                ''                 "Índice
                                TEXT-017.          "Texto  - Lógica de processamento


  LOOP AT t_forms.
    IF t_forms-e_form EQ 'X'.
      PERFORM z_escreve_texto USING 'Calibri'            "Font
                                    '10'               "Size
                                    '1'                "Bold
                                    '0'                "Italic
                                    '0'                "Underline
                                    wdcolorautomatic   "Font Color
                                    wdcolorautomatic   "BGColor
                                    ''                 "Índice
                                    t_forms-form.      "Texto
    ELSEIF t_forms-e_endform EQ 'X'.
      PERFORM z_escreve_texto USING 'Calibri'            "Font
                                    '10'               "Size
                                    '1'                "Bold
                                    '0'                "Italic
                                    '0'                "Underline
                                     wdcolorautomatic  "Font Color
                                     wdcolorautomatic  "BGColor
                                     ''                "Índice
                                     t_forms-form.     "Texto
*  Pula uma linha
      PERFORM z_new_line.


    ELSE.
      PERFORM z_escreve_texto USING 'Calibri'            "Font
                                    '10'               "Size
                                    '0'                "Bold
                                    '0'                "Italic
                                    '0'                "Underline
                                    wdcolorautomatic   "Font Color
                                    wdcolorautomatic   "BGColor
                                    ''                 "Índice
                                    t_forms-form.    "Texto
    ENDIF.




    CLEAR t_forms.
  ENDLOOP. "t_forms


* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_acesso_dados.


* Pula uma linha
  PERFORM z_new_line.

***>> Tabela de Select
  LOOP AT t_selecao.

    PERFORM z_selec_from.
*** ==> Início HCBS - 02/05/2006
    DESCRIBE TABLE t_selecao-tabela LINES i_lines.
    IF i_lines GT 1.
      LOOP AT t_selecao-tabela INTO e_tabela.
        CLEAR v_tab_e_desc.
        CONCATENATE e_tabela-tabela
                    e_tabela-descricao
                    INTO
                    v_tab_e_desc
                    SEPARATED BY space.
        PERFORM z_escreve_texto USING 'Calibri'        "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  v_tab_e_desc.
      ENDLOOP. "t_selecao-tabela into e_tabela.
    ELSE.
      IF NOT t_selecao-tabela[] IS INITIAL.
        READ TABLE t_selecao-tabela INDEX i_lines INTO e_tabela.
        CLEAR v_tab_e_desc.
        CONCATENATE e_tabela-tabela
                    e_tabela-descricao
                    INTO v_tab_e_desc SEPARATED BY space.
        PERFORM z_escreve_texto USING 'Calibri'        "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  v_tab_e_desc.

      ENDIF.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

    CLEAR v_tipo.
    MOVE: t_selecao-tipo TO v_tipo.
    IF NOT t_selecao-tipo IS INITIAL.
      PERFORM z_selec_tp_acesso USING v_tipo.
    ELSE.
      PERFORM z_selec_tp_acesso USING 'N/A'.
    ENDIF.

    PERFORM z_select_campos.

    CLEAR i_lines.
    DESCRIBE TABLE t_selecao-campos LINES i_lines.
*** ==> Início HCBS - 02/05/2006
    IF i_lines GT 1.
      LOOP AT t_selecao-campos INTO e_campos.
        PERFORM z_escreve_texto USING 'Calibri'        "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  e_campos-campo.

      ENDLOOP. " t_selecao-campos into e_campos
    ELSE.
      IF NOT t_selecao-campos[] IS INITIAL.
        READ TABLE t_selecao-campos INDEX i_lines INTO e_campos.
        PERFORM z_escreve_texto USING 'Calibri'        "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  e_campos-campo.

      ENDIF.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

    CLEAR i_lines.
    DESCRIBE TABLE t_selecao-destino LINES i_lines.
*** ==> Início HCBS - 02/05/2006
    IF i_lines GT 1.
      LOOP AT t_selecao-destino INTO e_destino.
        CLEAR v_destino.
        MOVE: e_destino-tabela TO v_destino.
        PERFORM z_selec_destino USING v_destino.
      ENDLOOP.
    ELSE.
      IF NOT t_selecao-destino[] IS INITIAL.
        READ TABLE t_selecao-destino INDEX i_lines INTO e_destino.
        CLEAR v_destino.
        MOVE: e_destino-tabela TO v_destino.
        PERFORM z_selec_destino USING v_destino.
      ELSE.
        PERFORM z_selec_destino USING 'N/A'.
      ENDIF.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

    CLEAR i_lines.
    DESCRIBE TABLE t_selecao-join LINES i_lines.

*** ==> Início HCBS - 02/05/2006
    IF i_lines GT 1.
      LOOP AT t_selecao-join INTO e_join.

        CLEAR v_tab_join.
        MOVE: e_join-tabela TO v_tab_join.
        PERFORM z_selec_join USING v_tab_join
                                   i_lines.

        PERFORM z_select_cond_join.
        CLEAR i_join.
        DESCRIBE TABLE t_selecao-c_join LINES i_join.
        LOOP AT t_selecao-c_join INTO e_c_join.
          CLEAR v_cond_join.
          CONCATENATE e_c_join-t_a
                      e_c_join-operador
                      e_c_join-t_b
                      e_c_join-con
                      INTO
                      v_cond_join
                      SEPARATED BY space.


          PERFORM z_escreve_texto USING 'Calibri'        "Font
                                    '10'               "Size
                                    '0'                "Bold
                                    '0'                "Italic
                                    '0'                "Underline
                                    wdcolorautomatic   "Font Color
                                    wdcolorautomatic   "BGColor
                                    ''                 "Índice
                                    v_cond_join.


        ENDLOOP. "t_selecao-c_join

      ENDLOOP. "t_selecao-join
    ELSE.
      IF NOT t_selecao-join[] IS INITIAL.
        CLEAR v_tab_join.
        MOVE: e_join-tabela TO v_tab_join.
        PERFORM z_selec_join USING v_tab_join
                                   i_lines.

        PERFORM z_select_cond_join.
        CLEAR i_join.
        DESCRIBE TABLE t_selecao-c_join LINES i_join.
        LOOP AT t_selecao-c_join INTO e_c_join.
          CLEAR v_cond_join.
          CONCATENATE e_c_join-t_a
                      e_c_join-operador
                      e_c_join-t_b
                      e_c_join-con
                      INTO
                      v_cond_join
                      SEPARATED BY space.


          PERFORM z_escreve_texto USING 'Calibri'        "Font
                                    '10'               "Size
                                    '0'                "Bold
                                    '0'                "Italic
                                    '0'                "Underline
                                    wdcolorautomatic   "Font Color
                                    wdcolorautomatic   "BGColor
                                    ''                 "Índice
                                    v_cond_join.


        ENDLOOP. "t_selecao-c_join
      ENDIF.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

    CLEAR v_for_all.
    MOVE: t_selecao-for_all TO v_for_all.

*** ==> Início HCBS - 02/05/2006
    IF NOT v_for_all IS INITIAL.
      PERFORM z_selec_for_all_entries USING v_for_all.
    ELSE.
      PERFORM z_selec_for_all_entries USING 'N/A'.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

    PERFORM z_select_where.

    CLEAR i_lines.
    DESCRIBE TABLE t_selecao-cond LINES i_lines.
*** ==> Início HCBS - 02/05/2006
    IF i_lines GT 1.
      LOOP AT t_selecao-cond INTO e_condicoes.

        CLEAR v_cond_where.
        CONCATENATE e_condicoes-tabela
                    e_condicoes-operador
                    e_condicoes-campo
                    e_condicoes-con
                    INTO v_cond_where SEPARATED BY space.


        PERFORM z_escreve_texto USING 'Calibri'        "Font
                                  '10'               "Size
                                  '0'                "Bold
                                  '0'                "Italic
                                  '0'                "Underline
                                  wdcolorautomatic   "Font Color
                                  wdcolorautomatic   "BGColor
                                  ''                 "Índice
                                  v_cond_where.


      ENDLOOP.
    ELSE.
      READ TABLE t_selecao-cond INDEX 1 INTO e_condicoes.
      CLEAR v_cond_where.
      CONCATENATE e_condicoes-tabela
                  e_condicoes-operador
                  e_condicoes-campo
                  e_condicoes-con
                  INTO v_cond_where SEPARATED BY space.


      PERFORM z_escreve_texto USING 'Calibri'        "Font
                                '10'               "Size
                                '0'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorautomatic   "Font Color
                                wdcolorautomatic   "BGColor
                                ''                 "Índice
                                v_cond_where.
    ENDIF.
*** <== Fim HCBS - 02/05/2006

*** ==> Início HCBS - 02/05/2006
    IF NOT t_selecao-classf IS INITIAL.
      PERFORM z_selec_order_by USING t_selecao-classf. "<campo>
    ELSE.
      PERFORM z_selec_order_by USING 'N/A'. "<campo>
    ENDIF.
*** <== Fim HCBS - 02/05/2006

*** ==> Início HCBS - 02/05/2006
    IF NOT t_selecao-agrup IS INITIAL.
      PERFORM z_selec_group_by USING t_selecao-agrup. "<campo>
    ELSE.
      PERFORM z_selec_group_by USING 'N/A'. "<campo>
    ENDIF.

    PERFORM z_avanca_fim_tabela.
*** <== Fim HCBS - 02/05/2006

* Pula uma linha
    PERFORM z_new_line.
* Pula uma linha
    PERFORM z_new_line.
  ENDLOOP. "t_selecao.
***<< Tabela de Select


* Pula uma linha
  PERFORM z_new_line.

*  PERFORM  z_tratam_dados.

*  PERFORM z_pag_roteiro_testes.

  PERFORM z_cria_conteudo USING '2'.

* Salvar Como
  PERFORM z_salva_documento USING v_file.

* Fecha MS-Word
  PERFORM z_close_application.

* Limpar as tabelas e liberar a memoria.
  FREE: t_prog    , t_busca  , tk       ,
        stm       , t_tab    , t_const  , t_tab_int,
        t_var     , t_par    , t_include, t_rotinas,
        t_funcoes , t_select .
  CLEAR: t_prog   , t_busca  ,
         tk       , stm      , t_tab    , t_const  ,
         t_tab_int, t_var    , t_par    , t_include,
         t_rotinas, t_funcoes, t_select.



***------------------------------------------------------------------***
***  FORMS                                                           ***
***------------------------------------------------------------------***

*---------------------------------------------------------------------*
*       FORM ws_filename_get                                          *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  ARQUIVO                                                       *
*  -->  P_MODE                                                        *
*---------------------------------------------------------------------*
FORM ws_filename_get USING arquivo p_mode.


  CALL FUNCTION 'WS_FILENAME_GET'
    EXPORTING
      def_filename     = ' '
      def_path         = 'C:\'
      mask             = ',*.*,*.*.'
      mode             = p_mode
      title            = 'Abrir'
    IMPORTING
      filename         = arquivo
    EXCEPTIONS
      inv_winsys       = 1
      no_batch         = 2
      selection_cancel = 3
      selection_error  = 4
      OTHERS           = 5.


  IF sy-subrc IS NOT INITIAL.

  ENDIF.


*  CALL FUNCTION 'F4_FILENAME'
*    EXPORTING
*      program_name  = syst-cprog
*      dynpro_number = syst-dynnr
*      field_name    = p_mode
*    IMPORTING
*      file_name     = arquivo.




ENDFORM.                    " ws_filename_get


*---------------------------------------------------------------------*
*       FORM busca_tabelas                                            *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_tabelas.
  t_busca-linha = 'TABLES'.
  APPEND t_busca.
  CLEAR  t_busca.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str = 'TABLES'.
  CLEAR t_tab.
  LOOP AT tk.
    t_tab-tabela = tk-str.
    APPEND t_tab.
    CLEAR t_tab.
  ENDLOOP.


  IF NOT t_tab[] IS INITIAL.

    PERFORM z_scan_source_get_field_descr TABLES t_tab
                                                 t_desc_tab
                                          USING space.

*    CALL FUNCTION 'Z_SCAN_SOURCE_GET_FIELD_DESCR'
*      DESTINATION p_rfc
** EXPORTING
**   IM_SCAN         =
** IMPORTING
**   EX_DD02TX       =
*      TABLES
*        im_tabela       = t_tab
*        ex_dd02t        = t_desc_tab
*              .


*    SELECT tabname     "tabela
*           ddlanguage  "idioma
*           ddtext      "Descrição
*    FROM dd02t
*    INTO TABLE t_desc_tab
*    FOR ALL ENTRIES IN t_tab
*    WHERE tabname    EQ t_tab-tabela
*    AND   ddlanguage EQ sy-langu.

*    IF sy-subrc IS INITIAL.
*    ENDIF.
  ENDIF.


  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_tab.
ENDFORM.                    " busca_tabelas

*---------------------------------------------------------------------*
*       FORM busca_constantes                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_constantes.
  t_busca-linha = 'CONSTANTS'.
  APPEND t_busca.
  CLEAR  t_busca.
  SCAN ABAP-SOURCE t_prog
        TOKENS      INTO tk
        STATEMENTS  INTO stm
        KEYWORDS    FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str = 'CONSTANTS'.
  LOOP AT tk.
    CLEAR t_const.
    t_const-constante = tk-str.
    APPEND t_const.
  ENDLOOP.
  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_const.

***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES t_const
                                   t_const
                            USING  'X' space space
                            CHANGING sy-subrc.

*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
*      declaracao                      = 'X'
**       EVENTO                          =
**       ROTINA                          =
*    TABLES
*      t_entrada                       = t_const
*      t_retorno                       = t_const
*   EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*            .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.

  ENDIF.


ENDFORM.                    " busca_constantes

*---------------------------------------------------------------------*
*       FORM busca_variaveis_tab_int                                  *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_variaveis_tab_int.
  DATA: aux1 LIKE sy-index,
        aux2 LIKE sy-index.
  t_busca-linha = 'DATA'.
  APPEND t_busca.
  CLEAR: t_busca, linha.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str = 'DATA'.
  CLEAR t_tab_int.
  LOOP AT tk.
    IF linha IS INITIAL.
      linha = tk-row.
      t_tab_int-linha = tk-str.
    ELSE.
      IF linha <> tk-row.
        APPEND t_tab_int.
        CLEAR t_tab_int.
        linha = tk-row.
        t_tab_int-linha = tk-str.
      ELSE.
        CONCATENATE t_tab_int-linha tk-str INTO t_tab_int-linha
                                             SEPARATED BY space.
      ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT t_tab_int-linha IS INITIAL.
    APPEND t_tab_int.
  ENDIF.
  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_tab_int.
  t_var[] = t_tab_int[].

  DATA vl_linha TYPE c.

  WHILE  vl_linha <> 'X'.
    LOOP AT t_var.
      IF t_var-linha(6) = 'BEGIN '.
        aux1 = sy-tabix.
      ELSEIF t_var-linha(4) = 'END '.
        aux2 = sy-tabix.
        DELETE t_var FROM aux1 TO aux2.
        CLEAR: aux1, aux2.
        EXIT.
      ENDIF.
    ENDLOOP.
    READ TABLE t_var WITH KEY linha(6) = 'BEGIN '.
    IF NOT sy-subrc IS INITIAL.
      vl_linha = 'X'.
    ENDIF.
  ENDWHILE.

  LOOP AT t_tab_int.
    IF t_tab_int-linha(6) = 'BEGIN ' AND aux1 IS INITIAL.
      aux1 = sy-tabix.
    ELSE.
      IF t_tab_int-linha(4) = 'END '.
        CLEAR aux1.
      ELSEIF aux1 IS INITIAL.
        DELETE t_tab_int INDEX sy-tabix.
      ENDIF.
    ENDIF.
  ENDLOOP.
  CLEAR: t_var, t_tab_int.

***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES t_tab_int
                                   t_tab_int
                            USING  'X' space space
                            CHANGING sy-subrc.
*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
*      declaracao                      = 'X'
**       EVENTO                          =
**       ROTINA                          =
*    TABLES
*      t_entrada                       = t_tab_int
*      t_retorno                       = t_tab_int
*   EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*            .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.

  ENDIF.

***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES t_var
                                   t_var
                            USING  'X' space space
                            CHANGING sy-subrc.
*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
*      declaracao                      = 'X'
**       EVENTO                          =
**       ROTINA                          =
*    TABLES
*      t_entrada                       = t_var
*      t_retorno                       = t_var
*   EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*            .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.
  ENDIF.


ENDFORM.                    " busca_variaveis_tab_int

*---------------------------------------------------------------------*
*       FORM busca_parametros                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_parametros.
  DATA: i_linha TYPE i,
        t_aux   LIKE t_split OCCURS 0 WITH HEADER LINE.

  t_busca-linha = 'PARAMETERS'.
  APPEND t_busca.
  CLEAR: t_busca.
  t_busca-linha = 'PARAMETER'.
  APPEND t_busca.
  CLEAR: t_busca, linha.
  SCAN ABAP-SOURCE t_prog
        TOKENS      INTO tk
        STATEMENTS  INTO stm
        KEYWORDS    FROM t_busca
        WITH ANALYSIS.
*  DELETE tk WHERE str = 'PARAMETERS'.
*  DELETE tk WHERE str = 'PARAMETER'.
  LOOP AT tk.

    IF tk-str CS '-'.
      CLEAR t_tabcampo.
      t_tabcampo-campotbl = tk-str.
      APPEND t_tabcampo.
    ENDIF.

    IF  tk-str EQ 'PARAMETER'
    OR  tk-str EQ 'PARAMETERS'.

      IF t_par-par IS INITIAL.
        CONTINUE.
      ELSE.
        APPEND t_par.
        CLEAR t_par.
      ENDIF.

    ELSE.

      CONCATENATE t_par-par tk-str INTO t_par-par
                              SEPARATED BY space.

    ENDIF.

  ENDLOOP. "tk

  IF NOT t_par-par IS INITIAL.
    APPEND t_par.
    CLEAR t_par.
  ENDIF.


******************
  CLEAR t_par.
  LOOP AT t_par.
    SHIFT t_par-par LEFT DELETING LEADING space.
    TRANSLATE t_par-par USING ' #'.
    SPLIT t_par-par AT '#' INTO TABLE t_split.
    CLEAR t_split.
    t_aux[] = t_split[].
*** Pego o parâmetro de selecao.
    READ TABLE t_split INDEX 1.
    MOVE t_split-campo TO t_parameter-nome.
*** Pego tudo que é like ou type
    READ TABLE t_split WITH KEY campo = 'LIKE'.
    IF sy-subrc IS INITIAL.
      MOVE t_split-campo TO t_parameter-campo.
      i_linha = sy-tabix + 1.
      READ TABLE t_aux INDEX i_linha.
      CONCATENATE t_parameter-campo t_aux-campo
             INTO t_parameter-campo SEPARATED BY space.
      CLEAR i_linha.
    ELSE.
      READ TABLE t_split WITH KEY campo = 'TYPE'.
      IF sy-subrc IS INITIAL.
        MOVE t_split-campo TO t_parameter-campo.
        i_linha = sy-tabix + 1.
        READ TABLE t_aux INDEX i_linha.
        CONCATENATE t_parameter-campo t_aux-campo
               INTO t_parameter-campo SEPARATED BY space.
        CLEAR i_linha.
      ENDIF.
    ENDIF.

*** Procuro o texto da tela se aplicável.
    READ TABLE t_textos INTO e_textos WITH KEY chave = t_aux-campo.
    IF sy-subrc IS INITIAL.
      t_parameter-campo = e_textos-texto.
    ENDIF.


*** Verifico se o parâmetro tem valor default.
    READ TABLE t_split WITH KEY campo = 'DEFAULT'.
    IF sy-subrc IS INITIAL.
      i_linha = sy-tabix + 1.
      READ TABLE t_aux INDEX i_linha.
      MOVE t_aux-campo TO t_parameter-default.
      CLEAR i_linha.
    ENDIF.

*** Verifico o tipo de parâmetro.
    LOOP AT t_split.
      CASE t_split-campo.
        WHEN 'RADIOBUTTON'.
          t_parameter-tipo = t_split-campo.
          CONTINUE.
        WHEN 'AS'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          IF t_aux-campo = 'SEARCH'.
            CONCATENATE t_split-campo t_aux-campo
                   INTO t_parameter-tipo SEPARATED BY space.
            ADD 1 TO i_linha.
            READ TABLE t_aux INDEX i_linha.
            CONCATENATE t_parameter-tipo t_aux-campo
                   INTO t_parameter-tipo SEPARATED BY space.
          ELSE.
            CONCATENATE t_split-campo t_aux-campo
                   INTO t_parameter-tipo SEPARATED BY space.
          ENDIF.
          CLEAR i_linha.
          CONTINUE.
        WHEN OTHERS.
          IF t_parameter-tipo IS INITIAL.
            t_parameter-tipo = 'PARAMETERS'.
            CONTINUE.
          ENDIF.
      ENDCASE.
*** Pego as opções complementares se houver.
      CASE t_split-campo.
        WHEN 'DECIMALS'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_parameter-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN 'MATCHCODE' OR 'FOR' OR 'VISIBLE' OR 'MODIF'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_parameter-cons SEPARATED BY space.
          ADD 1 TO i_linha.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_parameter-cons t_aux-campo
                 INTO t_parameter-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN 'GROUP'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_parameter-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN OTHERS.
          IF t_parameter-cons IS INITIAL AND
           ( t_parameter-cons NE 'LIKE' OR t_parameter-cons NE 'TYPE' ).
            t_parameter-cons = t_split-campo.
            CONTINUE.
          ENDIF.
      ENDCASE.
    ENDLOOP.
    APPEND t_parameter.
    CLEAR: t_split, t_parameter, t_aux.
    REFRESH: t_split, t_aux.
  ENDLOOP.
*****************
*** Procuro o texto da tela se aplicável.

  LOOP AT t_parameter.

    CLEAR e_textos.
    READ TABLE t_textos INTO e_textos WITH KEY chave = t_parameter-nome.
    IF sy-subrc IS INITIAL.
      t_parameter-texto = e_textos-texto.
      MODIFY t_parameter.
    ENDIF.
    CLEAR t_parameter.
  ENDLOOP.
*****


  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_par.

ENDFORM.                    " busca_parametros

*---------------------------------------------------------------------*
*       FORM busca_rotinas                                            *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_rotinas.
  t_busca-linha = 'PERFORM'.
  APPEND t_busca.
  CLEAR: t_busca, linha, t_rotinas.
  REFRESH t_rotinas.

  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
*  DELETE tk WHERE str = 'PERFORM'.

  LOOP AT tk WHERE str = 'PERFORM'.
    IF tk-row <> linha.
      linha = tk-row.
    ELSE.
      DELETE tk INDEX sy-tabix.
    ENDIF.
  ENDLOOP.

  LOOP AT tk.
    IF linha IS INITIAL.
      linha = tk-row.
      t_rotinas-rotinas = tk-str.
    ELSE.
      IF linha <> tk-row.
        IF NOT t_rotinas-rotinas IS INITIAL.
          APPEND t_rotinas.
        ENDIF.
        CLEAR t_rotinas.
        linha = tk-row.
        t_rotinas-rotinas = tk-str.
      ELSE.
        IF tk-str NE 'PERFORM'.
          CONCATENATE t_rotinas-rotinas tk-str INTO t_rotinas-rotinas
                                                   SEPARATED BY space.
        ELSE.
          APPEND t_par.
          CLEAR t_par.
          linha = tk-row.
          t_par-par = tk-str.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT t_rotinas-rotinas IS INITIAL.
    APPEND t_rotinas.
  ENDIF.

***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES t_rotinas
                                   t_rotinas
                            USING  space 'X' space
                            CHANGING sy-subrc.
*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
**     declaracao                      =
*      evento                          = 'X'
**     ROTINA                          =
*    TABLES
*      t_entrada                       = t_rotinas
*      t_retorno                       = t_rotinas
*    EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*          .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.
  ENDIF.


  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_rotinas.
ENDFORM.                    " busca_rotinas

*---------------------------------------------------------------------*
*       FORM busca_funcoes                                            *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_funcoes.
  t_busca-linha = 'FUNCTION'.
  APPEND t_busca.
  CLEAR  t_busca.
  SCAN ABAP-SOURCE t_prog
        TOKENS      INTO tk
        STATEMENTS  INTO stm
        KEYWORDS    FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str = 'FUNCTION'.
  LOOP AT tk.
    IF linha IS INITIAL.
      linha = tk-row.
      t_funcoes-funcoes = tk-str.
    ELSE.
      IF linha <> tk-row.
        IF NOT t_funcoes-funcoes IS INITIAL.
          APPEND t_funcoes.
        ENDIF.
        CLEAR t_funcoes.
        linha = tk-row.
        t_funcoes-funcoes = tk-str.
      ELSE.
        CONCATENATE t_funcoes-funcoes tk-str INTO t_funcoes-funcoes
                                                 SEPARATED BY space.
      ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT t_funcoes-funcoes IS INITIAL.
    APPEND t_funcoes.
  ENDIF.
  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_funcoes.
ENDFORM.                    " busca_funçoes

*---------------------------------------------------------------------*
*       FORM busca_includes                                           *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_includes.
  t_busca-linha = 'INCLUDE'.
  APPEND t_busca.
  CLEAR  t_busca.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str = 'INCLUDE'.

  LOOP AT tk.
    IF linha IS INITIAL.
      linha = tk-row.
      t_include-include = tk-str.
    ELSE.
      IF linha <> tk-row.
        IF NOT t_include-include IS INITIAL.
          APPEND t_include.
        ENDIF.
        CLEAR t_include.
        linha = tk-row.
        t_include-include = tk-str.
      ELSE.

        CONCATENATE t_include-include tk-str INTO t_include-include
                                                 SEPARATED BY space.
      ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT t_include-include IS INITIAL.
    APPEND t_include.
  ENDIF.
  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_include.


ENDFORM.                    " busca_includes


*---------------------------------------------------------------------*
*       FORM busca_select                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM busca_select.
*** ==> Início HCBS - 26/04/2006
  DATA:   "c_w TYPE c,
    i_c    TYPE i,
    i_f    TYPE i,
    tk_aux LIKE tk OCCURS 0 WITH HEADER LINE.
*** <== Fim HCBS - 26/04/2006

  t_busca-linha = 'SELECT'.
  APPEND t_busca.
  CLEAR  t_busca.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  LOOP AT tk.
    IF linha IS INITIAL.
      linha = tk-row.
      t_select-select = tk-str.
    ELSE.
      IF linha <> tk-row.
        IF NOT t_select-select IS INITIAL.
          APPEND t_select.
        ENDIF.
        CLEAR t_select.
        linha = tk-row.
        t_select-select = tk-str.
      ELSE.
        CONCATENATE t_select-select tk-str INTO t_select-select
                                                 SEPARATED BY space.
      ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT t_select-select IS INITIAL.
    APPEND t_select.
  ENDIF.

*** ==> Início HCBS - 26/04/2006
  CLEAR tk.
  tk_aux[] = tk[].
  LOOP AT tk WHERE str = 'SELECT'.
    i_c = sy-tabix.
*** Busca o final do select para poder trabalhar em bloco
    PERFORM busca_final TABLES   tk_aux
                        USING    i_c
                        CHANGING i_f.
*** Busca o tipo de select se aplicável
    PERFORM busca_tipo TABLES tk_aux
                        USING i_c
                              i_f.
*** Busca os campos do select
    PERFORM busca_campos TABLES tk_aux
                          USING i_c
                                i_f.
*** Busca a tabela do select
    PERFORM busca_from TABLES tk_aux
                        USING i_c
                              i_f.
*** Busca a condição geral do select
    PERFORM busca_where TABLES tk_aux
                         USING i_c
                               i_f.
*** Busca o tipo de join e sua condição se aplicável
    PERFORM busca_join TABLES tk_aux
                          USING i_c
                                i_f.
*** Busca a tabela de destino se aplicável
    PERFORM busca_into TABLES tk_aux
                        USING i_c
                              i_f.
*** Busca o for all entries se aplicável
    PERFORM busca_for TABLES tk_aux
                       USING i_c
                             i_f.
*** Busca a classificação se aplicável
    PERFORM busca_classificacao TABLES tk_aux
                                 USING i_c
                                       i_f.
*** Busca o agrupento se aplicável
    PERFORM busca_agrupamento TABLES tk_aux
                               USING i_c
                                     i_f.
    APPEND t_selecao.
    CLEAR: t_selecao,         t_selecao-tabela[], t_selecao-campos[],
           t_selecao-destino[], t_selecao-join[],   t_selecao-c_join[],
           t_selecao-cond[].
  ENDLOOP.
*** <== Fim HCBS - 26/04/2006

  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_select.
ENDFORM.                    " busca_select


*&---------------------------------------------------------------------*
*&      Form  busca_forms
*&---------------------------------------------------------------------*
*  Rotina que busca o conteudo de todos os forms.
*----------------------------------------------------------------------*
FORM busca_forms.

  DATA: l_endform(72) TYPE c,
        l_inicio      TYPE i,
        l_fim         TYPE i.

  t_busca-linha = 'FORM'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'ENDFORM'.
  APPEND t_busca.
  CLEAR t_busca.

  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  DELETE tk WHERE str <> 'FORM'
            AND   str <> 'ENDFORM'.

  CLEAR: l_inicio, l_fim.
  CLEAR t_forms_aux.
  LOOP AT tk.


    IF l_inicio IS INITIAL
    AND tk-str  EQ 'FORM'.

      l_inicio = tk-row.
      CONTINUE.

    ELSEIF l_endform IS INITIAL
    AND    tk-str    EQ 'ENDFORM'.
      l_fim = tk-row.

      t_forms_aux-inicio = l_inicio.
      t_forms_aux-fim = l_fim.
      APPEND t_forms_aux.
      CLEAR t_forms_aux.

      CLEAR: l_inicio, l_fim.
    ENDIF.
*    if l_form is initial.
*      l_form = tk-str.
*      continue.
*    elseif l_nmform is initial.
*      l_nmform = tk-str.
*      l_inicio = tk-row.
*    elseif l_endform is initial.
*      l_endform = tk-str.
*      l_fim = tk-row.
*
*      clear t_forms_aux.
*      t_forms_aux-inicio = l_inicio.
*      t_forms_aux-fim = l_fim.
*      append t_forms_aux.
*
*      clear: l_form, l_nmform, l_endform, l_inicio, l_fim.
*    endif.

    CLEAR tk.
  ENDLOOP.

  LOOP AT t_forms_aux.

    LOOP AT t_prog FROM t_forms_aux-inicio TO t_forms_aux-fim.
      CLEAR t_forms.
      t_forms-form = t_prog-linha.
      APPEND t_forms.
      CLEAR t_prog.
    ENDLOOP.

    CLEAR t_forms_aux.
  ENDLOOP.

  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_rotinas, t_forms.

***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES t_forms
                                   t_forms
                            USING  space space 'X'
                            CHANGING sy-subrc.
*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
**     declaracao                      =
**      evento                          = 'X'
*     rotina                          = 'X'
*    TABLES
*      t_entrada                       = t_forms
*      t_retorno                       = t_forms
*    EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*          .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.
  ENDIF.

***Localizar a linha que está (___)Rotina e Final da Rotina
*t_local_form

*  t_busca-linha = ' (__) Rotina'.
*  APPEND t_busca.
*  CLEAR t_busca.
*  t_busca-linha = ' Fim da Rotina'.
*  APPEND t_busca.
*  CLEAR t_busca.

  CLEAR: t_forms, v_linha_form.
  LOOP AT t_forms.

    CLEAR v_linha_form.
    MOVE t_forms-form TO v_linha_form.
    SHIFT v_linha_form LEFT  DELETING LEADING  space.

    IF v_linha_form(06) EQ c_rotina.

      t_forms-e_form = 'X'.
      MODIFY t_forms.


    ELSEIF v_linha_form(13) EQ c_fimdarotina.

      t_forms-e_endform = 'X'.
      MODIFY t_forms.

    ENDIF.

    CLEAR t_forms.
  ENDLOOP. "t_forms


ENDFORM.                    " busca_forms
*&---------------------------------------------------------------------*
*&      Form  busca_eventos
*&---------------------------------------------------------------------*
*  Buscar lógica principal, conteudo dos eventos.
*----------------------------------------------------------------------*
FORM busca_eventos.

  DATA: l_evento(72)    TYPE c,      "evento
        l_inicio        TYPE i,
        l_fim           TYPE i,
        l_ultimo_evento TYPE i,
        l_ult_linha_cod TYPE i.

  t_busca-linha = 'START-OF-SELECTION'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'END-OF-SELECTION'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'AT'.
  APPEND t_busca.
*  CLEAR t_busca.
*  t_busca-linha = 'AT SELECTION-SCREEN'.
*  APPEND t_busca.
*  CLEAR t_busca.
*  t_busca-linha = 'AT LINE-SELECTION'.
*  APPEND t_busca.
*  CLEAR t_busca.
*  t_busca-linha = 'AT USER-COMMAND'.
*  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'INITIALIZATION'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'LOAD-OF-PROGRAM'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'TOP-OF-PAGE'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'END-OF-PAGE'.
  APPEND t_busca.
  CLEAR t_busca.
  t_busca-linha = 'FORM'.
  APPEND t_busca.
  CLEAR t_busca.

  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.

  DELETE tk WHERE str <> 'START-OF-SELECTION'
            AND   str <> 'END-OF-SELECTION'
            AND   str <> 'SELECTION-SCREEN'
            AND   str <> 'LINE-SELECTION'
            AND   str <> 'USER-COMMAND'
            AND   str <> 'INITIALIZATION'
            AND   str <> 'LOAD-OF-PROGRAM'
            AND   str <> 'TOP-OF-PAGE'
            AND   str <> 'END-OF-PAGE'
            AND   str <> 'FORM'.


  CLEAR: l_ultimo_evento, l_ult_linha_cod.
  DESCRIBE TABLE tk LINES l_ultimo_evento.
  DESCRIBE TABLE t_prog LINES l_ult_linha_cod.

  LOOP AT tk.

    IF l_inicio IS INITIAL AND
       tk-str   NE 'FORM'.
      l_evento = tk-str.
      l_inicio = tk-row.

      IF l_ultimo_evento EQ sy-tabix.

        l_fim = l_ult_linha_cod.
        CLEAR t_eventos_aux.
        t_eventos_aux-inicio = l_inicio.
        t_eventos_aux-fim = l_fim.
        APPEND t_eventos_aux.

      ENDIF.

      CONTINUE.

    ELSEIF l_fim    IS INITIAL AND
       NOT l_inicio IS INITIAL AND
           tk-str   <> l_evento.

      CLEAR l_evento.
      l_evento = tk-str.
      l_fim    = tk-row - 1.

      CLEAR t_eventos_aux.
      t_eventos_aux-inicio = l_inicio.
      t_eventos_aux-fim = l_fim.
      APPEND t_eventos_aux.

      IF l_evento <> 'FORM'.
        CLEAR: l_inicio.
        l_inicio = l_fim.

      ELSE.

        CLEAR: l_inicio, l_fim, l_evento.
      ENDIF.
      CLEAR: l_fim.
    ENDIF.
    CLEAR tk.
  ENDLOOP. " TK

  LOOP AT t_eventos_aux.
    LOOP AT t_prog FROM t_eventos_aux-inicio TO t_eventos_aux-fim.

      IF t_prog-linha(1) NE '*'.
        t_eventos-eventos = t_prog-linha.
        APPEND t_eventos.
        CLEAR t_eventos.
      ENDIF.

      CLEAR t_prog.
    ENDLOOP.
    CLEAR t_eventos_aux.
  ENDLOOP.

  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm.


***-----------------------------------------------------------------***
***Função para traduzir o código em Português estruturado           ***
***-----------------------------------------------------------------***
  PERFORM zfuncao_espec_tec TABLES   t_eventos
                                     t_eventos
                            USING    space 'X' space
                            CHANGING sy-subrc.
*  CALL FUNCTION 'ZFUNCAO_ESPEC_TEC'
*    EXPORTING
**    declaracao                      =
*     evento                          = 'X'
**    rotina                          = 'X'
*    TABLES
*      t_entrada                       = t_eventos
*      t_retorno                       = t_eventos
*    EXCEPTIONS
*      tabela_inicial                  = 1
*      tipo_de_codigo_vazio            = 2
*      tipo_de_codigo_mais_de_um       = 3
*      OTHERS                          = 4
*          .
  IF sy-subrc <> 0 AND
     sy-subrc <> 1 .
    MESSAGE i208(00) WITH 'Ocorreram erros na função de tradução.'.
  ENDIF.

ENDFORM.                    " busca_eventos
*&---------------------------------------------------------------------*
*&      Form  busca_caract
*&---------------------------------------------------------------------*
*    Captura as informações de Request, Textos e Caracteriscas do
*    Programa
*----------------------------------------------------------------------*
FORM busca_caract.

**** Criação de Variaveis de tipos compativeis para Classe.
  DATA : l_var(200) TYPE c,
         l_job(200) TYPE c.

*** Objetos para captura das Informações.
*  DATA: obj_caract TYPE REF TO zcl_scan_source_atributes.
*** Inicializar as tabelas
  CLEAR: t_request, t_caract.
  REFRESH: t_request.

*** REQUEST
  PERFORM get_request TABLES   t_request
                      USING    p_prog
                      CHANGING sy-subrc.
*    CALL METHOD obj_caract->get_request
*      EXPORTING
*        nome_prog     = v_prog
*      IMPORTING
*        ex_requests   = t_request
*      EXCEPTIONS
*        nothing_found = 1
*        OTHERS        = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.


*** Fitro para os resultados.
  IF NOT t_request IS INITIAL.
    DELETE ADJACENT DUPLICATES FROM t_request COMPARING num_ordem.
  ENDIF.
*
*** TEXTOS
*** Captura de dados de Texto
  PERFORM get_text TABLES   t_textos
                   USING    space
                            sy-langu
                   CHANGING sy-subrc.

*    CALL METHOD obj_caract->get_text
**  EXPORTING
**    im_text_type   = ' '
**    IM_TRANSL_LANG = 'E'
*      IMPORTING
*        ex_text        = t_textos
*      EXCEPTIONS
*        text_not_found = 1
*        invalid_type   = 2
*        OTHERS         = 3.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.


  CLEAR t_texto_tra.
  LOOP AT t_textos INTO e_textos WHERE id = 'I'.

    MOVE: e_textos-texto    TO t_texto_tra-portug,    "Campo em Português
          e_textos-traducao TO t_texto_tra-ingles.    "ingles
    APPEND t_texto_tra.
    CLEAR t_texto_tra.


  ENDLOOP.

*** CARACTERISCAS
*** Captura de dados de Caracteriscas.
  PERFORM get_caract USING    'PROG'
                     CHANGING t_caract
                              sy-subrc.
*    CALL METHOD obj_caract->get_caract
*      IMPORTING
*        ex_caracter      = t_caract
*      EXCEPTIONS
*        caract_not_found = 1
*        OTHERS           = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

*** TRANSAÇÕES
*** OBTÉM A TRANSAÇÃO REF AO PROGRAMA INFORMADO
  PERFORM get_transaction TABLES   t_transacao
                          CHANGING sy-subrc.
*    CALL METHOD obj_caract->get_transaction
*      EXPORTING
*        im_obj_name           = sy-repid
*      IMPORTING
*        ex_trans              = t_transacao
*      EXCEPTIONS
*        transaction_not_found = 1
*        OTHERS                = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

*** Variants
*** Obtem as variantes do programa.
  PERFORM get_variant TABLES   t_variant
                      CHANGING sy-subrc.
*  CALL METHOD obj_caract->get_variant
*    IMPORTING
*      ex_variante       = t_variant
*    EXCEPTIONS
*      variant_not_found = 1
*      OTHERS            = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CLEAR v_variant.
  LOOP AT t_variant INTO e_variant.

    IF v_variant IS INITIAL.
      MOVE e_variant-variante TO v_variant.
    ELSE.
      CLEAR l_var.
      MOVE e_variant-variante TO l_var.
      CONCATENATE v_variant
                  l_var
                  INTO
                  v_variant
                  SEPARATED BY ' / '.
    ENDIF.

  ENDLOOP.

*** JOBS
*** Lista de Jobs
  DATA: lv_jobname TYPE string.
  CONCATENATE '%' p_prog '%' INTO lv_jobname.
  SELECT *
  FROM v_op
  INTO TABLE t_job
  WHERE jobname LIKE lv_jobname.
*  CALL METHOD obj_caract->get_job
*    IMPORTING
*      ex_job            = t_job
*    EXCEPTIONS
*      job_nothing_found = 1
*      OTHERS            = 2.
  IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CLEAR v_job.
  LOOP AT t_job INTO e_job.

    IF v_job IS INITIAL.
      MOVE: e_job-jobname TO v_job.
    ELSE.
      CLEAR l_var.
      MOVE e_job-jobname TO l_job.
      CONCATENATE v_job
                  l_job
                  INTO
                  v_job
                  SEPARATED BY ' / '.
    ENDIF.

  ENDLOOP.

ENDFORM.                    " busca_caract

*** ==> Início HCBS - 26/04/2006
*&---------------------------------------------------------------------*
*&      Form  busca_final
*&---------------------------------------------------------------------*
FORM busca_final TABLES   p_tk_aux STRUCTURE tk
                 USING    p_i_c
                 CHANGING p_i_f.

*  DATA l_total LIKE sy-tabix.
*  DESCRIBE TABLE p_tk_aux LINES l_total.

  p_i_f = p_i_c.
  IF p_i_c NE 1.
    ADD 1 TO p_i_f.
    READ TABLE p_tk_aux INDEX p_i_f.
  ENDIF.

  WHILE p_tk_aux-str <> 'SELECT'.
    ADD 1 TO p_i_f.
    READ TABLE p_tk_aux INDEX p_i_f.
    IF sy-subrc <> 0.
      SUBTRACT 1 FROM p_i_f.
      EXIT.
    ENDIF.
  ENDWHILE.
ENDFORM.                    " busca_final
*&---------------------------------------------------------------------*
*&      Form  BUSCA_TIPO
*&---------------------------------------------------------------------*
FORM busca_tipo TABLES   p_tk_aux STRUCTURE tk
                USING    p_i_c
                         p_i_f.
  DATA: t_aux LIKE tk OCCURS 0 WITH HEADER LINE,
        linha TYPE i.

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    CASE p_tk_aux-str.
      WHEN 'SINGLE' OR 'DISTINCT' OR 'MAX' OR 'COUNT'.
        t_selecao-tipo = p_tk_aux-str.
      WHEN 'UP'.
        t_aux[] = p_tk_aux[].
        READ TABLE t_aux INDEX sy-tabix.
        linha = sy-tabix.
        DO 4 TIMES.
          IF t_selecao-tipo IS INITIAL.
            t_selecao-tipo = t_aux-str.
          ELSE.
            CONCATENATE t_selecao-tipo t_aux-str
                   INTO t_selecao-tipo SEPARATED BY space.
          ENDIF.
          ADD 1 TO linha.
          READ TABLE t_aux INDEX linha.
        ENDDO.
    ENDCASE.
  ENDLOOP.

  CLEAR: linha, t_aux[].
  REFRESH: t_aux.
  FREE: t_aux, linha.
ENDFORM.                    " BUSCA_TIPO
*&---------------------------------------------------------------------*
*&      Form  busca_from
*&---------------------------------------------------------------------*
FORM busca_from TABLES   p_tk_aux STRUCTURE tk
                USING    p_i_c
                         p_i_f.
  TABLES: dd02t.

  DATA: tl_aux   LIKE tk OCCURS 0 WITH HEADER LINE,
        tl_dd02t TYPE dd02t OCCURS 0 WITH HEADER LINE,
        linha    TYPE i,
        linha1   TYPE i,
        linha_i  TYPE i,
        linha_f  TYPE i,
        lt_tab   LIKE t_tab OCCURS 0.

  tl_aux[] = p_tk_aux[].

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    CASE p_tk_aux-str.

      WHEN 'FROM'.
        linha_i = sy-tabix.
      WHEN 'WHERE' OR 'LEFT' OR 'FOR' OR 'INNER'.
        linha_f = sy-tabix - 1.
        EXIT.
    ENDCASE.
  ENDLOOP.

  LOOP AT p_tk_aux FROM linha_i TO linha_f.
    IF p_tk_aux-str = 'FROM'.
      tl_aux[] = p_tk_aux[].
      linha = sy-tabix + 1.
      DO.
        READ TABLE tl_aux INDEX linha.
        IF tl_aux-str EQ 'WHERE' OR
           tl_aux-str EQ 'LEFT'  OR
           tl_aux-str EQ 'INTO'  OR
           tl_aux-str EQ 'FOR'   OR
           tl_aux-str EQ 'INNER'.
          EXIT.
        ENDIF.
        IF tl_aux-str EQ 'AS'.
          t_tabela-apelido = tl_aux-str.
          linha1 = linha.
          ADD 1 TO linha1.
          READ TABLE tl_aux INDEX linha1.
          CONCATENATE t_tabela-apelido tl_aux-str
                 INTO t_tabela-apelido SEPARATED BY space.
        ENDIF.

        t_tabela-tabela = tl_aux-str.

        PERFORM z_scan_source_get_field_descr TABLES lt_tab
                                                     tl_dd02t
                                              USING  tl_aux-str.
*        CALL FUNCTION 'Z_SCAN_SOURCE_GET_FIELD_DESCR'
*          DESTINATION p_rfc
*          EXPORTING
*            im_scan  = tl_aux-str
*          TABLES
*            ex_dd02t = tl_dd02t.

        t_tabela-descricao = dd02t-ddtext.
        APPEND t_tabela.
        ADD 1 TO linha.
      ENDDO.
    ENDIF.
  ENDLOOP.

  t_selecao-tabela[] = t_tabela[].
  CLEAR: t_tabela[], tl_aux[], linha, linha1.
  REFRESH: t_tabela, tl_aux.
  FREE:  t_tabela, tl_aux, linha, linha1.

ENDFORM.                    " busca_from
*&---------------------------------------------------------------------*
*&      Form  busca_where
*&---------------------------------------------------------------------*
FORM busca_where TABLES   p_tk_aux STRUCTURE tk
                 USING    p_i_c
                          p_i_f.
  DATA: t_aux  LIKE tk OCCURS 0 WITH HEADER LINE,
        linha  TYPE i,
        linha1 TYPE i,
        vezes  TYPE i.

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str EQ 'WHERE'.
      t_aux[] = p_tk_aux[].
      linha = sy-tabix + 1.
      DO.
        READ TABLE t_aux INDEX linha.
        IF t_aux-str EQ 'GROUP' OR
           t_aux-str EQ 'HAVING'  OR
           t_aux-str EQ 'ORDER' OR
           linha     GT p_i_f.
          EXIT.
        ENDIF.

        IF t_aux-str = '('.
          linha1 = linha.
          ADD 1 TO vezes.
          WHILE t_aux-str <> ')'.
            ADD 1 TO: vezes, linha1.
            READ TABLE t_aux INDEX linha1.
          ENDWHILE.
        ELSE.
          vezes = 3.
        ENDIF.

        DO vezes TIMES.
          CASE vezes.
            WHEN 3.
              IF t_condicoes-tabela IS INITIAL.
                t_condicoes-tabela = t_aux-str.
              ELSEIF t_condicoes-operador IS INITIAL.
                t_condicoes-operador = t_aux-str.
              ELSE.
                t_condicoes-campo = t_aux-str.
              ENDIF.
            WHEN OTHERS.
              READ TABLE t_aux INDEX linha.
              IF t_condicoes-tabela IS INITIAL.
                t_condicoes-tabela = t_aux-str.
              ELSEIF t_condicoes-tabela = '('.
                CONCATENATE t_condicoes-tabela t_aux-str
                       INTO t_condicoes-tabela SEPARATED BY space.
              ELSEIF t_condicoes-operador IS INITIAL.
                t_condicoes-operador = t_aux-str.
              ELSEIF t_condicoes-campo IS INITIAL.
                t_condicoes-campo = t_aux-str.
              ELSEIF t_aux-str EQ ')'.
                CONCATENATE t_condicoes-campo t_aux-str
                       INTO t_condicoes-campo SEPARATED BY space.
              ELSEIF t_aux-str = 'AND' OR t_aux-str = 'OR'.
                t_condicoes-con = t_aux-str.
              ELSEIF NOT ( t_condicoes-tabela   IS INITIAL AND
                           t_condicoes-operador IS INITIAL AND
                           t_condicoes-campo    IS INITIAL ).
                APPEND t_condicoes.
                CLEAR: t_condicoes.
                t_condicoes-tabela = t_aux-str.
              ENDIF.
          ENDCASE.
          ADD 1 TO linha.
          READ TABLE t_aux INDEX linha.
        ENDDO.

        IF t_aux-str = 'AND' OR t_aux-str = 'OR'.
          t_condicoes-con = t_aux-str.
        ENDIF.

        IF vezes NE 5.
          ADD 1 TO linha.
        ENDIF.
        APPEND t_condicoes.
        CLEAR: t_condicoes, vezes.
      ENDDO.
    ENDIF.
  ENDLOOP.
  t_selecao-cond[] = t_condicoes[].
  CLEAR: t_condicoes[], t_aux[], linha, linha1, vezes.
  REFRESH: t_condicoes, t_aux.
  FREE:  t_condicoes, t_aux, linha, linha1, vezes.
ENDFORM.                    " busca_where
*&---------------------------------------------------------------------*
*&      Form  busca_join
*&---------------------------------------------------------------------*
FORM busca_join TABLES   p_tk_aux STRUCTURE tk
                USING    p_i_c
                         p_i_f.
  DATA: t_aux   LIKE tk OCCURS 0 WITH HEADER LINE,
        linha   TYPE i,
        linha1  TYPE i,
        vezes   TYPE i,
        linha_i TYPE i,
        linha_f TYPE i.

  t_aux[] = p_tk_aux[].
  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str = 'LEFT' OR p_tk_aux-str = 'INNER'.
      linha_i = sy-tabix.
    ELSEIF p_tk_aux-str = 'INTO' OR p_tk_aux-str = 'WHERE'.
      linha_f = sy-tabix - 1.
      EXIT.
    ENDIF.
  ENDLOOP.

*** Lógica para identificar o tipo, a tabela, e as condições do join
  LOOP AT p_tk_aux FROM linha_i TO linha_f.
    IF linha_i IS INITIAL.
      EXIT.
    ENDIF.
    linha = sy-tabix.
    CASE p_tk_aux-str.
      WHEN 'LEFT'.  " o join é do tipo left outer
        DO 4 TIMES.
          IF vezes EQ 3.
            READ TABLE t_aux INDEX linha.
            t_join-tabela = t_aux-str.
            CLEAR vezes.
          ELSE.
            READ TABLE t_aux INDEX linha.
            IF t_join-tipo IS INITIAL.
              t_join-tipo = t_aux-str.
            ELSE.
              CONCATENATE t_join-tipo t_aux-str
                     INTO t_join-tipo SEPARATED BY space.
            ENDIF.
            ADD 1 TO: linha, vezes.
          ENDIF.
        ENDDO.
        APPEND t_join.
        CLEAR: vezes, t_join.
      WHEN 'INNER'.  " o join é do tipo inner
        DO 3 TIMES.
          IF vezes EQ 2.
            READ TABLE t_aux INDEX linha.
            t_join-tabela = t_aux-str.
            CLEAR vezes.
          ELSE.
            READ TABLE t_aux INDEX linha.
            IF t_join-tipo IS INITIAL.
              t_join-tipo = t_aux-str.
            ELSE.
              CONCATENATE t_join-tipo t_aux-str
                     INTO t_join-tipo SEPARATED BY space.
            ENDIF.
            ADD 1 TO: linha, vezes.
          ENDIF.
        ENDDO.
        APPEND t_join.
        CLEAR: vezes, t_join.
      WHEN 'ON'.  "estou lendo a condição do join
        WHILE linha > linha_i AND linha < linha_f.
          IF vezes NE 3.
            ADD 1 TO linha.
            READ TABLE t_aux INDEX linha.
          ENDIF.
          IF vezes IS INITIAL.
            ADD 1 TO vezes.
          ENDIF.

          CASE vezes.
            WHEN 1.
              t_c_join-t_a = t_aux-str.
              ADD 1 TO vezes.
            WHEN 2.
              t_c_join-operador = t_aux-str.
              ADD 1 TO vezes.
            WHEN 3.
              ADD 1 TO linha.
              READ TABLE t_aux INDEX linha.
              t_c_join-t_b = t_aux-str.
              ADD 1 TO vezes.
              IF t_aux-str NE 'AND' OR t_aux-str NE 'OR'.
                CLEAR vezes.
                APPEND t_c_join.
              ENDIF.
            WHEN 4.
              t_c_join-con = t_aux-str.
              ADD 1 TO vezes.
          ENDCASE.
          IF ( t_aux-str EQ 'AND' OR t_aux-str EQ 'OR' ) AND vezes EQ 4.
            CLEAR vezes.
            APPEND t_c_join.
          ENDIF.
        ENDWHILE.
        t_selecao-join[]   = t_join[].
        t_selecao-c_join[] = t_c_join[].
*        APPEND t_selecao.
        CLEAR: t_c_join[], t_join[].

      WHEN 'AS'.  "a tabela tem apelido
        t_join-apelido = t_aux-str.
        linha1 = linha.
        ADD 1 TO linha1.
        READ TABLE t_aux INDEX linha1.
        IF t_join-apelido IS INITIAL.
          t_join-apelido = t_aux-str.
        ELSE.
          CONCATENATE t_join-apelido t_aux-str
                 INTO t_join-apelido SEPARATED BY space.
        ENDIF.
        CLEAR linha1.
    ENDCASE.
  ENDLOOP.
ENDFORM.                    " busca_join
*&---------------------------------------------------------------------*
*&      Form  busca_into
*&---------------------------------------------------------------------*
FORM busca_into TABLES   p_tk_aux STRUCTURE tk
                USING    p_i_c
                         p_i_f.
  DATA: linha_i TYPE i,
        linha_f TYPE i,
        c_from  TYPE c.

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str = 'FROM' AND linha_i IS INITIAL.
      c_from = 'X'.
    ENDIF.

    IF c_from = 'X'.
      IF p_tk_aux-str = 'INTO'.
        linha_i = sy-tabix.
      ELSEIF p_tk_aux-str = 'WHERE' OR p_tk_aux-str = 'FOR'.
        linha_f = sy-tabix - 1.
        EXIT.
      ENDIF.
    ELSE.
      IF p_tk_aux-str = 'INTO'.
        linha_i = sy-tabix.
      ELSEIF p_tk_aux-str = 'FROM' OR p_tk_aux-str = 'FOR'.
        linha_f = sy-tabix - 1.
        EXIT.
      ENDIF.
    ENDIF.
  ENDLOOP.

  IF NOT linha_i IS INITIAL.
    LOOP AT p_tk_aux FROM linha_i TO linha_f.
      IF sy-tabix = linha_f.
        t_destino-tabela = p_tk_aux-str.
        APPEND t_destino.
        t_selecao-destino[] = t_destino[].
        CLEAR t_destino[].
      ELSE.
        IF p_tk_aux-str NE 'INTO' AND p_tk_aux-str NE 'TABLE'.
          t_destino-tabela = p_tk_aux-str.
          APPEND t_destino.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.                    " busca_into
*&---------------------------------------------------------------------*
*&      Form  busca_for
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_TK_AUX  text
*      -->P_I_C  text
*      -->P_I_F  text
*----------------------------------------------------------------------*
FORM busca_for TABLES   p_tk_aux STRUCTURE tk
               USING    p_i_c
                        p_i_f.
  DATA: t_aux   LIKE tk OCCURS 0 WITH HEADER LINE,
        linha   TYPE i,
        linha_i TYPE i,
        linha_f TYPE i.


  t_aux[] = p_tk_aux[].

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str = 'FOR'.
      linha_i = sy-tabix.
      linha = sy-tabix + 1.
      READ TABLE t_aux INDEX linha.
      IF t_aux-str EQ 'UPDATE'.
        CLEAR linha_i.
        CONTINUE.
      ENDIF.
    ELSEIF p_tk_aux-str = 'WHERE'.
      linha_f = sy-tabix - 1.
      EXIT.
    ENDIF.
  ENDLOOP.

  IF NOT linha_i IS INITIAL.
    LOOP AT p_tk_aux FROM linha_i TO linha_f.
      linha = sy-tabix.
      IF p_tk_aux-str EQ 'IN'.
        ADD 1 TO linha.
        READ TABLE t_aux INDEX linha.
        t_selecao-for_all = t_aux-str.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.                    " busca_for
*&---------------------------------------------------------------------*
*&      Form  busca_classificacao
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_TK_AUX  text
*      -->P_I_C  text
*      -->P_I_F  text
*----------------------------------------------------------------------*
FORM busca_classificacao TABLES   p_tk_aux STRUCTURE tk
                         USING    p_i_c
                                  p_i_f.
  DATA: linha_i TYPE i,
        linha_f TYPE i.

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str EQ 'ORDER'.
      linha_i = sy-tabix.
    ELSEIF sy-tabix EQ p_i_f.
      linha_f = sy-tabix.
      EXIT.
    ENDIF.
  ENDLOOP.

  IF NOT linha_i IS INITIAL.
    LOOP AT p_tk_aux FROM linha_i TO linha_f.
      IF p_tk_aux-str EQ 'ORDER' OR p_tk_aux-str = 'BY'.
        CONTINUE.
      ELSE.
        IF t_selecao-classf IS INITIAL.
          t_selecao-classf = p_tk_aux-str.
        ELSE.
          CONCATENATE t_selecao-classf p_tk_aux-str INTO
                      t_selecao-classf SEPARATED BY space.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.                    " busca_classificacao
*&---------------------------------------------------------------------*
*&      Form  busca_agrupamento
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_TK_AUX  text
*      -->P_I_C  text
*      -->P_I_F  text
*----------------------------------------------------------------------*
FORM busca_agrupamento TABLES   p_tk_aux STRUCTURE tk
                       USING    p_i_c
                                p_i_f.
  DATA: linha_i TYPE i,
        linha_f TYPE i.

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str EQ 'GROUP'.
      linha_i = sy-tabix.
    ELSEIF sy-tabix EQ p_i_f.
      linha_f = sy-tabix.
      EXIT.
    ENDIF.
  ENDLOOP.

  IF NOT linha_i IS INITIAL.
    LOOP AT p_tk_aux FROM linha_i TO linha_f.
      IF p_tk_aux-str EQ 'GROUP' OR p_tk_aux-str = 'BY'.
        CONTINUE.
      ELSE.
        IF t_selecao-classf IS INITIAL.
          t_selecao-classf = p_tk_aux-str.
        ELSE.
          CONCATENATE t_selecao-classf p_tk_aux-str INTO
                      t_selecao-classf SEPARATED BY space.
        ENDIF.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.                    " busca_agrupamento
*&---------------------------------------------------------------------*
*&      Form  busca_campos
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_TK_AUX  text
*      -->P_I_C  text
*      -->P_I_F  text
*----------------------------------------------------------------------*
FORM busca_campos TABLES   p_tk_aux STRUCTURE tk
                  USING    p_i_c
                           p_i_f.
  DATA: t_aux   LIKE tk OCCURS 0 WITH HEADER LINE,
        linha   TYPE i,
        linha_i TYPE i,
        linha_f TYPE i.

  t_aux[] = p_tk_aux[].

  LOOP AT p_tk_aux FROM p_i_c TO p_i_f.
    IF p_tk_aux-str = 'SELECT'.
      linha_i = sy-tabix + 1.
      linha = sy-tabix + 1.
      READ TABLE t_aux INDEX linha.
      IF t_aux-str EQ 'SINGLE'.
        linha_i = sy-tabix + 1.
        CONTINUE.
      ENDIF.
    ELSEIF p_tk_aux-str = 'FROM' OR p_tk_aux-str = 'INTO' OR
           p_tk_aux-str = 'UP'.
      linha_f = sy-tabix - 1.
      EXIT.
    ENDIF.
  ENDLOOP.

  IF NOT linha_i IS INITIAL.
    IF linha_i EQ linha_f.
      READ TABLE p_tk_aux INDEX linha_i.
      t_campos-campo = p_tk_aux-str.
      APPEND t_campos.
    ELSE.
      LOOP AT p_tk_aux FROM linha_i TO linha_f.
        t_campos-campo = p_tk_aux-str.
        APPEND t_campos.
      ENDLOOP.
    ENDIF.
    t_selecao-campos[] = t_campos[].
    CLEAR t_campos[].
  ENDIF.
ENDFORM.                    " busca_campos
*** <== Fim HCBS - 26/04/2006
*&---------------------------------------------------------------------*
*&      Form  busca_carac_campo
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_T_CAMPODESC  text
*      -->P_0918   text
*----------------------------------------------------------------------*
*FORM busca_carac_campo TABLES   p_t_campodesc STRUCTURE t_campodesc
*                       USING    value(p_campotab).
*
*  DATA: BEGIN OF tl_tab_campo OCCURS 0,
*         campo(30)     TYPE c,
*         tabela(30)    TYPE c,
*        END OF tl_tab_campo.
*
*  CHECK NOT p_campotab IS INITIAL.
*
*  SPLIT p_campotab AT '-'
*  INTO  tl_tab_campo-tabela tl_tab_campo-campo.
*  APPEND tl_tab_campo.
*  CLEAR tl_tab_campo.
*
*  SELECT a~tabname a~fieldname a~position a~scrtext_l
*         b~datatype b~leng b~decimals b~domname
*  INTO TABLE p_t_campodesc
*  FROM ddftx AS a
*    INNER JOIN dd03l AS b ON a~tabname = b~tabname
*                         AND a~fieldname = b~fieldname
*                         AND b~as4local = 'A'
*  FOR ALL ENTRIES IN tl_tab_campo
*  WHERE a~tabname    = tl_tab_campo-tabela
*  AND   a~fieldname  = tl_tab_campo-campo
*  AND   a~ddlanguage = sy-langu.
*  BREAK-POINT.
*ENDFORM.                    " busca_carac_campo
*&---------------------------------------------------------------------*
*&      Form  busca_select_options
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM busca_select_options.
  DATA: i_linha TYPE i,
        t_aux   LIKE t_split OCCURS 0 WITH HEADER LINE.

  t_busca-linha = 'SELECT-OPTIONS'.
  APPEND t_busca.
  CLEAR: t_busca, linha.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
*  DELETE tk WHERE str = 'SELECT-OPTIONS'.
  LOOP AT tk.


    IF  tk-str EQ 'SELECT-OPTIONS'.

      IF t_sel_opt-par IS INITIAL.
        CONTINUE.
      ELSE.
        APPEND t_sel_opt.
        CLEAR t_sel_opt.
      ENDIF.

    ELSE.

      CONCATENATE t_sel_opt-par tk-str INTO t_sel_opt-par
                                       SEPARATED BY space.

    ENDIF.

  ENDLOOP.
  IF NOT t_sel_opt-par IS INITIAL.
    APPEND t_sel_opt.
  ENDIF.
******************
  CLEAR t_sel_opt.
  LOOP AT t_sel_opt.
    SHIFT t_sel_opt-par LEFT DELETING LEADING space.
    TRANSLATE t_sel_opt-par USING ' #'.
    SPLIT t_sel_opt-par AT '#' INTO TABLE t_split.
    CLEAR t_split.
    t_aux[] = t_split[].
*** Pego o parâmetro de selecao.
    READ TABLE t_split INDEX 1.
    MOVE t_split-campo TO t_select_opt-nome.
*** Pego tudo que é like ou type
    READ TABLE t_split WITH KEY campo = 'FOR'.
    IF sy-subrc IS INITIAL.
      MOVE t_split-campo TO t_select_opt-campo.
      i_linha = sy-tabix + 1.
      READ TABLE t_aux INDEX i_linha.
      CONCATENATE t_select_opt-campo t_aux-campo
             INTO t_select_opt-campo SEPARATED BY space.
      CLEAR i_linha.
    ELSE.
      READ TABLE t_split WITH KEY campo = 'TYPE'.
      IF sy-subrc IS INITIAL.
        MOVE t_split-campo TO t_select_opt-campo.
        i_linha = sy-tabix + 1.
        READ TABLE t_aux INDEX i_linha.
        CONCATENATE t_select_opt-campo t_aux-campo
               INTO t_select_opt-campo SEPARATED BY space.
        CLEAR i_linha.
      ENDIF.
    ENDIF.

*** Verifico se o parâmetro tem valor default.
    READ TABLE t_split WITH KEY campo = 'DEFAULT'.
    IF sy-subrc IS INITIAL.
      i_linha = sy-tabix + 1.
      READ TABLE t_aux INDEX i_linha.
      MOVE t_aux-campo TO t_select_opt-default.
      CLEAR i_linha.
    ENDIF.

*** Verifico o tipo de parâmetro.
    LOOP AT t_split.
      CASE t_split-campo.
        WHEN 'RADIOBUTTON'.
          t_select_opt-tipo = t_split-campo.
          CONTINUE.
        WHEN 'AS'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          IF t_aux-campo = 'SEARCH'.
            CONCATENATE t_split-campo t_aux-campo
                   INTO t_select_opt-tipo SEPARATED BY space.
            ADD 1 TO i_linha.
            READ TABLE t_aux INDEX i_linha.
            CONCATENATE t_select_opt-tipo t_aux-campo
                   INTO t_select_opt-tipo SEPARATED BY space.
          ELSE.
            CONCATENATE t_split-campo t_aux-campo
                   INTO t_select_opt-tipo SEPARATED BY space.
          ENDIF.
          CLEAR i_linha.
          CONTINUE.
        WHEN OTHERS.
          IF t_select_opt-tipo IS INITIAL.
            t_select_opt-tipo = 'SELECT-OPTIONS'.
            CONTINUE.
          ENDIF.
      ENDCASE.
*** Pego as opções complementares se houver.
      CASE t_split-campo.
        WHEN 'DECIMALS'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_select_opt-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN 'MATCHCODE' OR 'FOR' OR 'VISIBLE' OR 'MODIF'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_select_opt-cons SEPARATED BY space.
          ADD 1 TO i_linha.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_select_opt-cons t_aux-campo
                 INTO t_select_opt-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN 'GROUP'.
          i_linha = sy-tabix + 1.
          READ TABLE t_aux INDEX i_linha.
          CONCATENATE t_split-campo t_aux-campo
                 INTO t_select_opt-cons SEPARATED BY space.
          CLEAR i_linha.
          CONTINUE.
        WHEN OTHERS.
          IF t_select_opt-cons IS INITIAL AND
           ( t_select_opt-cons NE 'LIKE' OR
             t_select_opt-cons NE 'TYPE' ).
            t_select_opt-cons = t_split-campo.
            CONTINUE.
          ENDIF.
      ENDCASE.
    ENDLOOP.
    APPEND t_select_opt.
    CLEAR: t_split, t_select_opt.
    REFRESH t_split.
  ENDLOOP.
*****************
*****************
*** Procuro o texto da tela se aplicável.

  LOOP AT t_select_opt.

    CLEAR e_textos.
    READ TABLE t_textos INTO e_textos WITH KEY chave = t_select_opt-nome.
    IF sy-subrc IS INITIAL.
      t_select_opt-texto = e_textos-texto.
      MODIFY t_select_opt.
    ENDIF.
    CLEAR t_select_opt.
  ENDLOOP.


  FREE:  t_busca, tk, stm.
  CLEAR: t_busca, tk, stm, t_sel_opt.

ENDFORM.                    " busca_select_options
*&---------------------------------------------------------------------*
*&      Form  progresso
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_TEXTO  text
*----------------------------------------------------------------------*
FORM progresso USING p_texto.
  CALL FUNCTION 'SAPGUI_PROGRESS_INDICATOR'
    EXPORTING
      percentage = 0
      text       = p_texto.
ENDFORM.                    " progresso
*&---------------------------------------------------------------------*
*&      Form  busca_pastabatch
*&---------------------------------------------------------------------*
* Buscar pasta btch
*----------------------------------------------------------------------*
FORM busca_pastabatch .


  DATA: vl_tabix      LIKE sy-tabix,
        vl_tabix_nome LIKE sy-tabix,
        vl_str(20)    TYPE c,
        vl_check      TYPE c,
        vl_igual      TYPE c.

  CLEAR:  vl_tabix,
          vl_tabix_nome,
          vl_str,
          vl_check,
          vl_igual,
          v_nome_pasta_batch.




  CONCATENATE: TEXT-018  " '
               'BDC_OPEN_GROUP'
               TEXT-018  " '
               INTO
               vl_str.


  t_busca-linha = 'CALL'.
  APPEND t_busca.
  CLEAR: t_busca, linha.
  SCAN ABAP-SOURCE t_prog
        TOKENS     INTO tk
        STATEMENTS INTO stm
        KEYWORDS   FROM t_busca
        WITH ANALYSIS.
  CLEAR tk.
  READ TABLE tk WITH KEY str = vl_str.
  IF sy-subrc IS INITIAL.
    vl_tabix =  sy-tabix.

    LOOP AT tk FROM vl_tabix.

      IF tk-str EQ 'GROUP'.
        vl_tabix_nome = sy-tabix + 2.

      ENDIF.

    ENDLOOP. "tk
  ENDIF.

  READ TABLE tk INDEX vl_tabix_nome.
  IF sy-subrc IS INITIAL.

    MOVE: tk-str TO v_nome_pasta_batch.

  ENDIF.


ENDFORM.                    " busca_pastabatch
*&---------------------------------------------------------------------*
*&      Form  Z_SCAN_SOURCE_GET_FIELD_DESCR
*&---------------------------------------------------------------------*
FORM z_scan_source_get_field_descr  TABLES   im_tabela STRUCTURE ys001
                                             ex_dd02t STRUCTURE dd02t
                                    USING    im_scan TYPE  token_str.

  IF NOT im_tabela[] IS INITIAL.

    SELECT *
    FROM dd02t
    INTO TABLE t_desc_tab
    FOR ALL ENTRIES IN im_tabela[]
    WHERE tabname    EQ im_tabela-tab_name
    AND   ddlanguage EQ sy-langu.

    IF sy-subrc IS INITIAL.
      ...
    ENDIF.

  ELSE.
    CHECK NOT im_scan IS INITIAL.

    SELECT *
      FROM dd02t
      INTO ex_dd02t
      UP TO 1 ROWS
      WHERE tabname = im_scan AND
            ddlanguage = sy-langu.
    ENDSELECT.

  ENDIF.

ENDFORM.                    " Z_SCAN_SOURCE_GET_FIELD_DESCR
*&---------------------------------------------------------------------*
*&      Form  z_define_font
*&---------------------------------------------------------------------*
*       Escreve texto na Seleção
*----------------------------------------------------------------------*
FORM z_escreve_texto  USING VALUE(p_font)
                            VALUE(p_size)
                            VALUE(p_bold)
                            VALUE(p_italic)
                            VALUE(p_underline)
                            VALUE(p_fcolor)
                            VALUE(p_bgcolor)
                            VALUE(p_index)
                            VALUE(p_text).

  FREE OBJECT  gs_parformat.
* Define Cor BackGround
  GET PROPERTY OF gs_selection 'ParagraphFormat' = gs_parformat .

  IF NOT p_bgcolor IS INITIAL.
    PERFORM z_define_bgcolor USING gs_parformat
                                   p_bgcolor.
  ENDIF.

  IF NOT p_index IS INITIAL.
    PERFORM z_insere_index USING  gs_range
                                    p_index.
  ENDIF.

  PERFORM z_define_font USING    gs_selection
                                 p_font        "Name
                                 p_size        "Size
                                 p_bold        "Bold(1) NotBold(0)
                                 p_italic      "Italic
                                 p_underline   "Underline
                                 p_fcolor.      "Font Color


  CALL METHOD OF gs_selection 'TypeText'
    EXPORTING
      #1 = p_text.

* Pula uma linha
  PERFORM z_new_line.
* reseta a cor de fundo da nova linha
  CALL METHOD OF gs_parformat 'Reset'.

ENDFORM.                    " z_escreve_texto
*&---------------------------------------------------------------------*
*&      Form  z_define_font
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->p_name        text
*      -->p_size        text
*      -->p_bold        text
*      -->p_italic      text
*      -->p_underline   text
*----------------------------------------------------------------------*
FORM z_define_font  USING    p_gs
                             VALUE(p_name)
                             VALUE(p_size)
                             VALUE(p_bold)
                             VALUE(p_italic)
                             VALUE(p_underline)
                             VALUE(p_fcolor).

*tables.cell.range.font
  GET PROPERTY OF p_gs 'Font' = gs_font.
  IF p_fcolor IS INITIAL.
    p_fcolor = wdcolorautomatic.
  ENDIF.
  SET PROPERTY OF gs_font 'Name' = p_name.
  SET PROPERTY OF gs_font 'Size' = p_size.
  SET PROPERTY OF gs_font 'Bold' = p_bold.      "Bold(1) Not bold(0)
  SET PROPERTY OF gs_font 'Italic' = p_italic .             "Italic(1)
  SET PROPERTY OF gs_font 'Underline' = p_underline."Under(1)Not uder(0)
  SET PROPERTY OF gs_font 'Color' = p_fcolor.


ENDFORM.                    " z_define_font
*&---------------------------------------------------------------------*
*&      Form  z_new_line
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*

*----------------------------------------------------------------------*
FORM z_new_line .
  CALL METHOD OF gs_selection 'TypeParagraph' .
ENDFORM.                    " z_new_line
*&---------------------------------------------------------------------*
*&      Form  z_cria_tabela
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_GS_TABLES  text
*      -->p_gs_range   text
*      -->p_linhas     text
*      -->p_colunas    text
*----------------------------------------------------------------------*
FORM z_cria_tabela  USING    p_gs_tables
                             p_gs_range
                             VALUE(p_linhas)
                             VALUE(p_colunas)
                    CHANGING p_gs_table.

* Adciona uma tabela com p_Linhas e p_Colunas colunas
  CALL METHOD OF p_gs_tables 'Add' = p_gs_table
    EXPORTING
      #1 = p_gs_range "Handle for range entity
      #2 = p_linhas   "Number of rows
      #3 = p_colunas. "Number of columns

*  GET PROPERTY OF gs_table 'Borders' = gs_borders.
*  SET PROPERTY OF gs_borders 'Enable' = '1' . "With border

ENDFORM.                    " z_cria_tabela
*&---------------------------------------------------------------------*
*&      Form  z_ajusta_largura_cell
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_GS_CELL         text
*      -->p_largura         text
*      -->p_autoajuste      text
*      <--p_gs_table_width  text
*----------------------------------------------------------------------*
FORM z_ajusta_largura_cell  USING    p_gs_cell            "Obj Celula
                                     VALUE(p_largura)     "Largura
                                     VALUE(p_autoajuste)  "AutoAjuste(1)
                                     CHANGING p_gs_table_width.

  CALL METHOD OF p_gs_cell 'SetWidth' = p_gs_table_width
    EXPORTING
      #1 = p_largura      "Largura CM
      #2 = p_autoajuste.  "AutoAjuste(1)


ENDFORM.                    " z_ajusta_largura_cell
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_GS_CELL     text
*      -->P_altura      text
*      -->P_autoajuste  text
*----------------------------------------------------------------------*
FORM z_ajusta_altura_cell  USING     p_gs_cell           "Obj Celula
                                     VALUE(p_altura)     "Altura
                                     VALUE(p_autoajuste) "AutoAjuste(1)
                                     CHANGING p_gs_table_height.

  CALL METHOD OF p_gs_cell 'SetHeight' = p_gs_table_height
    EXPORTING
      #1 = p_altura        "Altura CM
      #2 = p_autoajuste.   "AutoAjuste(1)



ENDFORM.                    " z_ajusta_altura_cell
*&---------------------------------------------------------------------*
*&      Form  z_define_coord_cell
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_GS_TABLE  text
*      -->p_linha   text
*      -->p_coluna  text
*      <--P_GS_CELL  text
*----------------------------------------------------------------------*
FORM z_define_coord_cell  USING    p_gs_table
                                   VALUE(p_linha)
                                   VALUE(p_coluna)
                          CHANGING p_gs_cell.
  CALL METHOD OF p_gs_table 'Cell' = p_gs_cell
    EXPORTING
      #1 = p_linha   " row
      #2 = p_coluna. " column

ENDFORM.                    " z_define_coord_cell
*&---------------------------------------------------------------------*
*&      Form  z_escreve_celula
*&---------------------------------------------------------------------*
* Escreve texto em uma Celula
*----------------------------------------------------------------------*
*      -->P_GS_RANGE  text
*      -->p_text   text
*----------------------------------------------------------------------*
FORM z_escreve_celula  USING    p_gs_range
                                VALUE(p_text).
  SET PROPERTY OF p_gs_range 'Text' = p_text .
ENDFORM.                    " z_escreve_celula
*&---------------------------------------------------------------------*
*&      Form  z_escreve_tabela
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_linha        text
*      -->P_coluna       text
*      -->P_largura      text
*      -->P_autoajuste   text
*      -->P_alignment    text
*      -->P_font         text
*      -->P_size         text
*      -->P_bold         text
*      -->P_italic       text
*      -->P_underline    text
*      -->P_text         text
*----------------------------------------------------------------------*
FORM z_escreve_tabela  USING    VALUE(p_linha)
                                VALUE(p_coluna)
                                VALUE(p_largura)
                                VALUE(p_autoajuste)
                                VALUE(p_alignment)
                                VALUE(p_font)
                                VALUE(p_size)
                                VALUE(p_bold)
                                VALUE(p_italic)
                                VALUE(p_underline)
                                VALUE(p_fcolor)
                                VALUE(p_bgcolor)
                                VALUE(p_text).





*tables.cell
* Define coordenadas das celulas
  PERFORM z_define_coord_cell USING gs_table
                                    p_linha    "Linha
                                    p_coluna    "Coluna
                              CHANGING gs_cell.

* Define Cor BackGround da Celula.
  IF NOT p_bgcolor IS INITIAL.
    PERFORM z_define_bgcolor USING gs_cell
                                   p_bgcolor.
  ENDIF.


  IF NOT p_largura IS INITIAL.
*   Ajusta Largura das Celulas
    PERFORM z_ajusta_largura_cell USING    gs_cell  "Obj Celula
                                           p_largura      "Largura
                                           p_autoajuste   "AutoAjuste(1)
                                  CHANGING gs_table_width.
  ENDIF.

* Define alinhamento vertical da celula
  SET PROPERTY OF gs_cell 'VerticalAlignment' = 1.

* Seleciona posição da celula
*tables.cell.range
  GET PROPERTY OF gs_cell 'Range' = gs_range.


*  GET PROPERTY OF gs_table 'Selection' = gs_selection .
  GET PROPERTY OF gs_range 'ParagraphFormat' = gs_parformat .

* Ajusta o Formato do paragrafo
  SET PROPERTY OF gs_parformat 'Alignment' =  p_alignment.

  PERFORM z_define_font USING    gs_range
                                 p_font        "Name
                                 p_size        "Size
                                 p_bold        "Bold(1) NotBold(0)
                                 p_italic      "Italic
                                 p_underline  "Underline
                                 p_fcolor.      "Font Color




* Preenche a celula
  IF NOT p_text IS INITIAL.
    PERFORM z_escreve_celula USING   gs_range "Obj
                                     p_text.  "Texto
  ENDIF.

ENDFORM.                    " z_escreve_tabela
*&---------------------------------------------------------------------*
*&      Form  z_avanca_fim_tabela
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_avanca_fim_tabela .
* Avança o cursor para o fim da tabela
  GET PROPERTY OF gs_table 'Range' = gs_range .
  GET PROPERTY OF gs_range 'End'   = gv_pos .
  SET PROPERTY OF gs_range 'Start' = gv_pos .
  CALL METHOD OF gs_range 'Select' .
ENDFORM.                    " z_avanca_fim_tabela
*&---------------------------------------------------------------------*
*&      Form  z_cria_documento
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_cria_documento .

* Criando Variavel do manipulador do Objeto OLE
  CREATE OBJECT gs_word 'WORD.Application' .
  IF sy-subrc NE 0 .
    MESSAGE s000(su) WITH 'Erro ao criar objeto OLE!'.
    LEAVE PROGRAM .
  ENDIF.
* Torna Objeto visivel
  SET PROPERTY OF gs_word 'Visible' = '1' .
* Abre novo Documento
  GET PROPERTY OF gs_word 'Documents' = gs_documents .
  CALL METHOD OF gs_documents 'Add' .
* Busca manipulador  do documento ativo
  GET PROPERTY OF gs_word 'ActiveDocument' = gs_actdoc .
* Busca manipulador da Aplicação
  GET PROPERTY OF gs_actdoc 'Application' = gs_application .
* Define a unidade de medida para ‘CM’
  GET PROPERTY OF gs_application 'Options' = gs_options .
  SET PROPERTY OF gs_options 'MeasurementUnit' = '1' . "CM
* Busca manipulador para a seleção do caractere na posição do cursor
  GET PROPERTY OF gs_application 'Selection' = gs_selection .

  GET PROPERTY OF gs_selection 'Font' = gs_font .
  GET PROPERTY OF gs_selection 'ParagraphFormat' = gs_parformat .
* Formata Página
  GET PROPERTY OF gs_selection 'PageSetup'       = gs_pagesetup.
  SET PROPERTY OF gs_pagesetup 'PaperSize'       = '7'.  "A4
  SET PROPERTY OF gs_pagesetup 'TopMargin'       = '1,27'.
  SET PROPERTY OF gs_pagesetup 'BottomMargin'    = '1,27'.
  SET PROPERTY OF gs_pagesetup 'LeftMargin'      = '3'.
  SET PROPERTY OF gs_pagesetup 'RightMargin'     = '1,27'.
* Busca manipulador para Entidades a serem criadas
  GET PROPERTY OF gs_actdoc    'Tables'       = gs_tables .
  GET PROPERTY OF gs_selection 'Range'        = gs_range .
  GET PROPERTY OF gs_actdoc    'ActiveWindow' = gs_actwin.
  GET PROPERTY OF gs_actwin    'View'         = gs_view .
  GET PROPERTY OF gs_actwin    'ActivePane'   = gs_actpan .

* Insere Cabecalho no documento
  PERFORM z_insere_cabecalho.
* Insere Rodape no Documento
  PERFORM z_insere_rodape.

ENDFORM.                    " z_cria_documento
*&---------------------------------------------------------------------*
*&      Form  z_libera_objeto
*&---------------------------------------------------------------------*
*       Libera Objeto
*----------------------------------------------------------------------*
FORM z_libera_objeto .
  FREE OBJECT gs_word .

ENDFORM.                    " z_libera_objeto
*&---------------------------------------------------------------------*
*&      Form  z_abre_cabecalho
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_abre_cabecalho.

  GET PROPERTY OF gs_actpan    'View'         = gs_view .
  SET PROPERTY OF gs_view      'SeekView'     = '9'.

ENDFORM.                    " z_abre_cabecalho
*&---------------------------------------------------------------------*
*&      Form z_exibe_main_doc
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_exibe_main_doc.
  GET PROPERTY OF gs_actpan    'View'         = gs_view .
  SET PROPERTY OF gs_view      'SeekView'     = '0'.
ENDFORM.                    " z_exibe_main_doc
*&---------------------------------------------------------------------*
*&      Form  z_insere_cabecalho
*&---------------------------------------------------------------------*
*       Insere Cabeçaho do Documento
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_insere_cabecalho.
  PERFORM z_abre_cabecalho.

  GET PROPERTY OF gs_selection 'Range' = gs_range .

*  PERFORM z_cria_tabela USING     gs_tables
*                                  gs_range
*                                 '1'  "Linhas
*                                 '2'  "Colunas
*                        CHANGING gs_table.
** Pula uma linha
**  PERFORM z_new_line.
  PERFORM insere_logo USING    p_logo.

*  PERFORM z_escreve_tabela USING  '1'      "Linha
*                                  '1'      "Coluna
*                                  '8.5'    "Largura
*                                  '0'      "Autoajuste
*                                  '1'      "Center-justified
*                                  'Calibri'  "Font
*                                  '14'     "Size
*                                  '0'      "Bold
*                                  '0'      "Italic
*                                  '0'      "Underline
*                                  ''       "Font Color
*                                  ''      "BgColor
*                                  ''.


*  PERFORM z_escreve_tabela USING  '1'      "Linha
*                                  '2'      "Coluna
*                                  '0.4'    "Largura
*                                  '1'      "Autoajuste
*                                  '1'      "Center-justified
*                                  'Calibri'  "Font
*                                  '10'     "Size
*                                  '0'      "Bold
*                                  '0'      "Italic
*                                  '0'      "Underline
*                                  ''       "Font Color
*                                  '255'    "BgColor Red
*                                  ' '.

*
*  PERFORM z_escreve_tabela USING  '1'         "Linha
*                                  '2'         "Coluna
*                                  '8'         "Largura
*                                  '1'         "Autoajuste
*                                  '1'         "Center-justified
*                                  'Calibri'   "Font
*                                  '14'        "Size
*                                  '1'         "Bold
*                                  '0'         "Italic
*                                  '0'         "Underline
*                                  ''          "Font Color
*                                  wdcolorblue "BgColor -> Black = '0'
*                                  'Especificação Técnica'.

** Pula uma linha
*  PERFORM z_new_line.
  PERFORM z_exibe_main_doc.

ENDFORM.                    " z_insere_cabecalho
*&---------------------------------------------------------------------*
*&      Form  z_abre_rodape
*&---------------------------------------------------------------------*
*       Abre Rodape do Documento  para edição
*----------------------------------------------------------------------*
FORM z_abre_rodape.

  GET PROPERTY OF gs_actpan    'View'         = gs_view .
  SET PROPERTY OF gs_view      'SeekView'     = '10'.

ENDFORM.                    " z_abre_rodape
*&---------------------------------------------------------------------*
*&      Form  z_insere_rodape
*&---------------------------------------------------------------------*
*       Insere rodape do Documento
*----------------------------------------------------------------------*
FORM z_insere_rodape.
  PERFORM z_abre_rodape.
  GET PROPERTY OF gs_selection 'Range' = gs_range .

  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '2'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              ''   "Enable all
                              '1'    "'top'
                              '1'    "'left'
                              '1'    "'botton'
                              '1'    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_insere_campo  USING gs_selection
                                gs_range
                                'FILENAME  \p '.

  PERFORM z_escreve_tabela USING  '1'      "Linha
                                  '1'      "Coluna
                                  '8.5'      "Largura
                                  '0'      "Autoajuste
                                  '0'      "Left-justified
                                  'Calibri'  "Font
                                  '9'      "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ' '      "BgColor
                                  ''.


  PERFORM z_escreve_tabela USING  '1'      "Linha
                                  '2'      "Coluna
                                  '0.4'    "Largura
                                  '1'      "Autoajuste
                                  '1'      "Center-justified
                                  'Calibri'  "Font
                                  '10'     "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ''       "BgColor
                                  ''.

  PERFORM z_cell_move_right.
  PERFORM z_cell_move_right.

  GET PROPERTY OF gs_selection 'Range' = gs_range .

  CALL METHOD OF gs_selection 'TypeText'
    EXPORTING
      #1 = 'Página:'.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_insere_campo  USING gs_selection
                              gs_range
                              'Page'.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  CALL METHOD OF gs_selection 'TypeText'
    EXPORTING
      #1 = ' Data: '.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_insere_campo  USING gs_selection
                                gs_range
                                'DATE'.

  PERFORM z_escreve_tabela USING  '1'      "Linha
                                  '3'      "Coluna
                                  '8'      "Largura
                                  '1'      "Autoajuste
                                  '2'      "Right-justified
                                  'Calibri'  "Font
                                  '10'     "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ''       "BgColor
                                  ''.



  PERFORM z_escreve_tabela USING  '2'      "Linha
                                  '1'      "Coluna
                                  '8.5'      "Largura
                                  '0'      "Autoajuste
                                  '0'      "Left-justified
                                  'Calibri'  "Font
                                  '9'      "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ' '      "BgColor
                                  ''.


  PERFORM z_escreve_tabela USING  '2'      "Linha
                                  '2'      "Coluna
                                  '0.4'    "Largura
                                  '1'      "Autoajuste
                                  '1'      "Center-justified
                                  'Calibri'  "Font
                                  '10'     "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ''       "BgColor
                                  ''.

  PERFORM z_escreve_tabela USING  '2'      "Linha
                                  '3'      "Coluna
                                  '8'      "Largura
                                  '1'      "Autoajuste
                                  '2'      "Right-justified
                                  'Calibri'  "Font
                                  '9'      "Size
                                  '0'      "Bold
                                  '0'      "Italic
                                  '0'      "Underline
                                  ''       "Font Color
                                  ''       "BgColor
                   'Arcelomittal Longos - EWM'.

  PERFORM z_exibe_main_doc.

ENDFORM.                    " z_insere_rodape

*&---------------------------------------------------------------------*
*&      Form  z_define_bgcolor
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_P_BGCOLOR  text
*----------------------------------------------------------------------*
FORM z_define_bgcolor USING   p_gs
                              p_p_bgcolor.


  GET PROPERTY OF p_gs 'Shading' = gs_shading .
* 255 Red
  SET PROPERTY OF gs_shading 'BackgroundPatternColor' = p_p_bgcolor.

ENDFORM.                    " z_define_bgcolor

*---------------------------------------------------------------------*
*       FORM z_salva_documento                                        *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_FILENAME)                                             *
*---------------------------------------------------------------------*
FORM z_salva_documento  USING VALUE(p_filename).
  IF p_filename IS INITIAL OR
     p_filename = c_file.
    CONCATENATE c_file programa '.doc' INTO p_filename.
  ENDIF.

*  CALL METHOD OF gs_actdoc 'SaveAs' "= gs_actdoc_saveas
  CALL METHOD OF gs_actdoc 'Save' "= gs_actdoc_saveas
    EXPORTING
      #1 = p_filename.
ENDFORM.                    " z_salva_documento
*&---------------------------------------------------------------------*
*&      Form  z_close_application
*&---------------------------------------------------------------------*
*       Fecha Aplicação
*----------------------------------------------------------------------*
FORM z_close_application.

  CALL METHOD OF gs_word 'QUIT'.

* Libera objeto da memoria para desalocar memoria
  PERFORM z_libera_objeto.

ENDFORM.                    " z_close_application

*---------------------------------------------------------------------*
*       FORM z_insere_campo                                           *
*---------------------------------------------------------------------*
*       Insere variaevel de sistema (Data,Paginas...)                 *
*---------------------------------------------------------------------*
*  -->  P_GS_SELECTION                                                *
*  -->  P_GS_RANGE                                                    *
*  -->  VALUE(P_CAMPO)                                                *
*---------------------------------------------------------------------*
FORM z_insere_campo USING   p_gs_selection
                            p_gs_range
                            VALUE(p_campo).
  GET PROPERTY OF p_gs_selection 'Fields' = gs_fields.

  CALL METHOD OF gs_fields 'Add'
    EXPORTING
      #1 = p_gs_range "Handle for range entity
      #2 = '-1'       "type
      #3 = p_campo    "Campo e formatação
      #4 = 'True'.    "Preserve Formating
ENDFORM.                    " z_insere_campo
*&---------------------------------------------------------------------*
*&      Form  z_cell_move_right
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_cell_move_right.
* Selection.MoveRight Unit:=wdCell
  CALL METHOD OF gs_selection 'MoveRight'
    EXPORTING
      #1 = 12. "Unit:=wdCell
ENDFORM.                    " z_cell_move_right
*&---------------------------------------------------------------------*
*&      Form  z_move_down
*&---------------------------------------------------------------------*
*       Move para linha de baixo Count posições
*----------------------------------------------------------------------*
*      -->P_GS      text
*      -->P_COUNT   text
*----------------------------------------------------------------------*
FORM z_move_down USING    p_gs
                          VALUE(p_count).
*    Selection.MoveDown Unit:=wdLine, Count:=1
  CALL METHOD OF p_gs 'MoveDown'
    EXPORTING
      #1 = '5'      "wdLine
      #2 = p_count.  "Count


ENDFORM.                    " z_move_down
*&---------------------------------------------------------------------*
*       Move para linha de baixo Count posições
*----------------------------------------------------------------------*
*      -->P_GS      text
*      -->P_COUNT   text
*----------------------------------------------------------------------*
FORM z_move_right_cell USING    p_gs
                          VALUE(p_count).
*    Selection.MoveRight Unit:=wdCharacter, Count:=1
*    Selection.EndKey Unit:=wdLine
*    Selection.TypeParagraph
*  CALL METHOD OF p_gs 'MoveRight'
*  EXPORTING
*  #1 = '1'      "wdCharacter
*  #2 = p_count  "Count
*  #3 = '1'.     "wdExtend

  CALL METHOD OF p_gs 'EndKey'
    EXPORTING
      #1 = '5'.      "wdLine

  CALL METHOD OF p_gs 'MoveRight'
    EXPORTING
      #1 = '1'      "wdCharacter
      #2 = p_count.  "Count

  CALL METHOD OF p_gs 'EndKey'
    EXPORTING
      #1 = '5'.      "wdLine

ENDFORM.                    " z_move_Right_cell

*&---------------------------------------------------------------------*
*&      Form z_move_right
*&---------------------------------------------------------------------*
*       Move para linha de baixo Count posições
*----------------------------------------------------------------------*
*      -->P_GS      text
*      -->P_COUNT   text
*----------------------------------------------------------------------*
FORM z_move_right USING    p_gs
                          VALUE(p_count).
*    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
  CALL METHOD OF p_gs 'MoveRight'
    EXPORTING
      #1 = '1'      "wdCharacter
      #2 = p_count  "Count
      #3 = '1'.     "wdExtend


ENDFORM.                    " z_move_right
*&---------------------------------------------------------------------*
*       Move para linha de baixo Count posições
*----------------------------------------------------------------------*
*      -->P_GS      text
*      -->P_COUNT   text
*----------------------------------------------------------------------*
FORM z_move_end USING    p_gs
                          VALUE(p_count).
*Selection.EndKey Unit:=wdLine, Count:=1, Extend:=wdExtend
  CALL METHOD OF p_gs 'EndKey'
    EXPORTING
      #1 = '5'      "wdLine
      #2 = p_count  "Count
      #3 = '1'.     "wdExtend


ENDFORM.                    " z_move_right

*---------------------------------------------------------------------*
*       FORM z_info_geral                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TITULO)                                               *
*  -->  VALUE(P_COD_PROG)                                             *
*  -->  VALUE(P_TRANS)                                                *
*  -->  VALUE(P_MODULO)                                               *
*  -->  VALUE(P_DATA)                                                 *
*  -->  VALUE(P_CLIENTE)                                              *
*  -->  VALUE(P_RESP_PROC)                                            *
*  -->  VALUE(P_RESP_FUNC)                                            *
*  -->  VALUE(P_RESP_TEC)                                             *
*  -->  VALUE(P_COMPLEX)                                              *
*---------------------------------------------------------------------*
FORM z_info_geral USING    VALUE(p_titulo)
                           VALUE(p_cod_prog)
                           VALUE(p_trans)
                           VALUE(p_modulo)
                           VALUE(p_data)
                           VALUE(p_cliente)
                           VALUE(p_resp_proc)
                           VALUE(p_resp_func)
                           VALUE(p_resp_tec)
                           VALUE(p_complex).

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
                                'Informações Gerais'.           "Texto


* Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '10'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Título'.

  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Código do Programa'.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Transação'.
  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Módulo/Área Funcional'.
  PERFORM z_escreve_tabela USING  '5'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Data de Criação'.
  PERFORM z_escreve_tabela USING  '6'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Cliente/Projeto'.
  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Responsável Processo'.
  PERFORM z_escreve_tabela USING  '8'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Responsável Funcional'.
  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Responsável Técnico'.
  PERFORM z_escreve_tabela USING  '10'                    "Linha
                                  '1'                     "Coluna
                                  '6'                     "Largura
                                  '1'                     "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Complexidade'.




  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_titulo.

  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_cod_prog.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans.
  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_modulo.
  PERFORM z_escreve_tabela USING  '5'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_data.
  PERFORM z_escreve_tabela USING  '6'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_cliente.
  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_resp_proc.
  PERFORM z_escreve_tabela USING  '8'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_resp_func.
  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_resp_tec.
  PERFORM z_escreve_tabela USING  '10'                    "Linha
                                  '2'                     "Coluna
                                  '11'                     "Largura
                                  '1'                     "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_complex.


  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_info_geral

*---------------------------------------------------------------------*
*       FORM z_set_border                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  P_GS                                                          *
*  -->  VALUE(P_ALL)                                                  *
*  -->  VALUE(P_TOP)                                                  *
*  -->  VALUE(P_LEFT)                                                 *
*  -->  VALUE(P_BOTTON)                                               *
*  -->  VALUE(P_RIGHT)                                                *
*  -->  VALUE(P_HORIZ)                                                *
*  -->  VALUE(P_VERT)                                                 *
*---------------------------------------------------------------------*
FORM z_set_border USING    p_gs
                           VALUE(p_all)
                           VALUE(p_top)
                           VALUE(p_left)
                           VALUE(p_botton)
                           VALUE(p_right)
                           VALUE(p_horiz)
                           VALUE(p_vert).

  IF NOT p_all IS INITIAL.
    GET PROPERTY OF p_gs 'Borders' = gs_borders.
    SET PROPERTY OF gs_borders 'Enable' = '1' . "With border
  ENDIF.

  IF NOT p_top IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '1'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_top."1
    FREE OBJECT gs_borders.
  ENDIF.
  IF NOT p_left IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '2'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_left.
    FREE OBJECT gs_borders.
  ENDIF.
  IF NOT p_botton IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '3'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_botton.
    FREE OBJECT gs_borders.
  ENDIF.
  IF NOT p_right IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '4'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_right.
    FREE OBJECT gs_borders.
  ENDIF.
  IF NOT p_horiz IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '5'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_horiz.
    FREE OBJECT gs_borders.
  ENDIF.
  IF NOT p_vert IS INITIAL.
    CALL METHOD OF p_gs 'BORDERS' = gs_borders
      EXPORTING
      #1 = '6'.
    SET PROPERTY OF gs_borders 'LineStyle' = p_vert.
    FREE OBJECT gs_borders.
  ENDIF.


ENDFORM.                    " z_set_border
*&---------------------------------------------------------------------*
*&      Form  z_hist_mod_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_hist_mod_header.
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'
               'Histórico das Modificações'.  "Texto
* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '0'                "Bold
                                '1'                "Italic
                                '0'                "Underline
                                wdcolorgray50       "Font Color
                                ''      "BGColor
                                ''                "Indice
'(Todas as melhorias e correções efetuadas nesta documentação deverão ser informadas, preenchendo o quadro abaixo)'.  "Texto

* Pula uma linha
  PERFORM z_new_line.


  GET PROPERTY OF gs_selection 'Range' = gs_range .

  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Data'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '9'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
         'Descrição (Objetivo da alteração)'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Solicitado por'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Change Request'.


  PERFORM z_avanca_fim_tabela .



ENDFORM.                    " z_hist_mod_header

*---------------------------------------------------------------------*
*       FORM z_hist_mod_items                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_DATA)                                                 *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_SOLIC)                                                *
*  -->  VALUE(P_REQUEST)                                              *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_hist_mod_items USING    VALUE(p_data)
                               VALUE(p_desc)
                               VALUE(p_solic)
                               VALUE(p_request)
                               VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_data.

  PERFORM z_escreve_tabela USING   p_count               "Linha
                                  '2'                    "Coluna
                                  '9'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_solic.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_request.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_hist_mod_items

*&---------------------------------------------------------------------*
*&      Form  z_page_break
*&---------------------------------------------------------------------*
*       Insere quebra de página
*----------------------------------------------------------------------*
*      -->P_GS_SELECTION  text
*----------------------------------------------------------------------*
FORM z_page_break USING    p_gs.

* Selection.InsertBreak Type:=wdPageBreak
  CALL METHOD OF p_gs 'InsertBreak'
    EXPORTING
      #1 = 2.  "Type

ENDFORM.                    " z_page_break
*&---------------------------------------------------------------------*
*&      Form  z_hist_mod_obs
*&---------------------------------------------------------------------*
*       Insere Observações do Historico de modificações
*----------------------------------------------------------------------*
FORM z_hist_mod_obs.

  PERFORM z_escreve_texto USING 'Calibri'             "Font
                                '8'                 "Size
                                '0'                 "Bold
                                '1'                 "Italic
                                '0'                 "Underline
                                wdcolorgray50       "Font Color
                                ''                  "BGColor
                                ''                  "Indice
'1. O Campo Descrição deverá conter uma descrição sucinta da atualização, o detalhamento deverá estar no corpo da especificação'.

  PERFORM z_escreve_texto USING 'Calibri'             "Font
                                '8'                 "Size
                                '0'                 "Bold
                                '1'                 "Italic
                                '0'                 "Underline
                                wdcolorgray50       "Font Color
                                ''                  "BGColor
                                ''                  "Indice
'2. As alterações/exclusões devem ser identificadas com a utilização do word (ferramentas/controlar alterações)'.

  PERFORM z_escreve_texto USING 'Calibri'             "Font
                                '8'                 "Size
                                '0'                 "Bold
                                '1'                 "Italic
                                '0'                 "Underline
                                wdcolorgray50       "Font Color
                                ''                  "BGColor
                                ''                  "Indice
'3. Apenas a última alteração deve ser destacada.A anterior deve ser incorporada. (ferramentas/controlar alterações/aceitar ou rejeitar alterações)'.

  PERFORM z_escreve_texto USING 'Calibri'             "Font
                                '8'                 "Size
                                '0'                 "Bold
                                '1'                 "Italic
                                '0'                 "Underline
                                wdcolorgray50       "Font Color
                                ''                  "BGColor
                                ''                  "Indice
'4. Quando não existir informação para determiado tópico, não exclui-lo da documentação, informar com n/a.'.

* Pula uma linha
  PERFORM z_new_line.

ENDFORM.                    " z_hist_mod_obs
*&---------------------------------------------------------------------*
*&      Form  z_pag_conteudo
*&---------------------------------------------------------------------*
*       Insere a pagina de Conteúdo
*----------------------------------------------------------------------*
FORM z_pag_conteudo.
  PERFORM z_page_break USING gs_selection.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
                                'Conteúdo'.  "Texto
* Pula uma linha
  PERFORM z_new_line.


ENDFORM.                    " z_pag_conteudo
*&---------------------------------------------------------------------*
*&      Form  z_pag_fluxo
*&---------------------------------------------------------------------*
*       Insere a pagina do Fluxo
*----------------------------------------------------------------------*
FORM z_pag_fluxo.
  PERFORM z_page_break USING gs_selection.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
               'Fluxo do Processo'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'         "Font
                              '10'              "Size
                              '0'               "Bold
                              '1'               "Italic
                              '0'               "Underline
                              wdcolorgray50     "Font Color
                              ''                "BGColor
                              ''                "Indice
'(Demonstrar graficamente o fluxo do proceso e, se possivel destacando o ponto onde este desenvolvimento se encaixa)'.  "Texto
* Pula uma linha
  PERFORM z_new_line.

ENDFORM.                    " z_pag_fluxo
*&---------------------------------------------------------------------*
*&      Form  z_pag_proc_neg
*&---------------------------------------------------------------------*
*       Insere a pagina do Fluxo
*----------------------------------------------------------------------*
FORM z_pag_proc_neg.
  PERFORM z_page_break USING gs_selection.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
               'Descrição do Processo de Negócio'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50       "Font Color
                              ''      "BGColor
                              ''                "Indice
'(Descrever sucintamente o processo onde o programa está inserido)'.
  "Texto

  DO 6 TIMES.
*   Pula uma linha
    PERFORM z_new_line.
  ENDDO.

ENDFORM.                    " z_pag_proc_neg

*---------------------------------------------------------------------*
*       FORM z_consid_oper                                            *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_PT)                                                   *
*  -->  VALUE(P_EN)                                                   *
*  -->  VALUE(P_TRANS)                                                *
*  -->  VALUE(P_TP_PROC)                                              *
*  -->  VALUE(P_FREQ)                                                 *
*  -->  VALUE(P_PACK)                                                 *
*  -->  VALUE(P_DEPEN)                                                *
*  -->  VALUE(P_VARI)                                                 *
*  -->  VALUE(P_JOBNAME)                                              *
*  -->  VALUE(P_PASTA)                                                *
*---------------------------------------------------------------------*
FORM z_consid_oper USING    VALUE(p_pt)
                            VALUE(p_en)
                            VALUE(p_trans)
                            VALUE(p_tp_proc)
                            VALUE(p_freq)
                            VALUE(p_pack)
                            VALUE(p_depen)
                            VALUE(p_vari)
                            VALUE(p_jobname)
                            VALUE(p_pasta).

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
 'Considerações Operacionais'.  "Texto

*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '10'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Menu - Português'.

  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Menu - Inglês'.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Transação Stardard'.
  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                       'Tipo de Processamento (on-line/background)'.
  PERFORM z_escreve_tabela USING  '5'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Frequência'.
  PERFORM z_escreve_tabela USING  '6'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Pacote'.
  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Dependências'.
  PERFORM z_escreve_tabela USING  '8'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Variantes'.
  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nome do JOB'.
  PERFORM z_escreve_tabela USING  '10'                    "Linha
                                  '1'                     "Coluna
                                  '6'                     "Largura
                                  '1'                     "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nome da Pasta Batch(SM35)'.


****
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pt.

  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_en.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans.
  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                   p_tp_proc.
  PERFORM z_escreve_tabela USING  '5'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_freq.
  PERFORM z_escreve_tabela USING  '6'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pack.
  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_depen.
  PERFORM z_escreve_tabela USING  '8'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_vari.
  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '2'                    "Coluna
                                  '11'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_jobname.
  PERFORM z_escreve_tabela USING  '10'                    "Linha
                                  '2'                     "Coluna
                                  '11'                     "Largura
                                  '1'                     "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pasta.

  PERFORM z_avanca_fim_tabela .

ENDFORM.                    " z_consid_oper
*&---------------------------------------------------------------------*
*&      Form  z_pag_espec
*&---------------------------------------------------------------------*
*       Insere Pargina Especificação
*----------------------------------------------------------------------*
FORM z_pag_espec.
  PERFORM z_page_break USING gs_selection.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
               'Especificação'.  "Texto

*   Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
                       '1.  Objetivo do Programa'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
                              v_objetivo.        "Texto
*   Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
     '2.  Diagrama do Fluxo Técnico'.  "Texto
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                 "Indice
'(Desenhar quais os objetivos que estão envolvidos no programa. Ex.: arquivo de entrada, saida, relatórios e etc., inclusive o relacionamento entre as tabelas)'.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
     '3.  Premissas / Restrições / Observações'. "Texto

* Pula uma linha
  PERFORM z_new_line.


ENDFORM.                    " z_pag_espec
*&---------------------------------------------------------------------*
*&      Form  z_tab_transp_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_tab_transp_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '4.  Tabelas transparentes Envolvidas / Criadas'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Relacionar as principais tabelas acessadas ou criadas para o processamento do programa)'.

*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tabela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '7'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Descrição'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '4.9'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Especificação'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_tab_transp_header

*---------------------------------------------------------------------*
*       FORM z_tab_transp_items                                       *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TABELA)                                               *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_ESPEC)                                                *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_tab_transp_items USING  VALUE(p_tabela)
                               VALUE(p_desc)
                               VALUE(p_espec)
                               VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tabela.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '2'                    "Coluna
                                  '7'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '4.9'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_espec.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_tab_transp_items
*&---------------------------------------------------------------------*
*&      Form  z_incl_tab_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_incl_tab_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '5.  Includes / Appends em Tabelas'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Relacionar  os includes / appends das tabelas)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Seq'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Include'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tabela'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_incl_tab_header

*---------------------------------------------------------------------*
*       FORM z_incl_tab_items                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_SEQ)                                                  *
*  -->  VALUE(P_INCLUDE)                                              *
*  -->  VALUE(P_TABELA)                                               *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_incl_tab_items USING  VALUE(p_seq)
                             VALUE(p_include)
                             VALUE(p_tabela)
                             VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_seq.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '2'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_include.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tabela.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_incl_tab_items
*&---------------------------------------------------------------------*
*&      Form  z_campos_tab_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_campos_tab_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '5.1.  Campos da Tabela / Append'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(User Exit/BADI/Tabelas)(Relacionar  os campos a serem criados)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Chave (X)'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Elem Dados'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tipo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tam'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '6'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Descrição'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '7'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Observação'.

  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_campos_tab_header

*---------------------------------------------------------------------*
*       FORM z_campos_tab_items                                       *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_CHAVE)                                                *
*  -->  VALUE(P_ELEM)                                                 *
*  -->  VALUE(P_TIPO)                                                 *
*  -->  VALUE(P_TAM)                                                  *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_campos_tab_items USING  VALUE(p_campo)
                               VALUE(p_chave)
                               VALUE(p_elem)
                               VALUE(p_tipo)
                               VALUE(p_tam)
                               VALUE(p_desc)
                               VALUE(p_obs)
                               VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '1'                    "Coluna
                                  '2.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '2'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_chave.

  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_elem.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '4'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tipo.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '5'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tam.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '6'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.
  PERFORM z_escreve_tabela USING  p_count                    "Linha
                                  '7'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_campos_tab_items
*&---------------------------------------------------------------------*
*&      Form  z_trans_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_trans_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '6.  Transações SAP'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(User Exit/BADI)(Informar as transações SAP afetadas)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Transação'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Descrição'.

  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_trans_header

*---------------------------------------------------------------------*
*       FORM z_trans_items                                            *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TRANS)                                                *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_trans_items USING       VALUE(p_trans)
                               VALUE(p_desc)
                               VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_trans_items
*&---------------------------------------------------------------------*
*&      Form  z_arq_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_arq_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '7.  Arquivos de Interface'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(User Exit/BADI)(Informar o nome e campos do arquivo de transferência dos dados)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nome do Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Posição'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tamanho'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Descrição'.

  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_arq_header

*---------------------------------------------------------------------*
*       FORM z_arq_items                                              *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_FILENAME)                                             *
*  -->  VALUE(P_NOME)                                                 *
*  -->  VALUE(P_POS)                                                  *
*  -->  VALUE(P_TAM)                                                  *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_arq_items USING     VALUE(p_filename)
                           VALUE(p_nome)
                           VALUE(p_pos)
                           VALUE(p_tam)
                           VALUE(p_desc)
                           VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_nome.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pos.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size

       '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tam.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_arq_items
*&---------------------------------------------------------------------*
*&      Form  z_param_imp_func_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_param_imp_func_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '8.  Parâmetros para Função'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                               ''                "Indice
'(Função)'.
*   Pula uma linha
  PERFORM z_new_line.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '8.1.  Parâmetros de Importação'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Mencionar os campos que serão utilizados como dados de entrada para a função)'.
*   Pula uma linha
  PERFORM z_new_line.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Formato'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '10'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Observação'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_param_imp_func_header


*---------------------------------------------------------------------*
*       FORM z_param_imp_func_items                                   *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_FORMATO)                                              *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_param_imp_func_items USING  VALUE(p_campo)
                                   VALUE(p_formato)
                                   VALUE(p_obs)
                                   VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_formato.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '10'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_param_imp_func_items
*&---------------------------------------------------------------------*
*&      Form  z_param_exp_func_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_param_exp_func_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '8.2.  Parâmetros de Exportação'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Mencionar os campos que serão utilizados como dados  de  saída  para a função)'.
*   Pula uma linha
  PERFORM z_new_line.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Formato'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '10'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Observação'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_param_exp_func_header


*---------------------------------------------------------------------*
*       FORM z_param_exp_func_items                                   *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_FORMATO)                                              *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_param_exp_func_items USING  VALUE(p_campo)
                                   VALUE(p_formato)
                                   VALUE(p_obs)
                                   VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_formato.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '10'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_param_exp_func_items

*&---------------------------------------------------------------------*
*&      Form  z_param_tab_func_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_param_tab_func_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '8.3.  Parâmetros da Tabela'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                 "Indice
'(Relacionar as tabelas que serão utilizadas como dados de entrada e saida da função)'.
*   Pula uma linha
  PERFORM z_new_line.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tabela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Estrutura'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tipo de Referência'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Observação'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_param_tab_func_header



*---------------------------------------------------------------------*
*       FORM z_param_tab_func_items                                   *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TABELA)                                               *
*  -->  VALUE(P_ESTRUTURA)                                            *
*  -->  VALUE(P_TP_REF)                                               *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_param_tab_func_items USING  VALUE(p_tabela)
                               VALUE(p_estrutura)
                               VALUE(p_tp_ref)
                               VALUE(p_obs)
                               VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '4'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tabela.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_estrutura.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tp_ref.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_param_tab_func_items
*&---------------------------------------------------------------------*
*&      Form  z_func_excecoes_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_func_excecoes_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                               '1'                "Indice
  '8.4.  Exceções'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                               ''                "Indice
'(Cite as excecões da função)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Conteúdo'.

  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_trans_header

*---------------------------------------------------------------------*
*       FORM z_func_excecoes_items                                    *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_CONTEUDO)                                             *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_func_excecoes_items USING     VALUE(p_campo)
                                     VALUE(p_conteudo)
                                     VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_conteudo.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_func_excecoes_items
*&---------------------------------------------------------------------*
*&      Form  z_tela_selecao
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_tela_selecao.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '9.  Tela de Seleção'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Parâmetros)'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '9.1.  Layout'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Independente da ferramenta utilizada, inserir neste ponto do documento o modelo de tela a ser desenvolvida)'.

* Pula uma linha
  PERFORM z_new_line.
ENDFORM.                    " z_tela_selecao

*&---------------------------------------------------------------------*
*&      Form  z_param_selec_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM z_param_selec_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '9.2.  Parâmetros de Seleção'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Relacionar os parâmetros de tela de seleção a serem utilizados neste programa)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '6'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nome'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tipo do Parâmetro'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Texto da Tela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tipo de campo / Referência'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Valor Inicial'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '6'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Consistência / Observação'.

  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_param_selec_header


*---------------------------------------------------------------------*
*       FORM z_param_selec_items                                      *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_NOME)                                                 *
*  -->  VALUE(P_TP_PARAM)                                             *
*  -->  VALUE(P_TEXTO)                                                *
*  -->  VALUE(P_TP_CAMPO)                                             *
*  -->  VALUE(P_VALOR)                                                *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_param_selec_items USING     VALUE(p_nome)
                                   VALUE(p_tp_param)
                                   VALUE(p_texto)
                                   VALUE(p_tp_campo)
                                   VALUE(p_valor)
                                   VALUE(p_obs)
                                   VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '6'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_nome.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tp_param.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_texto.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tp_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '5'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_valor.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '6'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.


  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.
ENDFORM.                    " z_param_selec_items
*&---------------------------------------------------------------------*
*&      Form  z_pag_logic_proc
*&---------------------------------------------------------------------*
*       Insere Pargina Especificação
*----------------------------------------------------------------------*
FORM z_pag_logic_proc.
  PERFORM z_page_break USING gs_selection.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorautomatic   "Font Color
                                wdcolorautomatic   "BGColor
                                '1'                "Indice
'19.  Lógica de Processamento'.  "Texto
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Em todos os passos devem-se prever tratamentos de erros que poderão ocorrer.)'.

ENDFORM.                    " z_pag_logic_proc

*---------------------------------------------------------------------*
*       FORM z_acesso_dados                                           *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM z_acesso_dados.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
     '19.1.  Acesso aos Dados'.  "Texto
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                               ''                "Indice
'(Descrever aqui os acessos às tabelas e o relacioanamento entre elas. se possível informar também os índices que deverão ser utilizados nestes acessos. neste mesmo ponto, se for o caso, deve-se informar os arquivos  de entrada.)'.

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'Modelo do Quadro do select'.

ENDFORM.                    " z_acesso_dados


*---------------------------------------------------------------------*
*       FORM z_selec_from                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM z_selec_from .
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tabelas'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  ''.
  PERFORM z_move_right_cell USING gs_selection
                            '1'.
ENDFORM.                    "z_selec_from

*---------------------------------------------------------------------*
*       FORM z_selec_tp_acesso                                        *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TP_ACESSO)                                            *
*---------------------------------------------------------------------*
FORM z_selec_tp_acesso USING    VALUE(p_tp_acesso).

  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                            'Tipo de acesso'.
  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tp_acesso.

*  PERFORM z_move_right_cell USING gs_selection
*                            '1'.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_selec_tp_acesso

*---------------------------------------------------------------------*
*       FORM z_selec_campos                                           *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_CONTEUDO)                                             *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_select_campos.

  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '3'                "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo(s)'.

  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  ''.



  PERFORM z_move_right_cell USING gs_selection
                            '1'.
** Pula uma linha
*  PERFORM z_new_line.
ENDFORM.                    " z_selec_campos
*---------------------------------------------------------------------*
*       FORM z_selec_destino
*
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TABLE)                                                *
*  -->  VALUE(P_TP_ACESSO)                                            *
*---------------------------------------------------------------------*
FORM z_selec_destino USING VALUE(p_destino).

  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Destino'.
  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_destino.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_selec_destino

*---------------------------------------------------------------------*
*       FORM z_selec_join                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_JOIN)                                                 *
*---------------------------------------------------------------------*
FORM z_selec_join USING VALUE(p_join)
                        VALUE(p_count).
  p_count = p_count + 4.
  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                            'INNER JOIN / LEFT OUTER JOIN'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_join.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_selec_join
*---------------------------------------------------------------------*
*       FORM z_selec_cond_join
*
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM z_select_cond_join.

  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '6'                "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Condição do Join'.

  PERFORM z_escreve_tabela USING  '6'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  ''.



  PERFORM z_move_right_cell USING gs_selection
                            '1'.
** Pula uma linha
*  PERFORM z_new_line.
ENDFORM.                    " z_selec_cond_join

*---------------------------------------------------------------------*
*       FORM z_selec_for_all_entries                                  *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TABLE)                                                *
*---------------------------------------------------------------------*
FORM z_selec_for_all_entries USING    VALUE(p_table).
  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                            'FOR ALL ENTRIES'.
  PERFORM z_escreve_tabela USING  '7'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_table.
  PERFORM z_avanca_fim_tabela .

ENDFORM.                    " z_selec_for_all_entries
*&---------------------------------------------------------------------*
*&      Form  z_select_where
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_select_where.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '8'                "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Condições gerais'.

  PERFORM z_escreve_tabela USING  '8'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  ''.



  PERFORM z_move_right_cell USING gs_selection
                            '1'.

ENDFORM.                    " z_select_where

*---------------------------------------------------------------------*
*       FORM z_selec_order_by                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*---------------------------------------------------------------------*
FORM z_selec_order_by USING    VALUE(p_campo).
  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                            'Classificação'.
  PERFORM z_escreve_tabela USING  '9'                    "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_selec_order_by

*---------------------------------------------------------------------*
*       FORM z_selec_group_by                                         *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CAMPO)                                                *
*---------------------------------------------------------------------*
FORM z_selec_group_by USING    VALUE(p_campo).
  PERFORM z_avanca_fim_tabela .

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '10'                   "Linha
                                  '1'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                            'Agrupamento'.
  PERFORM z_escreve_tabela USING  '10'                   "Linha
                                  '2'                    "Coluna
                                  '8'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_avanca_fim_tabela .
ENDFORM.                    " z_selec_group_by

*---------------------------------------------------------------------*
*       FORM z_tratam_dados                                           *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM z_tratam_dados.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorgray50    "Font Color
                              wdcolorautomatic   "BGColor
                               ''                "Indice
     'Tratamento aos dados acessados'.  "Texto
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'Neste ponto é definido o tratamento das informações que foram lídas no passo anterior'.

* Pula uma linha
  PERFORM z_new_line.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '1'                "Underline
                              wdcolorgray50    "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
     'Conclusão'.  "Texto
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                               ''                "Indice
'Aqui será informado o destino dos dados. Este poderá ser via relatório, arquivo texto, e-mail, fax, etc..., sempre atentando ao mapeamento que foi definido.também define-se aqui, para relatórios em tela,'.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'os tratamentos que deverão ser realizados após a exibição do relatório, tais como um segundo nível de detalhamento, ou o envio do relatório para um arquivo texto, etc...'.


ENDFORM.                    " z_tratam_dados
*---------------------------------------------------------------------*
*       FORM z_pag_roteiro_testes                                     *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
FORM z_pag_roteiro_testes.
  PERFORM z_page_break USING gs_selection.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                '1'                "Indice
               'Roteiro para Testes'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50       "Font Color
                              ''      "BGColor
                                ''                "Indice
'(Tópico de preenchimento obrigatório, na sua falta a especificação será devolvida)'.
  "Texto

*   Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                                ''                "Indice
'1.  Informar Client.'. "Texto

  DO 2 TIMES.
*   Pula uma linha
    PERFORM z_new_line.
  ENDDO.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'2. Informar como acessar a massa de testes ou, quando os testes forem simples, informar os procedimentos para geração dessa massa.'. "Texto

  DO 12 TIMES.
*   Pula uma linha
    PERFORM z_new_line.
  ENDDO.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                                '10'               "Size
                                '1'                "Bold
                                '0'                "Italic
                                '0'                "Underline
                                wdcolorwhite       "Font Color
                                wdcolorblue        "BGColor
                                ''                "Indice
               'Resultados Esperados'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50       "Font Color
                              ''      "BGColor
                              ''                "Indice
'(Tópico de preenchimento obrigatório, na sua falta a especificação será devolvida)'.
  "Texto

* Pula uma linha
  PERFORM z_new_line.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'3.  Especificar os resultados esperados.'. "Texto

  DO 12 TIMES.
*   Pula uma linha
    PERFORM z_new_line.
  ENDDO.

  PERFORM z_escreve_texto USING 'Calibri'            "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'4. Se os testes dependerem de outros processos e não for possivel realizar testes durante o desenvolvimento, declarar aqui os motivos'.
  "Texto



ENDFORM.                    " z_pag_roteiro_testes
*&---------------------------------------------------------------------*
*&      Form  z_dados_proj_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_dados_proj_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '10.  Dados de Projeto / Ampliação / Componentes'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(User Exit/BADI)(Mencionar os dados da ampliação utilizada)'.
*   Pula uma linha
  PERFORM z_new_line.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Projeto / Implementação / Programa'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Ampliação /   Definição /        Include'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Componentes /     Métodos /             Form     '.

  PERFORM z_avanca_fim_tabela .

ENDFORM.                    " z_dados_proj_header


*---------------------------------------------------------------------*
*       FORM z_dados_proj_items                                       *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_PROJETO)                                              *
*  -->  VALUE(P_AMPLIACAO)                                            *
*  -->  VALUE(P_COMPON)                                               *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_dados_proj_items USING    VALUE(p_projeto)
                                 VALUE(p_ampliacao)
                                 VALUE(p_compon)
                                 VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_projeto.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_ampliacao.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_compon.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.

ENDFORM.                    " z_dados_proj_items


*---------------------------------------------------------------------*
*       FORM z_prog_form                                              *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_PROG)                                                 *
*  -->  VALUE(P_FORM)                                                 *
*  -->  VALUE(P_TRANS_FORM_PROG)                                      *
*  -->  VALUE(P_TRANS)                                                *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_prog_form USING    VALUE(p_prog)
                          VALUE(p_form)
                          VALUE(p_trans_form_prog)
                          VALUE(p_trans).

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '11.  Programa / Formulário'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
'(Formulário)(Informar os detalhes do formulário e programas utilizados como referência, se forem cópias de standard ou não)'.
*   Pula uma linha
  PERFORM z_new_line.


  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '4'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
            'Programa Standard'.
  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                          'Formulário Standard'.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
'Transação que associa Formulário X Programa'.

  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Transação'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_prog.
  PERFORM z_escreve_tabela USING  '2'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_form.
  PERFORM z_escreve_tabela USING  '3'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans_form_prog.

  PERFORM z_escreve_tabela USING  '4'                    "Linha
                                  '2'                    "Coluna
                                  '12'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans.


  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.

ENDFORM.                    " z_prog_form

*&---------------------------------------------------------------------*
*&      Form  insere_logo
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_6356   text
*----------------------------------------------------------------------*
FORM insere_logo USING    VALUE(p_filename).
*    Selection.InlineShapes.AddPicture FileName:=
*, LinkToFile:=False, SaveWithDocument:=True
  GET PROPERTY OF gs_selection 'InlineShapes' = gs_shapes.
  CALL METHOD OF gs_shapes 'AddPicture'
    EXPORTING
      #1 = p_filename
      #2 = 'False'
      #3 = 'True'.

ENDFORM.                    " insere_logo
*&---------------------------------------------------------------------*
*&      Form  z_campos_tela_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_campos_tela_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '12.  Campos da Tela'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Field Exit)(Relacionar os campos com consistências desejadas, podendo mesclar a coluna de consistência se for o mesmo para varias telas)'.
*   Pula uma linha
  PERFORM z_new_line.


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Transação SAP'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Programa'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Nr Tela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Nome campo na tela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Nome do Data Element'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '6'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Id Parameter'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '7'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Observações Consistência'.
  PERFORM z_avanca_fim_tabela .

ENDFORM.                    " z_campos_tela_header

*---------------------------------------------------------------------*
*       FORM z_campos_tela_items                                      *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_TRANS)                                                *
*  -->  VALUE(P_PROG)                                                 *
*  -->  VALUE(P_TELA)                                                 *
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_DATA_ELEM)                                            *
*  -->  VALUE(P_ID)                                                   *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_campos_tela_items USING    VALUE(p_trans)
                                  VALUE(p_prog)
                                  VALUE(p_tela)
                                  VALUE(p_campo)
                                  VALUE(p_data_elem)
                                  VALUE(p_id)
                                  VALUE(p_obs)
                                  VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trans.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_prog.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tela.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '5'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_data_elem.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '6'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_id.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '7'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_campos_tela_items
*&---------------------------------------------------------------------*
*&      Form  z_func_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_func_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '12.1.  Função Gerada'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
'(Field Exit)(Relacionar as funções geradas para o elemento de dados que deverá ser único para este documento)'.
*   Pula uma linha
  PERFORM z_new_line.


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '5'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '1'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Seq'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Nome do Data Element'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Get Parameter'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Set Parameter'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '6.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Função'.
  PERFORM z_avanca_fim_tabela .


ENDFORM.                    " z_func_header

*---------------------------------------------------------------------*
*       FORM z_func_items                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_SEQ)                                                  *
*  -->  VALUE(P_DATA_ELEM)                                            *
*  -->  VALUE(P_GET_PARAM)                                            *
*  -->  VALUE(P_SET_PARAM)                                            *
*  -->  VALUE(P_FUNCAO)                                               *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_func_items USING    VALUE(p_seq)
                           VALUE(p_data_elem)
                           VALUE(p_get_param)
                           VALUE(p_set_param)
                           VALUE(p_funcao)
                           VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '5'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '1'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_seq.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '2.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_data_elem.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_get_param.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '3.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_set_param.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '5'                    "Coluna
                                  '6.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_funcao.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_func_items
*&---------------------------------------------------------------------*
*&      Form  z_map_campos_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_map_campos_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '13.  Layout de Tela / Relatório / Formulário'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
'(Descrever neste tópico o layout a ser desenvolvido. Buscar os padrôes e considerações para o desenvolvimento)'.
*   Pula uma linha
  PERFORM z_new_line.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '13.1.  Mapeamento dos Campos'.  "Texto


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '8'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '1'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Seq'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Form'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Tam.'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Trunc.'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '1'                  "Center-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
          'Descrição               Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '6'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Tabela'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '7'                    "Coluna
                                  '2'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '8'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Observações'.
  PERFORM z_avanca_fim_tabela .


ENDFORM.                    " z_map_campos_header

*---------------------------------------------------------------------*
*       FORM z_map_campos_items                                       *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_SEQ)                                                  *
*  -->  VALUE(P_FORM)                                                 *
*  -->  VALUE(P_TAM)                                                  *
*  -->  VALUE(P_TRUNC)                                                *
*  -->  VALUE(P_DESC)                                                 *
*  -->  VALUE(P_TABELA)                                               *
*  -->  VALUE(P_CAMPO)                                                *
*  -->  VALUE(P_OBS)                                                  *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_map_campos_items USING    VALUE(p_seq)
                                 VALUE(p_form)
                                 VALUE(p_tam)
                                 VALUE(p_trunc)
                                 VALUE(p_desc)
                                 VALUE(p_tabela)
                                 VALUE(p_campo)
                                 VALUE(p_obs)
                                 VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '8'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '1'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_seq.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_form.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tam.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_trunc.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '5'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_desc.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '6'                    "Coluna
                                  '1.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_tabela.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '7'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_campo.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '8'                    "Coluna
                                  '4'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_obs.

  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_map_campos_items
*&---------------------------------------------------------------------*
*&      Form  z_textos_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_textos_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '14.  Tradução'.  "Texto

  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '0'                "Bold
                              '1'                "Italic
                              '0'                "Underline
                              wdcolorgray50      "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
'(Traduzir os textos e as mensagens utilizados)'.
*   Pula uma linha
  PERFORM z_new_line.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '14.1.  Textos'.  "Texto


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Campo Português'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '5.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Campo Inglês'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorgray50       "Font Color
                                  ''                     "BgColor
                                'Outro Idioma'.
  PERFORM z_avanca_fim_tabela .



ENDFORM.                    " z_textos_header
*&---------------------------------------------------------------------*
*&      Form  z_textos_items
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_0248   text
*      -->P_0249   text
*      -->P_0250   text
*      -->P_0251   text
*----------------------------------------------------------------------*
FORM z_textos_items USING    VALUE(p_pt)
                             VALUE(p_en)
                             VALUE(p_outro)
                             VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '3'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '5.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pt.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '5.5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_en.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '6'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_outro.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_textos_items
*&---------------------------------------------------------------------*
*&      Form  z_msgs_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_msgs_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '14.2.  Mensagens'.  "Texto


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '5'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Classe'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '1'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nº'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '4.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                'Português'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '4.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                'Inglês'.
  PERFORM z_escreve_tabela USING '1'                    "Linha
                                 '5'                    "Coluna
                                 '5.5'                  "Largura
                                 '1'                    "Autoajuste
                                 '0'                    "Left-justified
                                 'Calibri'                "Font
                                 '10'                   "Size
                                 '1'                    "Bold
                                 '0'                    "Italic
                                 '0'                    "Underline
                                 wdcolorgray50          "Font Color
                                 ''                     "BgColor
                               'Outro'.
  PERFORM z_avanca_fim_tabela .


ENDFORM.                    " z_msgs_header

*---------------------------------------------------------------------*
*       FORM z_msgs_items                                             *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_CLASSE)                                               *
*  -->  VALUE(P_NUM)                                                  *
*  -->  VALUE(P_PT)                                                   *
*  -->  VALUE(P_EN)                                                   *
*  -->  VALUE(P_OUTRO)                                                *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_msgs_items USING    VALUE(p_classe)
                           VALUE(p_num)
                           VALUE(p_pt)
                           VALUE(p_en)
                           VALUE(p_outro)
                           VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .



  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '5'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '1.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_classe.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '1'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_num.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '4.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_pt.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '4.5'                  "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_en.
  PERFORM z_escreve_tabela USING  p_count               "Linha
                                 '5'                    "Coluna
                                 '5.5'                  "Largura
                                 '1'                    "Autoajuste
                                 '0'                    "Left-justified
                                 'Calibri'                "Font
                                 '10'                   "Size
                                 '0'                    "Bold
                                 '0'                    "Italic
                                 '0'                    "Underline
                                 wdcolorautomatic       "Font Color
                                 ''                     "BgColor
                                 p_outro.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_msgs_items
*&---------------------------------------------------------------------*
*&      Form  z_menu_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_menu_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '15.  Status-Gui'.  "Texto

*   Pula uma linha
  PERFORM z_new_line.
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              ''                "Indice
  '15.1.  Barra de Menu'.  "Texto


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Cod.'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '12'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Texto'.
  PERFORM z_avanca_fim_tabela .



ENDFORM.                    " z_menu_header
*&---------------------------------------------------------------------*
*&      Form  z_menu_items
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_0272   text
*      -->P_0273   text
*      -->P_0274   text
*----------------------------------------------------------------------*
FORM z_menu_items USING    VALUE(p_cod)
                           VALUE(p_texto)
                           VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .

  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '2'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '5'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_cod.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '12'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_texto.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_menu_items
*&---------------------------------------------------------------------*
*&      Form  z_botoes_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM z_botoes_header.
  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_escreve_texto USING 'Calibri'          "Font
                              '10'               "Size
                              '1'                "Bold
                              '0'                "Italic
                              '0'                "Underline
                              wdcolorautomatic   "Font Color
                              wdcolorautomatic   "BGColor
                              '1'                "Indice
  '15.2.  Barra de Botões'.  "Texto


  GET PROPERTY OF gs_selection 'Range' = gs_range .
  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                 'Código de Função'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '2'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Categoria de Função'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '3'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Texto de Função'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '4'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Nome do Ícone'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '5'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Texto de Ícones'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '6'                    "Coluna
                                  '3'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Texto Informativo'.
  PERFORM z_escreve_tabela USING  '1'                    "Linha
                                  '7'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '1'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  'Seleção Direta'.

  PERFORM z_avanca_fim_tabela .



ENDFORM.                    " z_botoes_header

*---------------------------------------------------------------------*
*       FORM z_botoes_items                                           *
*---------------------------------------------------------------------*
*       ........                                                      *
*---------------------------------------------------------------------*
*  -->  VALUE(P_COD)                                                  *
*  -->  VALUE(P_CATEG)                                                *
*  -->  VALUE(P_TXT_FUNC)                                             *
*  -->  VALUE(P_NOME)                                                 *
*  -->  VALUE(P_TXT_ICO)                                              *
*  -->  VALUE(P_TXT_INFO)                                             *
*  -->  VALUE(P_SELEC)                                                *
*  -->  VALUE(P_COUNT)                                                *
*---------------------------------------------------------------------*
FORM z_botoes_items USING    VALUE(p_cod)
                             VALUE(p_categ)
                             VALUE(p_txt_func)
                             VALUE(p_nome)
                             VALUE(p_txt_ico)
                             VALUE(p_txt_info)
                             VALUE(p_selec)
                             VALUE(p_count).
  p_count = p_count + 1.
  GET PROPERTY OF gs_selection 'Range' = gs_range .

  PERFORM z_cria_tabela USING     gs_tables
                                  gs_range
                                 '1'  "Linhas
                                 '7'  "Colunas
                        CHANGING gs_table.

  PERFORM z_set_border USING  gs_table
                              '1'   "Enable all
                              ''    "'top'
                              ''    "'left'
                              ''    "'botton'
                              ''    "'right'
                              ''    "'horizontal'
                              ''.   "'vertical'.

  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '1'                    "Coluna
                                  '2'                    "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_cod.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '2'                    "Coluna
                                  '3'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_categ.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '3'                    "Coluna
                                  '2'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_txt_func.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '4'                    "Coluna
                                  '3'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_nome.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '5'                    "Coluna
                                  '2'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_txt_ico.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '6'                    "Coluna
                                  '3'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_txt_info.
  PERFORM z_escreve_tabela USING  p_count                "Linha
                                  '7'                    "Coluna
                                  '2'                   "Largura
                                  '1'                    "Autoajuste
                                  '0'                    "Left-justified
                                  'Calibri'                "Font
                                  '10'                   "Size
                                  '0'                    "Bold
                                  '0'                    "Italic
                                  '0'                    "Underline
                                  wdcolorautomatic       "Font Color
                                  ''                     "BgColor
                                  p_selec.
  PERFORM z_avanca_fim_tabela.
  PERFORM z_move_down USING gs_table
                            '1'.


ENDFORM.                    " z_botoes_items
*&---------------------------------------------------------------------*
*&      Form  z_insere_index
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_GS_RANGE  text
*      -->P_1188   text
*----------------------------------------------------------------------*
FORM z_insere_index USING    p_gs_range
                             VALUE(p_level).


*Selection.Range.Paragraphs.OutlineLevel = wdOutlineLevel1
*  set property of gs_view  'Type'     = '5'.
  GET PROPERTY OF p_gs_range 'Paragraphs' = gs_paragraph.
  SET PROPERTY OF gs_paragraph 'OutlineLevel' = p_level.
*  set property of gs_view  'Type'     = '3'.
ENDFORM.                    " z_insere_index
*&---------------------------------------------------------------------*
*&      Form  z_goto_page
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_8337   text
*----------------------------------------------------------------------*
FORM z_goto_page USING    VALUE(p_page).
*Selection.GoTo What:=wdGoToPage, Which:=wdGoToNext, Name:="2"
  GET PROPERTY OF gs_application 'Selection' = gs_selection .
*  call method of gs_selection 'GoToPrevious' = gs_find
*  exporting
*  #1 = '3'.
  CALL METHOD OF gs_selection 'GoTo' = gs_find
    EXPORTING
    #1 = '1'
    #2 = '2'
    #3 = '1'
    #4 = p_page.


ENDFORM.                    " z_goto_page
*&---------------------------------------------------------------------*
*&      Form  z_cria_conteudo
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_0491   text
*----------------------------------------------------------------------*
FORM z_cria_conteudo USING    VALUE(p_page).
*TablesOfContents.Add Range:=Selection.Range, UseHeadingStyles:=True, _
*        UpperHeadingLevel:=1, LowerHeadingLevel:=3, UseFields:="",
*TableID:="", _   RightAlignPageNumbers:=True,  IncludePageNumbers:=True
*, AddedStyles:="", _  UseHyperlinks:=True, HidePageNumbersInWeb:=True,
*UseOutlineLevels:= _ True

  PERFORM z_goto_page USING p_page.

  GET PROPERTY OF gs_selection 'Range' = gs_range .
  GET PROPERTY OF gs_actdoc 'TablesOfContents' = gs_actdoc_tab_cont.

*  CALL METHOD OF gs_actdoc_tab_cont 'Add' = gs_actdoc_tab_cont
*  EXPORTING
*  #1 = gs_range  "Range
*  #2 = 'True'    "UseHeadingStyles
*  #3 = '1'       "UpperHeadingLevel
*  #4 = '3'       "LowerHeadingLevel
*  #5 = 'False'   "UseFields
*  #6 = 'A'       "TableID
*  #7 = 'True'    "RightAlignPageNumbers
*  #8 = 'True'    "IncludePageNumbers
*  #9 = ''        "AddedStyles
*  #10 = 'True'   "UseHyperlinks:=True
*  #11 = 'True'   "HidePageNumbersInWeb
*  #12 = 'True'.  "UseOutlineLevels

  CALL METHOD OF gs_actdoc_tab_cont 'Add' = gs_actdoc_tab_cont
    EXPORTING
      #1  = gs_range  "Range
      #2  = '1'       "UseHeadingStyles
      #3  = '1'       "UpperHeadingLevel
      #4  = '3'       "LowerHeadingLevel
      #5  = '0'       "UseFields
      #6  = ''       "TableID
      #7  = '1'       "RightAlignPageNumbers
      #8  = '1'       "IncludePageNumbers
      #9  = ''        "AddedStyles
      #10 = '1'      "UseHyperlinks:=True
      #11 = '1'      "HidePageNumbersInWeb
      #12 = '1'.     "UseOutlineLevels


ENDFORM.                    " z_cria_conteudo
*&---------------------------------------------------------------------*
*&      Form  ZFUNCAO_ESPEC_TEC
*&---------------------------------------------------------------------*
FORM zfuncao_espec_tec  TABLES   t_entrada STRUCTURE ys002
                                 t_retorno STRUCTURE ys002
                        USING    declaracao
                                 evento
                                 rotina
                        CHANGING p_subrc.

* Verifica se a tabela contem dados.
  IF NOT t_entrada[] IS INITIAL.
* Selecionar Dados
    PERFORM z_seleciona_dados USING declaracao
                                    evento
                                    rotina
                                    p_subrc.
  ELSE.
    p_subrc = '1'.
    EXIT.
  ENDIF.

* Traduz os códigos de Linguagem ABAP para Português Estruturado.
  PERFORM z_traduz_codigos TABLES t_entrada
                                  t_retorno.

ENDFORM.                    " ZFUNCAO_ESPEC_TEC
*&---------------------------------------------------------------------*
*&      Form  z_seleciona_dados
*&---------------------------------------------------------------------*
* Essas validações são feitas para que quando for traduzido um tipo de
* código especifico não precise verificar com códigos que não vão
* existir nesse bloco de códigos.
*----------------------------------------------------------------------*
*      -->P_DECLARACAO  text
*      -->P_EVENTO  text
*      -->P_ROTINA  text
*----------------------------------------------------------------------*
FORM z_seleciona_dados  USING    p_declaracao
                                 p_evento
                                 p_rotina
                                 p_subrc.

* Quando for flegado somente declaração fara a seleção somente dos
* códigos referentes a Declarações
  IF  NOT p_declaracao IS INITIAL AND p_evento IS INITIAL
      AND p_rotina     IS INITIAL.

    PERFORM z_seleciona_declaracao.

* Quando for flegado somente evento fara a seleção somente dos
* códigos referentes aos eventos que existem no código.
  ELSEIF p_declaracao IS INITIAL AND NOT p_evento IS INITIAL
         AND p_rotina IS INITIAL.


    PERFORM z_seleciona_evento.

* Quando for flegado somente rotinas fara a seleção somente dos
* códigos referentes a todas as rotinas do programa.
  ELSEIF p_declaracao IS INITIAL AND p_evento IS INITIAL
     AND NOT p_rotina IS INITIAL.

    PERFORM z_seleciona_rotina.

* Quando não for flegado nada.
  ELSEIF p_declaracao IS INITIAL AND p_evento IS INITIAL
     AND p_rotina     IS INITIAL.

    p_subrc = 2. "preencher pelo menos um tipo de código.

* Quando for flegado mais de um tipo.
  ELSE.
    p_subrc = 3.   "Preencher somente um tipo de código.
  ENDIF.

ENDFORM.                    " z_seleciona_dados

*&---------------------------------------------------------------------*
*&      Form  z_seleciona_declaracao
*&---------------------------------------------------------------------*
* Seleciona só os comados do tipo D 'Declaração'
*----------------------------------------------------------------------*
FORM z_seleciona_declaracao.

*Tabela local para selecionar os tipos de comandos.
*Não foi possivel selecionar direto na t_source porque a t_source tem
*que ser do tipo string é assim não podemos fazer uma seleção de campos
*diferentes.
  DATA: tl_selecao TYPE TABLE OF tp_selecao WITH HEADER LINE.
*  DATA: BEGIN OF tl_selecao OCCURS 0,
*          tipo     LIKE zege_source-linha,
*          comando  LIKE zege_source-linha,
*          sentenca LIKE zege_source-linha,
*        END OF tl_selecao.

  CLEAR: t_source, tl_selecao.
  REFRESH: t_source, tl_selecao.

  PERFORM preenche_statement TABLES tl_selecao
                             USING 'D'.
*  SELECT tipo
*         comando
*         sentenca
*  FROM ztge_source
*  INTO TABLE tl_selecao
*  WHERE tipo = 'D'.

  IF sy-subrc IS INITIAL.
    SORT tl_selecao BY comando DESCENDING.
    LOOP AT tl_selecao.
      MOVE tl_selecao-tipo     TO t_source-tipo.
      MOVE tl_selecao-comando  TO t_source-comando.
      MOVE tl_selecao-sentenca TO t_source-sentenca.
      APPEND t_source.
    ENDLOOP.
  ENDIF.

ENDFORM.                    " z_seleciona_declaracao
*&---------------------------------------------------------------------*
*&      Form  z_seleciona_evento
*&---------------------------------------------------------------------*
*  Para os eventos cabem todos os tipos de códigos
*----------------------------------------------------------------------*
FORM z_seleciona_evento.

*Tabela local para selecionar os tipos de comandos.
*Não foi possivel selecionar direto na t_source porque a t_source tem
*que ser do tipo string é assim não podemos fazer uma seleção de campos
*diferentes.
  DATA: tl_selecao TYPE TABLE OF tp_selecao WITH HEADER LINE.


  CLEAR: t_source, tl_selecao.
  REFRESH: t_source, tl_selecao.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'C'.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'D'.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'R'.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'E'.
*  SELECT tipo
*         comando
*         sentenca
*  FROM ztge_source
*  INTO TABLE tl_selecao.

  IF sy-subrc IS INITIAL.
    SORT tl_selecao BY comando DESCENDING.
    LOOP AT tl_selecao.
      MOVE tl_selecao-tipo TO t_source-tipo.
      MOVE tl_selecao-comando TO t_source-comando.
      MOVE tl_selecao-sentenca TO t_source-sentenca.
      APPEND t_source.
    ENDLOOP.
  ENDIF.

ENDFORM.                    " z_seleciona_evento

*&---------------------------------------------------------------------*
*&      Form  z_seleciona_rotina
*&---------------------------------------------------------------------*
*  Para as rotinas não cabem as declarações de eventos.
*----------------------------------------------------------------------*
FORM z_seleciona_rotina.

*Tabela local para selecionar os tipos de comandos.
*Não foi possivel selecionar direto na t_source porque a t_source tem
*que ser do tipo string é assim não podemos fazer uma seleção de campos
*diferentes.
  DATA: tl_selecao TYPE TABLE OF tp_selecao WITH HEADER LINE.

  CLEAR: t_source, tl_selecao.
  REFRESH: t_source, tl_selecao.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'C'.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'D'.

  PERFORM preenche_statement TABLES tl_selecao
                             USING  'R'.
*  SELECT tipo
*         comando
*         sentenca
*  FROM ztge_source
*  INTO TABLE tl_selecao
*  WHERE tipo NE 'E'.

  IF sy-subrc IS INITIAL.
    SORT tl_selecao BY comando DESCENDING.
    LOOP AT tl_selecao.
      MOVE tl_selecao-tipo TO t_source-tipo.
      MOVE tl_selecao-comando TO t_source-comando.
      MOVE tl_selecao-sentenca TO t_source-sentenca.
      APPEND t_source.
    ENDLOOP.
  ENDIF.

ENDFORM.                    " z_seleciona_rotina
*&---------------------------------------------------------------------*
*&      Form  z_traduz_codigos
*&---------------------------------------------------------------------*
* Rotina para traduzir os códigos em Português estruturado.
*----------------------------------------------------------------------*
*      -->t_entrada  ==> Tabela que contem o código em si.
*      -->t_retorno  ==> Tabela que retornara a tradução do código.
*----------------------------------------------------------------------*
FORM z_traduz_codigos TABLES   t_entrada STRUCTURE ys002
                               t_retorno STRUCTURE ys002.

* Variáveis locais
  DATA: vl_tamanho TYPE i,
        "tamanho do campo que contem o comando da tabela t_source.
        vl_check   TYPE c,
        vl_e_form  TYPE c,
        vl_form.

* Constantes locais
  CONSTANTS: cl_form(8)     TYPE c VALUE '..FORM..',     "FORM
             cl_endform(11) TYPE c VALUE '..ENDFORM..'.  "ENDFORM

* Tabela interna para colocar cada linha de codigo a ser tratada.
  DATA : BEGIN OF t_comando OCCURS 0,
           text(200),
         END OF t_comando.

* Tabela interna para guardar o codigo em si.
  DATA : BEGIN OF tl_codigo OCCURS 0,
           text(200),
         END OF tl_codigo.

  CLEAR: tl_codigo.
  REFRESH: tl_codigo.

  tl_codigo[] = t_entrada[].


  CLEAR: t_comando, t_retorno, vl_tamanho.
  REFRESH: t_comando, t_retorno.


  LOOP AT tl_codigo INTO t_comando-text.


**-- Linhas a desconsiderar
    CHECK t_comando-text(3) NE '***'.
    CHECK t_comando-text(2) NE '*&'.
    CHECK t_comando-text(1) NE '*'.


**-- Desloca a primeira posição deixando um branco
    SHIFT t_comando-text RIGHT.

**-- subtitui todos os brancos por pontos
    TRANSLATE t_comando-text USING ' .'.

*--Substitui as letras minusculas por maiusculas.
    TRANSLATE t_comando-text TO UPPER CASE.


**-- Substitui comando por sentença
    LOOP AT t_source.

*>> Este comando será utilizado na versão 4.7 do R/3
**      REPLACE ALL OCCURRENCES
**      OF
**      t_replace-comando
**      IN
**      t_source-text
**      WITH
**      t_replace-sentenca IGNORING CASE.
*<<


      vl_check = 'X'.
      WHILE vl_check = 'X'.

        vl_tamanho = strlen( t_source-comando ).

        SEARCH t_comando-text FOR cl_form." AND MARK.
        IF sy-subrc IS INITIAL AND vl_form EQ 'X'.

*          IF NOT t_source-comando EQ '.FORM.'.
*            REPLACE t_source-comando LENGTH vl_tamanho
*                      WITH t_source-sentenca
*                        INTO t_comando-text.
*
*            IF NOT sy-subrc IS INITIAL.
          CLEAR: vl_check.
*            ENDIF.
*          ENDIF.

        ELSEIF sy-subrc IS INITIAL.

          REPLACE t_source-comando LENGTH vl_tamanho
                    WITH t_source-sentenca
                      INTO t_comando-text.

          IF NOT sy-subrc IS INITIAL.
            CLEAR: vl_check.
          ENDIF.

          SEARCH t_comando-text FOR cl_form." AND MARK.
          IF NOT sy-subrc IS INITIAL.
            MOVE 'X' TO vl_form.
          ENDIF.

        ELSE.

          SEARCH t_comando-text FOR cl_endform. " AND MARK.
          IF sy-subrc IS INITIAL.
            MOVE space TO vl_form.
          ENDIF.

          REPLACE t_source-comando LENGTH vl_tamanho
          WITH t_source-sentenca
            INTO t_comando-text.

          IF NOT sy-subrc IS INITIAL.
            CLEAR: vl_check.
          ENDIF.

        ENDIF.

      ENDWHILE.

    ENDLOOP. "t_source.


**-- Retira os pontos e devolve os espacos
    TRANSLATE t_comando-text USING '. '.

**-- Deixa o ponto final em linhas validas
*    IF t_comando-text CA 'AEIOUaeiou'.
*      CONCATENATE t_comando-text '.' INTO t_comando-text .
*    ENDIF.
    APPEND t_comando.
  ENDLOOP.   "tl_codigo

**--Carregar a tabela t_retorno com o código já traduzido. Para que a
*   tabela com o código em si não se perca e a tradução fique em outra
*   tabela.
  t_retorno[] = t_comando[].

ENDFORM.                    " z_traduz_codigos
*&---------------------------------------------------------------------*
*&      Form  PREENCHE_STATEMENT
*&---------------------------------------------------------------------*
FORM preenche_statement  TABLES   lt_selecao STRUCTURE s_selecao
                         USING    VALUE(p_tipo).
  IF p_tipo = 'C'.
    PERFORM append_selecao:
*TABLES lt_selecao USING '.<.                                                         ' '.menor que.                                                 ',
*TABLES lt_selecao USING '.<=.                                                        ' '.menor igual que.                                           ',
TABLES lt_selecao USING '.<>.                                                        ' '.diferente.                                                 ',
*TABLES lt_selecao USING '.=.                                                         ' '.igual.                                                     ',
*TABLES lt_selecao USING '.>.                                                         ' '.maior que.                                                 ',
*TABLES lt_selecao USING '.>=.                                                        ' '.maior igual que.                                           ',
TABLES lt_selecao USING '.ADD.                                                       ' '.Adicionar.                                                 ',
TABLES lt_selecao USING '.ADJACENT.DUPLICATES.                                       ' '.linhas duplicadas.                                         ',
TABLES lt_selecao USING '.AND.                                                       ' '.e.                                                         ',
TABLES lt_selecao USING '.AND.WAIT.                                                  ' '.aguardar retorno.                                          ',
TABLES lt_selecao USING '.APPEND.                                                    ' '.Adicionar.                                                 ',
TABLES lt_selecao USING '.APPENDING.                                                 ' '.adicionando.                                               ',
TABLES lt_selecao USING '.ARCHIVE.MODE.                                              ' '.com modo de arquivamento.                                  ',
TABLES lt_selecao USING '.ARCHIVE.PARAMETERS.                                        ' '.com parâmetros de arquivamento.                            ',
TABLES lt_selecao USING '.AS.                                                        ' '.como.                                                      ',
TABLES lt_selecao USING '.AS.TEXT.                                                   ' '.como texto.                                                ',
TABLES lt_selecao USING '.ASSIGN.                                                    ' '.associa.                                                   ',
TABLES lt_selecao USING '.AT.                                                        ' '.Ao.                                                        ',
TABLES lt_selecao USING '.AT.END.                                                    ' '.No último.                                                 ',
TABLES lt_selecao USING '.AT.LAST.                                                   ' '.No úlitmo.                                                 ',
TABLES lt_selecao USING '.AT.NEW.                                                    ' '.No primeiro.                                               ',
TABLES lt_selecao USING '.ALL.ENTRIES.                                               ' '.todas as entradas.                                         ',
TABLES lt_selecao USING '.ALL.FIELDS.                                                ' '.todos os campos.                                           ',
TABLES lt_selecao USING '.BINARY.SEARCH.                                             ' '.utilizando pesquisa binária.                               ',
TABLES lt_selecao USING '.BLUE.                                                      ' '.azul.                                                      ',
TABLES lt_selecao USING '.BY.                                                        ' '.por.                                                       ',
TABLES lt_selecao USING '.CALL.                                                      ' '.Chamar/Executar.                                           ',
TABLES lt_selecao USING '.CALL.METHOD.                                               ' '.Chamar o método.                                           ',
TABLES lt_selecao USING '.CASE.                                                      ' '.Verificar conteúdo de.                                     ',
TABLES lt_selecao USING '.CHAIN.                                                     ' '.processar em sequência.                                    ',
TABLES lt_selecao USING '.CHANGING.                                                  ' '.atualizando parâmetro.                                     ',
TABLES lt_selecao USING '.CHECK.                                                     ' '.Para continuar, verifique se.                              ',
TABLES lt_selecao USING '.CLEAR.                                                     ' '.Inicializar conteudo de.                                   ',
TABLES lt_selecao USING '.CLEAR:.                                                    ' '.Limpar:.                                                   ',
TABLES lt_selecao USING '.COLLECT.                                                   ' '.Coletar.                                                   ',
TABLES lt_selecao USING '.COLOR.                                                     ' '.cor.                                                       ',
TABLES lt_selecao USING '.COMMIT.WORK.                                               ' '.Efetivar dados na Base.                                    ',
TABLES lt_selecao USING '.COMPARING                                                  ' '.comparando.                                                ',
TABLES lt_selecao USING '.COMPUTE.                                                   ' '.Calcular.                                                  ',
TABLES lt_selecao USING '.CONCATENATE.                                               ' '.Concatenar.                                                ',
TABLES lt_selecao USING '.COPIES.                                                    ' '.cópias.                                                    ',
TABLES lt_selecao USING '.CORRESPONDING.                                             ' '.Correspondente a.                                          ',
TABLES lt_selecao USING '.COVER.TEXT.                                                ' '.com título de fila.                                        ',
TABLES lt_selecao USING '.CPI.                                                       ' '.caracteres por inch.                                       ',
TABLES lt_selecao USING '.CREATE.                                                    ' '.criar.                                                     ',
TABLES lt_selecao USING '.CREATE.OBJECT.                                             ' '.Criar o objeto.                                            ',
TABLES lt_selecao USING '.DATASET.EXPIRATION.                                        ' '.com data de expiração do dataset.                          ',
TABLES lt_selecao USING '.DELETE.                                                    ' '.Eliminar.                                                  ',
TABLES lt_selecao USING '.DEPARTMENT.                                                ' '.nome do departamento.                                      ',
TABLES lt_selecao USING '.DESCRIBE.                                                  ' '.Retornar os atributos de.                                  ',
TABLES lt_selecao USING '.DESCRIBE.DISTANCE.BETWEEN.                                 ' '.Determinar a distância entre .                             ',
TABLES lt_selecao USING '.DESCRIBE.FIELD.                                            ' '.Retornar os atributos do campo.                            ',
TABLES lt_selecao USING '.DESCRIBE.TABLE.                                            ' '.Retornar os atributos da tabela.                           ',
TABLES lt_selecao USING '.DESTINATION.                                               ' '.com destino.                                               ',
TABLES lt_selecao USING '.DO.                                                        ' '.Executar repetidamente.                                    ',
TABLES lt_selecao USING '.ELSE.                                                      ' '.Senão.                                                     ',
TABLES lt_selecao USING '.ELSEIF.                                                    ' '.Se não, se.                                                ',
TABLES lt_selecao USING '.ENDAT.                                                     ' '.Final do AT.                                               ',
TABLES lt_selecao USING '.ENDCASE.                                                   ' '.Fim da Verificação.                                        ',
TABLES lt_selecao USING '.ENDCHAIN.                                                  ' '.finalizar sequência.                                       ',
TABLES lt_selecao USING '.ENDDO.                                                     ' '.Fim da Repetição.                                          ',
TABLES lt_selecao USING '.ENDIF.                                                     ' '.Fim Se.                                                    ',
TABLES lt_selecao USING '.ENDLOOP.                                                   ' '.Fim do Laço.                                               ',
TABLES lt_selecao USING '.ENDMODULE.                                                 ' '.Fim do Módulo.                                             ',
*TABLES lt_selecao USING '.EQ.                                                        ' '.igual.                                                     ',
TABLES lt_selecao USING '.EQ.                                                        ' '.=.                                                         ',
TABLES lt_selecao USING '.EXCEPTIONS.                                                ' '.Exceções.                                                  ',
TABLES lt_selecao USING '.EXIT.FROM.STEP-LOOP.                                       ' '.Sair do laço.                                              ',
TABLES lt_selecao USING '.EXTRACT.                                                   ' '.extrair.                                                   ',
TABLES lt_selecao USING '.FIELD.                                                     ' '.o campo.                                                   ',
TABLES lt_selecao USING '.FIELDS.                                                    ' '.os campos.                                                 ',
TABLES lt_selecao USING '.FONT.                                                      ' '.com o tamanho da fonte.                                    ',
TABLES lt_selecao USING '.FOR.                                                       ' '.para.                                                      ',
TABLES lt_selecao USING '.FOR.ALL.ENTRIES.IN.                                        ' '.para todas as entradas na tabela.                          ',
TABLES lt_selecao USING '.FORMAT.                                                    ' '.formatar.                                                  ',
TABLES lt_selecao USING '.FREE.                                                      ' '.Inicializar/Liberar área de.                               ',
TABLES lt_selecao USING '.FREE.MEMORY.ID.                                            ' '.Liberar da memória a identificação.                        ',
TABLES lt_selecao USING '.FREE:.                                                     ' '.Liberar da memória:.                                       ',
TABLES lt_selecao USING '.FROM.                                                      ' '.da/de.                                                     ',
TABLES lt_selecao USING '.FUNCTION.                                                  ' '.Função.                                                    ',
TABLES lt_selecao USING '.GE.                                                        ' '.maior igual que.                                           ',
TABLES lt_selecao USING '.GET.                                                       ' '.obter da tabela.                                           ',
TABLES lt_selecao USING '.GREEN.                                                     ' '.verde.                                                     ',
TABLES lt_selecao USING '.GT.                                                        ' '.maior que.                                                 ',
TABLES lt_selecao USING '.HOTSPOT.                                                   ' '.interativo.                                                ',
TABLES lt_selecao USING '.I.                                                         ' '.numérico inteiro.                                          ',
TABLES lt_selecao USING '.IF.                                                        ' '.Se.                                                        ',
TABLES lt_selecao USING '.IF.FOUND.                                                  ' '.se encontrado.                                             ',
TABLES lt_selecao USING '.IMMEDIATELY.                                               ' '.imprimindo imediatamente.                                  ',
TABLES lt_selecao USING '.IN.                                                        ' '.Em.                                                        ',
TABLES lt_selecao USING '.IN.PROGRAM.                                                ' '.no programa.                                               ',
TABLES lt_selecao USING '.INCLUDE.                                                   ' '.Incluir Sub Programa.                                      ',
TABLES lt_selecao USING '.INDEX-LINE.                                                ' '.com índice de linha.                                       ',
TABLES lt_selecao USING '.INDEX.                                                     ' '.pelo indice.                                               ',
TABLES lt_selecao USING '.INNER.JOIN.                                                ' '.juntando.                                                  ',
TABLES lt_selecao USING '.INPUT.                                                     ' '.entrada.                                                   ',
TABLES lt_selecao USING '.INSERT.                                                    ' '.Inserir.                                                   ',
TABLES lt_selecao USING '.INTENSIFIED.                                               ' '.negrito.                                                   ',
TABLES lt_selecao USING '.INTO.                                                      ' '.Colocar resultado em,.                                     ',
TABLES lt_selecao USING '.INTO.TABLE.                                                ' '.na tabela interna.                                         ',
TABLES lt_selecao USING '.INVERSE.                                                   ' '.inverso.                                                   ',
TABLES lt_selecao USING '.IS                                                         ' '                                                            ',
TABLES lt_selecao USING '.IS.INITIAL.                                                ' '.estiver com valor inicial.                                 ',
TABLES lt_selecao USING '.IS.NOT.INITIAL.                                            ' '.Não é inicial.                                             ',
TABLES lt_selecao USING '.KEEP.IN.SPOOL.                                             ' '.manter na fila após impressão.                             ',
TABLES lt_selecao USING '.LATE.                                                      ' '.por final.                                                 ',
TABLES lt_selecao USING '.LAYOUT.                                                    ' '.padrão.                                                    ',
TABLES lt_selecao USING '.LE.                                                        ' '.menor igual que.                                           ',
TABLES lt_selecao USING '.LEAVE.                                                     ' '.sair do modo chamado.                                      ',
TABLES lt_selecao USING '.LEAVE.LIST-PROCESSING.                                     ' '.voltar do processamento de lista para a tela anterior.     ',
TABLES lt_selecao USING '.LEAVE.SCREEN.                                              ' '.sair da tela e processar a próxima.                        ',
TABLES lt_selecao USING '.LEAVE.TO.LIST-PROCESSING.                                  ' '.voltar para o processamento da lista.                      ',
TABLES lt_selecao USING '.LEFT.                                                      ' '.esquerda.                                                  ',
TABLES lt_selecao USING '.LEFT.MARGIN.                                               ' '.margem esquerda.                                           ',
TABLES lt_selecao USING '.LINE-COUNT.                                                ' '.linhas por página.                                         ',
TABLES lt_selecao USING '.LINE-SIZE.                                                 ' '.tamanho da linha.                                          ',
TABLES lt_selecao USING '.LINES.                                                     ' '.com o número de linhas em.                                 ',
TABLES lt_selecao USING '.LIST.AUTHORITY.                                            ' '.com autorização requerida para.                            ',
TABLES lt_selecao USING '.LIST.DATASET.                                              ' '.com o dataset.                                             ',
TABLES lt_selecao USING '.LIST.NAME.                                                 ' '.com nome da lista.                                         ',
TABLES lt_selecao USING '.LIST.NUMBER.OF.LINES.                                      ' '.atributos da lista, número de linhas.                      ',
TABLES lt_selecao USING '.LIST.NUMBER.OF.PAGES.                                      ' '.atributos da lista, número de páginas.                     ',
TABLES lt_selecao USING '.LOOP.AT.                                                   ' '.Montar Laço para.                                          ',
TABLES lt_selecao USING '.LPI.                                                       ' '.letras por inch.                                           ',
TABLES lt_selecao USING '.LT.                                                        ' '.menor que.                                                 ',
TABLES lt_selecao USING '.MESSAGE.                                                   ' '.Emitir mensagem.                                           ',
TABLES lt_selecao USING '.MODIFY.                                                    ' '.Atualizar/Inserir dados de.                                ',
TABLES lt_selecao USING '.MODULE.                                                    ' '.Módulo.                                                    ',
TABLES lt_selecao USING '.MOVE.                                                      ' '.Atribuir.                                                  ',
TABLES lt_selecao USING '.MOVE:.                                                     ' '.Atribuir.                                                  ',
TABLES lt_selecao USING '.MULTIPLY.                                                  ' '.Multiplos.                                                 ',
TABLES lt_selecao USING '.NE.                                                        ' '.diferente.                                                 ',
TABLES lt_selecao USING '.NEW-PAGE.                                                  ' '.Nova página.                                               ',
TABLES lt_selecao USING '.NEW-SECTION.                                               ' '.iniciar nova sessão.                                       ',
TABLES lt_selecao USING '.NEW.LIST.IDENTIFICATION.                                   ' '.nova requisição de fila.                                   ',
TABLES lt_selecao USING '.NO-HEADING .                                               ' '.sem cabeçalho.                                             ',
TABLES lt_selecao USING '.NO-TITLE.                                                  ' '.sem título.                                                ',
TABLES lt_selecao USING '.NO.DIALOG.                                                 ' '.omitindo tela de controle de impressora.                   ',
TABLES lt_selecao USING '.NOT.                                                       ' '.(não).                                                     ',
TABLES lt_selecao USING '.OFF.                                                       ' '.desligado.                                                 ',
TABLES lt_selecao USING '.ON.                                                        ' '.ativado.                                                   ',
TABLES lt_selecao USING '.ORDER.BY.                                                  ' '.organizando por.                                           ',
TABLES lt_selecao USING '.OUTER.JOIN.                                                ' '.excluindo.                                                 ',
TABLES lt_selecao USING '.PARAMETERS.                                                ' '.com parâmetros.                                            ',
TABLES lt_selecao USING '.PERFORM.                                                   ' '.Chamar rotina.                                             ',
TABLES lt_selecao USING '.PERFORM:.                                                  ' '.Chamar rotina.                                             ',
TABLES lt_selecao USING '.PINK.                                                      ' '.rosa.                                                      ',
TABLES lt_selecao USING '.POSITION.                                                  ' '.posição.                                                   ',
TABLES lt_selecao USING '.PRINT-CONTROL.                                             ' '.determinar o controle de impressão.                        ',
TABLES lt_selecao USING '.PRINT.OFF.                                                 ' '.liberar da fila.                                           ',
TABLES lt_selecao USING '.PRINT.ON.                                                  ' '.manter na fila.                                            ',
TABLES lt_selecao USING '.READ.                                                      ' '.ler.                                                       ',
TABLES lt_selecao USING '.READ.TABLE.                                                ' '.Ler tabela interna.                                        ',
TABLES lt_selecao USING '.RECEIVER.                                                  ' '.com o recebedor.                                           ',
TABLES lt_selecao USING '.RED.                                                       ' '.vermelho.                                                  ',
TABLES lt_selecao USING '.REFRESH.                                                   ' '.Reinicializar.                                             ',
TABLES lt_selecao USING '.REFRESH:.                                                  ' '.Eliminar da memória:.                                      ',
TABLES lt_selecao USING '.RETURN.TO.SCREEN.                                          ' '.voltar para a tela.                                        ',
TABLES lt_selecao USING '.RIGHT.                                                     ' '.direita.                                                   ',
TABLES lt_selecao USING '.SAP.COVER.PAGE.                                            ' '.com folha de rosto da SAP.                                 ',
TABLES lt_selecao USING '.SELECT.                                                    ' '.Selecionar.                                                ',
TABLES lt_selecao USING '.SEPARATED.                                                 ' '.separado.                                                  ',
TABLES lt_selecao USING '.SET.BLANK.LINES.OFF.                                       ' '.Desativar o uso de linhas em branco.                       ',
TABLES lt_selecao USING '.SET.BLANK.LINES.ON.                                        ' '.Ativar o uso de linhas em branco.                          ',
TABLES lt_selecao USING '.SET.HANDLER.                                               ' '.Atribuir evento.                                           ',
TABLES lt_selecao USING '.SET.HOLD.DATA.OFF.                                         ' '.Desativar valores padrão para a tela.                      ',
TABLES lt_selecao USING '.SET.HOLD.DATA.ON.                                          ' '.Ativar valores padrão para a tela.                         ',
TABLES lt_selecao USING '.SET.MARGIN.                                                ' '.definir a margem de impressão na tela para.                ',
TABLES lt_selecao USING '.SET.PF-STATUS.                                             ' '.Menu.                                                      ',
TABLES lt_selecao USING '.SET.SCREEN.                                                ' '.setar o número da próxima tela.                            ',
TABLES lt_selecao USING '.SET.TITLEBAR.                                              ' '.Título.                                                    ',
TABLES lt_selecao USING '.SIZE.                                                      ' '.tamanho do script.                                         ',
TABLES lt_selecao USING '.SKIP.                                                      ' '.pular linha.                                               ',
TABLES lt_selecao USING '.SORT.                                                      ' '.Ordenar conteudo de.                                       ',
TABLES lt_selecao USING '.STOP.                                                      ' '.Pare.                                                      ',
TABLES lt_selecao USING '.SUBMIT.                                                    ' '.enviar.                                                    ',
TABLES lt_selecao USING '.SUBSCREEN.                                                 ' '.sub-tela.                                                  ',
TABLES lt_selecao USING '.SUM.                                                       ' '.Sumarizar.                                                 ',
TABLES lt_selecao USING '.SUPPRESS.DIALOG.                                           ' '.Suprimir a saída da tela corrente.                         ',
TABLES lt_selecao USING '.SY-COLNO.                                                  ' '.número da coluna em que o cursor está posicionado.         ',
TABLES lt_selecao USING '.SY-LINCT.                                                  ' '.número de linhas por página da lista corrente.             ',
TABLES lt_selecao USING '.SY-LINNO.                                                  ' '.número corrente da linha.                                  ',
TABLES lt_selecao USING '.SY-PAGNO.                                                  ' '.número corrente da página.                                 ',
TABLES lt_selecao USING '.SY-SUBRC.                                                  ' '.Retorno de erro do sistema.                                ',
TABLES lt_selecao USING '.TIMES.                                                     ' '.vezes.                                                     ',
TABLES lt_selecao USING '.TO.                                                        ' '.para.                                                      ',
TABLES lt_selecao USING '.TRANSPORTING.                                              ' '.somente para os campos.                                    ',
TABLES lt_selecao USING '.ULINE.                                                     ' '.imprimir linha horizontal.                                 ',
TABLES lt_selecao USING '.UNASSIGN.                                                  ' '.desassocia.                                                ',
TABLES lt_selecao USING '.USING.                                                     ' '.utilizando o parâmetro.                                    ',
TABLES lt_selecao USING '.VLINE.                                                     ' '.imprimir linha vertical.                                   ',
TABLES lt_selecao USING '.WAIT.                                                      ' '.Executar comando de espera.                                ',
TABLES lt_selecao USING '.WHEN.                                                      ' '.quando valor for.                                          ',
TABLES lt_selecao USING '.WHERE.                                                     ' '.onde o campo.                                              ',
TABLES lt_selecao USING '.WITH-TITLE.                                                ' '.com título.                                                ',
TABLES lt_selecao USING '.WRITE.                                                     ' '.imprimir no relatório a linha.                             ',
TABLES lt_selecao USING '.WRITE:.                                                    ' '.imprimir no relatório as linhas.                           ',
TABLES lt_selecao USING '.YELLOW.                                                    ' '.amarelo.                                                   '.

  ELSEIF p_tipo = 'D'.
    PERFORM append_selecao:
    TABLES lt_selecao USING '.AS.                                                        ' '.como.                                                      ',
    TABLES lt_selecao USING '.BEGIN.                                                     ' '.Início.                                                    ',
    TABLES lt_selecao USING '.BLOCK.                                                     ' '.bloco.                                                     ',
    TABLES lt_selecao USING '.COMMON.PART.                                               ' '.área comum.                                                ',
    TABLES lt_selecao USING '.CONSTANTS.                                                 ' '.Declarar a constante.                                      ',
    TABLES lt_selecao USING '.CONSTANTS:.                                                ' '.Declarar as constantes.                                    ',
    TABLES lt_selecao USING '.CONTROLS.                                                  ' '.Definir o controle.                                        ',
    TABLES lt_selecao USING '.CONTROLS:.                                                 ' '.Definir os controles.                                      ',
    TABLES lt_selecao USING '.DATA.                                                      ' '.Definir variável.                                          ',
    TABLES lt_selecao USING '.DATA:.                                                     ' '.Definir as variáveis.                                      ',
    TABLES lt_selecao USING '.DATA:.BEGIN.OF.                                            ' '.Definir tabela interna.                                    ',
    TABLES lt_selecao USING '.DECIMALS.                                                  ' '.com decimais.                                              ',
    TABLES lt_selecao USING '.DEFAULT.                                                   ' '.padrão.                                                    ',
    TABLES lt_selecao USING '.END.                                                       ' '.Final.                                                     ',
    TABLES lt_selecao USING '.FIELD-GROUPS.                                              ' '.grupo de campos.                                           ',
    TABLES lt_selecao USING '.FOR.                                                       ' '.para.                                                      ',
    TABLES lt_selecao USING '.HEADER.LINE.                                               ' '.linha de cabeçalho.                                        ',
    TABLES lt_selecao USING '.INITIAL.SIZE.                                              ' '.tamanho inicial.                                           ',
    TABLES lt_selecao USING '.INTERVALS.                                                 ' '.intervalos.                                                ',
    TABLES lt_selecao USING '.KEY.                                                       ' '.chave.                                                     ',
    TABLES lt_selecao USING '.LENGTH.                                                    ' '.tamanho.                                                   ',
    TABLES lt_selecao USING '.LIKE.                                                      ' '.com as mesmas caracteristicas de.                          ',
    TABLES lt_selecao USING '.NO.                                                        ' '.sem.                                                       ',
    TABLES lt_selecao USING '.NON-UNIQUE.                                                ' '.chave composta.                                            ',
    TABLES lt_selecao USING '.OCCURS.                                                    ' '.ocorrendo.                                                 ',
    TABLES lt_selecao USING '.OF.                                                        ' '.de.                                                        ',
    TABLES lt_selecao USING '.PARAMETERS.                                                ' '.Parâmetros de seleção.                                     ',
    TABLES lt_selecao USING '.PARAMETERS:.                                               ' '.Parâmetros de seleção.                                     ',
    TABLES lt_selecao USING '.RANGE.                                                     ' '.intervalo.                                                 ',
    TABLES lt_selecao USING '.RANGES.                                                    ' '.intervalo.                                                 ',
    TABLES lt_selecao USING '.REPORT.                                                    ' '.Relatório.                                                 ',
    TABLES lt_selecao USING '.SCREEN.                                                    ' '.tela.                                                      ',
    TABLES lt_selecao USING '.SELECT-OPTIONS.                                            ' '.Entrada de opções.                                         ',
    TABLES lt_selecao USING '.STANDARD.                                                  ' '.padrão.                                                    ',
    TABLES lt_selecao USING '.STANDARD.PAGE.HEADING.                                     ' '.cabeçalho padrão.                                          ',
    TABLES lt_selecao USING '.STATICS.                                                   ' '.Declarar variavel local.                                   ',
    TABLES lt_selecao USING '.STATICS.:.                                                 ' '.Declarar variavel local.                                   ',
    TABLES lt_selecao USING '.STRUCTURE.                                                 ' '.estrutura.                                                 ',
    TABLES lt_selecao USING '.TABLE.                                                     ' '.tabela.                                                    ',
    TABLES lt_selecao USING '.TABLES.                                                    ' '.Declarar a seguinte tabela.                                ',
    TABLES lt_selecao USING '.TABLES:.                                                   ' '.Declarar as seguintes tabelas.                             ',
    TABLES lt_selecao USING '.TABLEVIEW.                                                 ' '.visão de tabela.                                           ',
    TABLES lt_selecao USING '.TABSTRIP.                                                  ' '.aba de tela.                                               ',
    TABLES lt_selecao USING '.TYPE-POOLS.                                                ' '.grupo de tipos.                                            ',
    TABLES lt_selecao USING '.TYPE.                                                      ' '.com as mesmas caracteristicas de.                          ',
    TABLES lt_selecao USING '.TYPES.                                                     ' '.Definir campo estruturado.                                 ',
    TABLES lt_selecao USING '.TYPES:.                                                    ' '.Definir campo estruturado como segue.                      ',
    TABLES lt_selecao USING '.UNIQUE.                                                    ' '.chave única.                                               ',
    TABLES lt_selecao USING '.VALUE.                                                     ' '.valor padrão.                                              ',
    TABLES lt_selecao USING '.WITH.                                                      ' '.com.                                                       '.

  ELSEIF p_tipo = 'R'.
    PERFORM append_selecao:
    TABLES lt_selecao USING '.ENDFORM.                                                   ' '.Fim da Rotina.                                             ',
    TABLES lt_selecao USING '.EXPORTING.                                                 ' '.Parâmetros de Exportação.                                  ',
    TABLES lt_selecao USING '.FORM.                                                      ' '.Rotina.                                                    ',
    TABLES lt_selecao USING '.IMPORTING.                                                 ' '.Parâmetros de Importação.                                  ',
    TABLES lt_selecao USING '.PERFORM.                                                   ' '.Chamar rotina .                                            ',
    TABLES lt_selecao USING '.USING.                                                     ' '.utilizando o parâmetro.                                    '.

  ELSEIF p_tipo = 'E'.
    PERFORM append_selecao:
    TABLES lt_selecao USING '.AFTER.INPUT.                                               ' '.depois da entrada so usuário.                              ',
    TABLES lt_selecao USING '.AT.SELECTION-SCREEN.                                       ' '.Na tela de seleção.                                        ',
    TABLES lt_selecao USING '.AT.USER-COMMAND.                                           ' '.Ao comando do usuário.                                     ',
    TABLES lt_selecao USING '.BEFORE.OUTPUT.                                             ' '.antes da tela ser exibida.                                 ',
    TABLES lt_selecao USING '.BEGIN.OF.BLOCK.                                            ' '.início de bloco.                                           ',
    TABLES lt_selecao USING '.BEGIN.OF.LINE.                                             ' '.início da linha.                                           ',
    TABLES lt_selecao USING '.COMMENT.                                                   ' '.descrição.                                                 ',
    TABLES lt_selecao USING '.DURING.LINE-SELECTION.                                     ' '.quando gerado em uma lista secundária.                     ',
    TABLES lt_selecao USING '.END-OF-PAGE.                                               ' '.final da página.                                           ',
    TABLES lt_selecao USING '.END-OF-SELECTION.                                          ' '.Fim do Processamento.                                      ',
    TABLES lt_selecao USING '.END.OF.BLOCK.                                              ' '.final do bloco.                                            ',
    TABLES lt_selecao USING '.END.OF.LINE.                                               ' '.final da linha.                                            ',
    TABLES lt_selecao USING '.FRAME.TITLE.                                               ' '.título do frame.                                           ',
    TABLES lt_selecao USING '.GROUP.                                                     ' '.grupo.                                                     ',
    TABLES lt_selecao USING '.INITIALIZATION.                                            ' '.Rotina para Inicialização.                                 ',
    TABLES lt_selecao USING '.LINE-SELECTION.                                            ' '.Linha de seleção.                                          ',
    TABLES lt_selecao USING '.LOWER.CASE.                                                ' '.caixa baixa.                                               ',
    TABLES lt_selecao USING '.MODIF.ID.                                                  ' '.com identificação de modificação.                          ',
    TABLES lt_selecao USING '.ON.HELP-REQUEST.                                           ' '.quando o usuário pressionar F1.                            ',
    TABLES lt_selecao USING '.ON.VALUE-REQUEST.                                          ' '.quando o usuário pressionar F4.                            ',
    TABLES lt_selecao USING '.ON.VALUE-REQUEST.FOR.                                      ' '.quando for alterado o campo.                               ',
    TABLES lt_selecao USING '.PARAMETER:.                                                ' '.Parâmetro de seleção.                                      ',
    TABLES lt_selecao USING '.PROCESS.                                                   ' '.Processar.                                                 ',
    TABLES lt_selecao USING '.RADIOBUTTON.                                               ' '.botão de rádio.                                            ',
    TABLES lt_selecao USING '.SELECTION-SCREEN.                                          ' '.Tela de seleção.                                           ',
    TABLES lt_selecao USING '.SELECTION-SCREEN.PUSHBUTTON.                               ' '.Gerar um botão na tela de seleção.                         ',
    TABLES lt_selecao USING '.SELECTION-SCREEN:.                                         ' '.Tela de seleção.                                           ',
    TABLES lt_selecao USING '.SELECTION-SCREEN:.PUSHBUTTON.                              ' '.Gerar um botão na tela de seleção.                         ',
    TABLES lt_selecao USING '.START-OF-SELECTION.                                        ' '.Inicio do Processamento.                                   ',
    TABLES lt_selecao USING '.TABBED.BLOCK.                                              ' '.bloco de abas.                                             ',
    TABLES lt_selecao USING '.TOP-OF-PAGE.                                               ' '.topo da página.                                            ',
    TABLES lt_selecao USING '.USER-COMMAND.                                              ' '.comando do usuário.                                        ',
    TABLES lt_selecao USING '.WITH.FRAME.TITLE.                                          ' '.com o título.                                              '.
  ENDIF.

ENDFORM.                    " PREENCHE_STATEMENT
*&---------------------------------------------------------------------*
*&      Form  APPEND_SELECAO
*&---------------------------------------------------------------------*
FORM append_selecao  TABLES   lt_selecao STRUCTURE s_selecao
USING    VALUE(p_cmd)
VALUE(p_snt).
  lt_selecao-comando  = p_cmd.
  lt_selecao-sentenca = p_snt.
  APPEND lt_selecao.

ENDFORM.                    " APPEND_SELECAO
*&---------------------------------------------------------------------*
*&      Form  BUSCA_CABECALHO
*&---------------------------------------------------------------------*
FORM busca_cabecalho .
  DATA: lv_objetivo,
        lv_size     TYPE i,
        BEGIN OF t_pattern OCCURS 0,
          abap     TYPE char256,
          port     TYPE char256,
          tam_abap TYPE i,
        END OF t_pattern.

* O cabeçalho dos programas a serem gerados a ET, devem estar igual ao
* que está neste mesmo programa
  t_pattern-abap = 'Objetivo'.
  APPEND t_pattern.
  t_pattern-abap = ':'.
  APPEND t_pattern.

  LOOP AT t_prog.
    IF t_prog-linha(12) = '*** Objetivo' OR
    ( t_prog-linha(06) = '***   ' AND lv_objetivo = 'X' ).
      lv_objetivo = 'X'.
      CONDENSE t_prog-linha.
      lv_size = strlen( t_prog-linha ).
      SUBTRACT 3 FROM lv_size.
      IF t_prog-linha+lv_size(3) = '***'.
        IF lv_size > 3.
          SUBTRACT 3 FROM lv_size.
          CONCATENATE v_objetivo t_prog-linha+3(lv_size) INTO v_objetivo SEPARATED BY space.
        ELSE.
          CONCATENATE v_objetivo t_prog-linha+3 INTO v_objetivo SEPARATED BY space.
        ENDIF.
      ENDIF.
      CONTINUE.
    ENDIF.
    CHECK lv_objetivo = 'X'.
    EXIT.
  ENDLOOP.

  LOOP AT t_pattern.
    REPLACE ALL OCCURRENCES OF REGEX t_pattern-abap IN v_objetivo WITH t_pattern-port.
  ENDLOOP.

  CONDENSE v_objetivo.

ENDFORM.                    " BUSCA_CABECALHO
*&---------------------------------------------------------------------*
*&      Form  GET_REQUEST
*&---------------------------------------------------------------------*
FORM get_request  TABLES   ex_requests STRUCTURE e_request
USING    nome_prog
CHANGING p_subrc.

  TYPES: BEGIN OF ltype_req,
           num_ordem TYPE ys003-num_ordem,
         END OF ltype_req,
         BEGIN OF ltype_ordens,
           num_ordem TYPE ys003-num_ordem,
           autor     TYPE ys003-autor,
           data      TYPE ys003-data,
         END OF ltype_ordens,
         BEGIN OF ltype_desc,
           num_ordem TYPE ys003-num_ordem,
           descricao TYPE ys003-descricao,
         END OF ltype_desc.

  DATA: l_req       TYPE TABLE OF ltype_req,
        l_ordens    TYPE TABLE OF ltype_ordens,
        l_desc      TYPE TABLE OF ltype_desc,
        wa_ordens   LIKE LINE  OF l_ordens,
        wa_desc     LIKE LINE  OF l_desc,
        wa_requests LIKE LINE OF ex_requests.

*Seleção na tabela E071
  SELECT trkorr
  FROM e071
  INTO TABLE l_req
  WHERE pgmid    = 'R3TR' AND
  object   = 'PROG' AND
  obj_name = nome_prog.
  IF sy-subrc = 0.
*Seleção na E070
    SELECT trkorr as4user as4date
    FROM e070
    INTO TABLE l_ordens
    FOR ALL ENTRIES IN l_req
    WHERE trkorr     = l_req-num_ordem AND
    trfunction = 'K'.

*Seleção na tabela E07T
    SELECT trkorr as4text
    FROM e07t
    INTO TABLE l_desc
    FOR ALL ENTRIES IN l_ordens
    WHERE trkorr = l_ordens-num_ordem.

    CLEAR: wa_requests,wa_ordens,wa_desc.

    LOOP AT l_ordens INTO wa_ordens.
      READ TABLE l_desc WITH KEY num_ordem = wa_ordens-num_ordem
      INTO wa_desc.
      wa_requests-data = wa_ordens-data.
      wa_requests-descricao = wa_desc-descricao.
      wa_requests-autor = wa_ordens-autor.
      wa_requests-num_ordem = wa_ordens-num_ordem.
      APPEND wa_requests TO ex_requests.
      CLEAR: wa_requests,wa_ordens,wa_desc.
    ENDLOOP.
  ELSE.
    p_subrc = 1.
  ENDIF.

ENDFORM.                    " GET_REQUEST
*&---------------------------------------------------------------------*
*&      Form  GET_TEXT
*&---------------------------------------------------------------------*
FORM get_text  TABLES    ex_text STRUCTURE e_textos
USING     im_text_type
im_transl_lang
CHANGING  p_subrc.

  DATA: v_lang TYPE spras.

* CONSTANTS
  CONSTANTS: c_h VALUE 'H',
             c_i VALUE 'I',
             c_r VALUE 'R',
             c_s VALUE 'S',
             c_t VALUE 'T',
             c_e VALUE 'E'.

* LINE TYPE
  DATA: e_rs38m TYPE rs38m,
        e_text  TYPE ys004.

* TABELA INTERNA
  DATA: t_textpool TYPE TABLE OF ys004.

  DATA: lt_ingles   TYPE TABLE OF textpool,
        lt_port     TYPE TABLE OF textpool,
        lt_outro    TYPE TABLE OF textpool,
        l_lang      TYPE          spras,
        wa_ingles   LIKE LINE  OF lt_ingles,
        wa_port     LIKE LINE  OF lt_port,
        wa_outro    LIKE LINE  OF lt_outro,
        wa_textpool LIKE LINE  OF t_textpool.

  CONSTANTS: c_en(2) VALUE 'EN',
             c_pt(2) VALUE 'PT'.

  CHECK ex_text[] IS INITIAL.

  IF NOT im_text_type EQ c_h AND
  NOT im_text_type EQ c_i AND
  NOT im_text_type EQ c_r AND
  NOT im_text_type EQ c_s AND
  NOT im_text_type EQ c_t AND
  NOT im_text_type EQ space.

    p_subrc = 1.
  ELSE.

    MOVE: p_prog TO e_rs38m-programm.

* OBTÉM OS TEXTOS DO PROGRAMA
*    CALL FUNCTION 'Z_SCAN_SOURCE_GET_TEXTPOOL'
*      DESTINATION v_rfc_dest
*      EXPORTING
*        im_obj_name        = e_rs38m-programm
*      TABLES
*        ex_textpool        = t_textpool
*      EXCEPTIONS
*        textpool_not_found = 1
*        OTHERS             = 2.
    READ TEXTPOOL e_rs38m-programm  LANGUAGE c_en INTO lt_ingles.

    READ TEXTPOOL e_rs38m-programm  LANGUAGE sy-langu INTO lt_port.

    SELECT SINGLE language
    FROM repotext
    INTO l_lang
    WHERE language <> c_en AND
    language <> c_pt AND
    progname EQ e_rs38m-programm.

    IF sy-subrc = 0.
      READ TEXTPOOL e_rs38m-programm LANGUAGE l_lang INTO lt_outro.
    ENDIF.

    CLEAR: wa_textpool, wa_ingles.

    LOOP AT lt_ingles INTO wa_ingles.
      wa_textpool-id      = wa_ingles-id.
      wa_textpool-chave   = wa_ingles-key.
      wa_textpool-texto   = wa_ingles-entry.
      wa_textpool-tamanho = wa_ingles-length.
      wa_textpool-idioma  = 'E'.
      APPEND wa_textpool TO t_textpool.
      CLEAR: wa_textpool, wa_ingles.
    ENDLOOP.

    CLEAR: wa_textpool, wa_port.

    LOOP AT lt_port INTO wa_port.
      wa_textpool-id      = wa_port-id.
      wa_textpool-chave   = wa_port-key.
      wa_textpool-texto   = wa_port-entry.
      wa_textpool-tamanho = wa_port-length.
      wa_textpool-idioma  = 'P'.
      APPEND wa_textpool TO t_textpool.
      CLEAR: wa_textpool, wa_port.
    ENDLOOP.

    CLEAR: wa_textpool, wa_port.

    LOOP AT lt_outro INTO wa_outro.
      wa_textpool-id      = wa_outro-id.
      wa_textpool-chave   = wa_outro-key.
      wa_textpool-texto   = wa_outro-entry.
      wa_textpool-tamanho = wa_outro-length.
      APPEND wa_textpool TO t_textpool.
      CLEAR: wa_textpool, wa_outro.
    ENDLOOP.

    IF t_textpool[] IS INITIAL.
      sy-subrc = 1.
    ELSE.
      SORT t_textpool BY chave.
    ENDIF.

    IF NOT im_text_type IS INITIAL.
      DELETE t_textpool WHERE id NE im_text_type.
    ENDIF.

    LOOP AT t_textpool INTO e_text.
      SHIFT e_text-texto LEFT DELETING LEADING  space.
      APPEND e_text TO ex_text.
    ENDLOOP.

    IF NOT ex_text[] IS INITIAL.

* CASO O IDIOMA NÃO SEJA INFORMADO UTILIZA-SE 'E'
      IF im_transl_lang IS INITIAL.
        MOVE: c_e TO v_lang.
      ELSE.
        MOVE: im_transl_lang TO v_lang.
      ENDIF.
* OBTÉM A TRADUÇÃO DOS TEXTOS
*      PERFORM sel_traducao TABLES ex_text
*                           USING  v_lang.
*        CALL METHOD me->sel_traducao
*          EXPORTING
*            im_langu  = v_lang
*          CHANGING
*            ex_traduc = ex_text.

    ENDIF.

    IF ex_text[] IS INITIAL.
      p_subrc = 2.
    ENDIF.

  ENDIF.
ENDFORM.                    " GET_TEXT
*&---------------------------------------------------------------------*
*&      Form  SEL_TRADUCAO
*&---------------------------------------------------------------------*
FORM sel_traducao  TABLES   ex_traduc STRUCTURE e_textos
USING    im_langu.

  DATA: e_text       TYPE tp_text,
        e_objlist    TYPE lwrkobj,
        e_tablin     TYPE tablin,
        e_tablist    TYPE tablist,
        e_fieldlist  TYPE fieldlist,
        e_translmsag TYPE translmsag,
        e_transl20   TYPE transl20,
        e_transl60   TYPE transl60,
        e_transl80   TYPE transl80,
        e_transl132  TYPE transl132,
        e_transl255  TYPE transl255.

  DATA: t_objlist    TYPE TABLE OF lwrkobj,
        t_keylist    TYPE TABLE OF lwrkkey,
        t_doclist    TYPE TABLE OF lwrkobj,
        t_lines      TYPE TABLE OF tablin,
        t_tab_list   TYPE TABLE OF tablist,
        t_field_list TYPE TABLE OF fieldlist,
        t_error_list TYPE TABLE OF translmsag,
        t_itransl20  TYPE TABLE OF transl20,
        t_itransl60  TYPE TABLE OF transl60,
        t_itransl80  TYPE TABLE OF transl80,
        t_itransl132 TYPE TABLE OF transl132,
        t_itransl255 TYPE TABLE OF transl255.

  DATA: v_len TYPE i.
  CONSTANTS: c_pt(02)   VALUE 'PT',
             c_rept(04) VALUE 'REPT'.

  MOVE: im_langu   TO e_objlist-targetlang,
  c_rept     TO e_objlist-objtype,
  p_prog     TO e_objlist-objname,
  c_pt       TO e_objlist-masterlang,
  c_pt       TO e_objlist-sourcelang.

  APPEND e_objlist TO t_objlist.

* OBTÉM AS TRADUÇÕES DE TEXTOS
  CALL FUNCTION 'RESOLVE_OBJECTS_FOR_TRANSL'
    TABLES
      objlist           = t_objlist
      doclist           = t_doclist
      lines             = t_lines
      tab_list          = t_tab_list
      field_list        = t_field_list
      error_list        = t_error_list
      itransl20         = t_itransl20
      itransl60         = t_itransl60
      itransl80         = t_itransl80
      itransl132        = t_itransl132
      itransl255        = t_itransl255
    EXCEPTIONS
      inconsistent_list = 1
      objtype_unknown   = 2
      OTHERS            = 3.

  IF sy-subrc IS INITIAL.

    LOOP AT ex_traduc INTO e_text.

      READ TABLE t_itransl255 INTO e_transl255
      WITH KEY sourcetext = e_text-texto
      ttabix     = sy-tabix.

      CHECK sy-subrc IS INITIAL.

      MOVE e_transl255-targettext TO e_text-traducao.
      MODIFY ex_traduc FROM e_text.

    ENDLOOP.

  ENDIF.

ENDFORM.                    " SEL_TRADUCAO
*&---------------------------------------------------------------------*
*&      Form  GET_CARACT
*&---------------------------------------------------------------------*
FORM get_caract  USING    VALUE(im_obj_type)
CHANGING  ex_caracter TYPE tp_caract
p_subrc.

  DATA: t_tadir TYPE TABLE OF tadir.

  DATA: e_tadir TYPE tadir,
        e_trdir TYPE trdir.

  CONSTANTS: c_x       VALUE 'X',
             c_prog(4) VALUE 'PROG'.

  CLEAR p_subrc.

  IF im_obj_type EQ c_prog.

* SELECIONA DADOS BÁSICO DO PROGRAMA REPORT
    SELECT SINGLE *
    FROM trdir
    INTO ex_caracter
    WHERE name EQ p_prog.
*    CALL METHOD me->sel_trdir
*      EXPORTING
*        im_prog_name          = im_obj_name
*      IMPORTING
*        ex_trdir              = ex_caracter
*      EXCEPTIONS
*        program_nothing_found = 1.
    IF NOT sy-subrc IS INITIAL.
      p_subrc = sy-subrc.
      EXIT.
    ENDIF.

* SELECIONA TÍTULO DO PROGRAMA
    SELECT SINGLE text
    FROM trdirt
    INTO ex_caracter-titulo_prog
    WHERE name  EQ p_prog AND
    sprsl EQ ex_caracter-idioma.
*    CALL METHOD me->sel_trdirt
*      EXPORTING
*        im_obj_name         = im_obj_name
*        im_obj_langu        = ex_caracter-idioma
*      IMPORTING
*        ex_obj_descr        = ex_caracter-titulo_prog
*      EXCEPTIONS
*        obj_descr_not_found = 1
*        OTHERS              = 2.
** !!!  DESCRIÇÃO DO PROGRAMA NÃO ENCONSTRADO  !!!
*    IF NOT sy-subrc IS INITIAL.
*      MOVE text-001 TO ex_caracter-titulo_prog.
*    ENDIF.

* SELECIONA SISTEMA DE ORIGEM E CLASSE DE DESENVOLVIMENTO
    PERFORM sel_tadir TABLES   t_tadir
    USING    ex_caracter-programa
    im_obj_type
    CHANGING sy-subrc.
*    CALL METHOD me->sel_tadir
*      EXPORTING
*        im_prog_name      = ex_caracter-programa
*        im_obj_type       = im_obj_type
*      IMPORTING
*        ex_tadir          = t_tadir
*      EXCEPTIONS
*        obj_nothing_found = 1
*        OTHERS            = 2.
    IF sy-subrc IS INITIAL.

      READ TABLE t_tadir INTO e_tadir INDEX 1.

      IF sy-subrc IS INITIAL.

        MOVE: e_tadir-object    TO ex_caracter-object_type,
        e_tadir-srcsystem TO ex_caracter-sist_orig,
        e_tadir-devclass  TO ex_caracter-dev_class.

      ENDIF.                       "t_tadir
    ENDIF.                         "me->sel_tadir

* SELECIONA AS CARACTERISTICAS DE OUTROS OBJETOS SAP
  ELSE.

* SELECIONA SISTEMA DE ORIGEM E CLASSE DE DESENVOLVIMENTO
    PERFORM sel_tadir TABLES   t_tadir
    USING    p_prog
    im_obj_type
    CHANGING sy-subrc.
*    CALL METHOD me->sel_tadir
*      EXPORTING
*        im_prog_name      = im_obj_name
*        im_obj_type       = im_obj_type
*      IMPORTING
*        ex_tadir          = t_tadir
*      EXCEPTIONS
*        obj_nothing_found = 1
*        OTHERS            = 2.
    IF sy-subrc IS INITIAL.

      READ TABLE t_tadir INTO e_tadir INDEX 1.

      IF sy-subrc IS INITIAL.

        MOVE: e_tadir-obj_name  TO ex_caracter-programa,
        e_tadir-author    TO ex_caracter-autor,
        e_tadir-object    TO ex_caracter-object_type,
        e_tadir-srcsystem TO ex_caracter-sist_orig,
        e_tadir-devclass  TO ex_caracter-dev_class.

      ENDIF.                       "t_tadir

    ELSE.

      p_subrc = 1.

    ENDIF.                         "me->sel_tadir

  ENDIF.                           "im_obj_type
ENDFORM.                    " GET_CARACT
*&---------------------------------------------------------------------*
*&      Form  SEL_TADIR
*&---------------------------------------------------------------------*
FORM sel_tadir  TABLES   ex_tadir STRUCTURE tadir
USING    im_prog_name
VALUE(im_obj_type)
CHANGING p_subrc.

  IF NOT im_obj_type IS INITIAL.


* SELECIONA OS OBJETOS DO PROGRAMA INFORMADO

    SELECT *
    FROM tadir
    INTO TABLE ex_tadir
    WHERE object EQ im_obj_type AND
    obj_name EQ im_prog_name.

  ELSE.


* SELECIONA OS OBJETOS DO PROGRAMA INFORMADO

    SELECT *
    FROM tadir
    INTO TABLE ex_tadir
    WHERE obj_name EQ im_prog_name.

  ENDIF.

  p_subrc = sy-subrc.
ENDFORM.                    " SEL_TADIR
*&---------------------------------------------------------------------*
*&      Form  GET_TRANSACTION
*&---------------------------------------------------------------------*
FORM get_transaction  TABLES   ex_trans STRUCTURE e_transacao
CHANGING p_subrc.

  TYPES: BEGIN OF ltype_transacoes,
           transacoes TYPE ys005-transacao,
         END OF ltype_transacoes.

  DATA: t_transacoes  TYPE TABLE OF ltype_transacoes,
        wa_transacoes LIKE LINE  OF t_transacoes,
        wa_trans      LIKE LINE  OF ex_trans.

  SELECT tcode
  FROM tstc
  INTO TABLE t_transacoes
  WHERE pgmna = p_prog.

  CLEAR: wa_trans, wa_transacoes.

  LOOP AT t_transacoes INTO wa_transacoes.
    wa_trans-transacao = wa_transacoes-transacoes.
    APPEND wa_trans TO ex_trans.
    CLEAR: wa_trans, wa_transacoes.
  ENDLOOP.

  p_subrc = sy-subrc.

ENDFORM.                    " GET_TRANSACTION
*&---------------------------------------------------------------------*
*&      Form  GET_VARIANT
*&---------------------------------------------------------------------*
FORM get_variant  TABLES   ex_variante STRUCTURE e_variant
CHANGING p_subrc.
  DATA: e_varid    TYPE varid,
        e_varit    TYPE varit,
        e_varis    TYPE varis,
        e_variante TYPE ys006.

  DATA: t_varid TYPE TABLE OF varid,
        t_varit TYPE TABLE OF varit,
        t_varis TYPE TABLE OF varis.


  SELECT report variant transport environmnt
  protected secu version ename edat
  etime aename aedat aetime mlangu
  FROM varid
  INTO CORRESPONDING FIELDS OF TABLE t_varid
  WHERE report EQ p_prog.

  IF sy-subrc IS INITIAL.
* SELECIONA A DESCRIAÇÃO
    SELECT *
    FROM varit
    INTO TABLE  t_varit
    FOR ALL ENTRIES IN t_varid[]
    WHERE langu EQ sy-langu AND
    report EQ t_varid-report.
* SELECIONA A TELA
    SELECT *
    FROM varis
    INTO TABLE  t_varis
    FOR ALL ENTRIES IN t_varid[]
    WHERE report EQ t_varid-report.

    LOOP AT t_varid INTO e_varid.

      READ TABLE t_varit INTO e_varit
      WITH KEY report = e_varid-report
      BINARY SEARCH.

      READ TABLE t_varis INTO e_varis
      WITH KEY report = e_varid-report
      BINARY SEARCH.

      MOVE: e_varid-report     TO e_variante-report,
      e_varid-variant    TO e_variante-variante,
      e_varit-vtext      TO e_variante-descricao,
      e_varid-transport  TO e_variante-trans_aut,
      e_varid-environmnt TO e_variante-ambiente,
      e_varid-protected  TO e_variante-protegido,
      e_varid-secu       TO e_variante-grupo_aut,
      e_varid-version    TO e_variante-versao,
      e_varid-ename      TO e_variante-user_criacao,
      e_varid-edat       TO e_variante-data_criacao,
      e_varid-etime      TO e_variante-hora_criacao,
      e_varid-aename     TO e_variante-user_modif,
      e_varid-aedat      TO e_variante-data_modif,
      e_varid-aetime     TO e_variante-hora_modif,
      e_varid-mlangu     TO e_variante-idioma,
      e_varis-dynnr      TO e_variante-tela.

      APPEND e_variante TO ex_variante.
      CLEAR: e_variante, e_varis, e_varid, e_varit.

    ENDLOOP.

  ELSE.
    p_subrc = 1.
  ENDIF.
ENDFORM.                    " GET_VARIANT


*---------------------------------------------------------------------
* Selection Texts
*---------------------------------------------------------------------
* P_LOC D       .
* P_LOGO D       .
* P_PROG D       .


*---------------------------------------------------------------------
* Messages
*---------------------------------------------------------------------
*
* Message class:00
*208&
*
* Message class:SU
*000& & & &

*---------------------------
* Extracted by Direct Test Program to Text File
